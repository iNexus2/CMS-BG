<?php

return <<<'VALUE'
"namespace IPS\\Theme;\nclass class_core_front_global extends \\IPS\\Theme\\Template\n{\n\tpublic $cache_key = 'f08b9663d84b3750506d9fdebffa0d5a';\n\tfunction acknowledgeWarning( $warnings=array() ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nforeach ( $warnings as $idx => $warning ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( $idx === 0 ):\n$return .= <<<CONTENT\n\n\t\t<div class='ipsMessage ipsMessage_error'>\n\t\t\t<h4 class='ipsMessage_title'>\nCONTENT;\n\n$sprintf = array(\\IPS\\Member::load( $warning->moderator )->name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'you_have_been_warned', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n<\/h4>\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->isBanned() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $warning->note_member ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<p class='ipsType_reset ipsType_medium'>{$warning->note_member}<\/p>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t<p class='ipsType_reset ipsType_medium'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'must_acknowledge_msg', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\t<br>\n\t\t\t\t<a href='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=warnings&do=view&id={$warning->member}&w={$warning->id}\", null, \"warn_view\", array( \\IPS\\Member::loggedIn()->members_seo_name ), 0 ) );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_verySmall ipsButton_veryLight' data-ipsDialog data-ipsDialog-size='narrow'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'view_warning_details', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t\t<br>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction blankTemplate( $html, $title=NULL ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<!DOCTYPE html>\n<html lang=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->language()->bcp47(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" dir=\"\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->language()->isrtl ):\n$return .= <<<CONTENT\nrtl\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nltr\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\">\n\t<head>\n\t\t<title>\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Output::i()->getTitle( $title ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/title>\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'global' )->includeMeta(  );\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'global' )->includeCSS(  );\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['js_include'] != 'footer' ):\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'global' )->includeJS(  );\nendif;\n$return .= <<<CONTENT\n\n\t<\/head>\n\t<body class='ipsApp ipsApp_front ipsClearfix ipsLayout_noBackground \nCONTENT;\n\nif ( isset( \\IPS\\Request::i()->cookie['hasJS'] ) ):\n$return .= <<<CONTENT\nipsJS_has\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsJS_none\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n ipsClearfix\nCONTENT;\n\nforeach ( \\IPS\\Output::i()->bodyClasses as $class ):\n$return .= <<<CONTENT\n \nCONTENT;\n$return .= htmlspecialchars( $class, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( \\IPS\\Output::i()->globalControllers ):\n$return .= <<<CONTENT\ndata-controller='\nCONTENT;\n\n$return .= htmlspecialchars( implode( ',', \\IPS\\Output::i()->globalControllers ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( isset( \\IPS\\Output::i()->inlineMessage ) ):\n$return .= <<<CONTENT\ndata-message=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Output::i()->inlineMessage, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n itemscope itemtype=\"http:\/\/schema.org\/WebSite\">\n\t\t{$html}\n\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['js_include'] == 'footer' ):\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'global' )->includeJS(  );\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Output::i()->endBodyCode;\n$return .= <<<CONTENT\n\n\t<\/body>\n<\/html>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction box( $content=NULL, $classes=array() ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n<div class='ipsBox \nCONTENT;\n\nif ( count( $classes) ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= htmlspecialchars( implode( ' ', $classes ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t{$content}\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction breadcrumb( $useMicrodata=TRUE, $position='top', $markRead=TRUE ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<nav class='ipsBreadcrumb ipsBreadcrumb_\nCONTENT;\n$return .= htmlspecialchars( $position, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n ipsFaded_withHover'>\n\t\nCONTENT;\n\nif ( $position == 'bottom' ):\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->rssMenu(  );\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t<ul class='ipsList_inline ipsPos_right'>\n\t\t\nCONTENT;\n\n$defaultStream = \\IPS\\core\\Stream::defaultStream();\n$return .= <<<CONTENT\n\n\t\t<li \nCONTENT;\n\nif ( !\\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'discover' ) )  ):\n$return .= <<<CONTENT\n class='ipsHide'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t<a data-action=\"defaultStream\" class='ipsType_light \nCONTENT;\n\nif ( ! $defaultStream ):\n$return .= <<<CONTENT\nipsHide\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'  href='\nCONTENT;\n\nif ( $defaultStream ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $defaultStream->url(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'><i class='icon-newspaper'><\/i> <span>\nCONTENT;\n\nif ( $defaultStream ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $defaultStream->_title, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n<\/span><\/a>\n\t\t<\/li>\n\t\t\nCONTENT;\n\nif ( $markRead && \\IPS\\Member::loggedIn()->member_id ):\n$return .= <<<CONTENT\n\n\t\t\t<li>\n\t\t\t\t<a data-action=\"markSiteRead\" class='ipsType_light' data-controller=\"core.front.core.markRead\" href='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=markread\" . \"&csrfKey=\" . \\IPS\\Session::i()->csrfKey, null, \"mark_site_as_read\", array(), 0 ) );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mark_site_read', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsTooltip><i class='fa fa-check'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mark_site_read_button', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/ul>\n\n\t<ul \nCONTENT;\n\nif ( $useMicrodata ):\n$return .= <<<CONTENT\nitemscope itemtype=\"http:\/\/schema.org\/BreadcrumbList\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t<li \nCONTENT;\n\nif ( $useMicrodata ):\n$return .= <<<CONTENT\n itemprop=\"itemListElement\" itemscope itemtype=\"http:\/\/schema.org\/ListItem\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t<a title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'home', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" href='\nCONTENT;\n\n$return .= \\IPS\\Settings::i()->base_url;\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( $useMicrodata ):\n$return .= <<<CONTENT\nitemscope itemtype=\"http:\/\/schema.org\/Thing\" itemprop=\"item\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t\t<span \nCONTENT;\n\nif ( $useMicrodata ):\n$return .= <<<CONTENT\nitemprop=\"name\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n><i class='fa fa-home'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'home', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nif ( count( \\IPS\\Output::i()->breadcrumb ) ):\n$return .= <<<CONTENT\n <i class='fa fa-angle-right'><\/i>\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n<\/span>\n\t\t\t<\/a>\n\t\t\t<meta itemprop=\"position\" content=\"1\">\n\t\t<\/li>\n\t\t\nCONTENT;\n\n$i = 0;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nforeach ( \\IPS\\Output::i()->breadcrumb as $k => $b ):\n$return .= <<<CONTENT\n\n\t\t\t<li \nCONTENT;\n\nif ( $useMicrodata ):\n$return .= <<<CONTENT\n itemprop=\"itemListElement\" itemscope itemtype=\"http:\/\/schema.org\/ListItem\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t\t\nCONTENT;\n\nif ( $b[0] === NULL ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $b[1], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $b[0], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( $useMicrodata ):\n$return .= <<<CONTENT\nitemscope itemtype=\"http:\/\/schema.org\/Thing\" itemprop=\"item\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t\t\t\t<span \nCONTENT;\n\nif ( $useMicrodata ):\n$return .= <<<CONTENT\nitemprop=\"name\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\nCONTENT;\n$return .= htmlspecialchars( $b[1], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( ( $i + 1 != count( \\IPS\\Output::i()->breadcrumb ) ) ):\n$return .= <<<CONTENT\n<i class='fa fa-angle-right'><\/i>\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t<\/a>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<meta itemprop=\"position\" content=\"\nCONTENT;\n$return .= htmlspecialchars( $i+2, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\n$i++;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t<\/ul>\n<\/nav>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction buttons( $buttons ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<ul class='ipsToolList ipsToolList_horizontal ipsClearfix'>\n\t\nCONTENT;\n\nforeach ( $buttons as $button ):\n$return .= <<<CONTENT\n\n\t\t<li class='\nCONTENT;\n\nif ( isset( $button['hidden'] ) and $button['hidden'] ):\n$return .= <<<CONTENT\nipsJS_hide\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( isset( $button['id'] ) ):\n$return .= <<<CONTENT\nid=\"\nCONTENT;\n$return .= htmlspecialchars( $button['id'], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t<a\n\t\t\t\t\nCONTENT;\n\nif ( isset( $button['link'] ) ):\n$return .= <<<CONTENT\nhref='\nCONTENT;\n$return .= htmlspecialchars( $button['link'], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\ttitle='\nCONTENT;\n\n$val = \"{$button['title']}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'\n\t\t\t\tclass='ipsButton ipsButton_alternate ipsButton_small ipsButton_fullWidth \nCONTENT;\n\nif ( isset( $button['class'] ) ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $button['class'], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'\n\t\t\t\trole=\"button\"\n\t\t\t\t\nCONTENT;\n\nif ( isset( $button['id'] ) ):\n$return .= <<<CONTENT\nid=\"\nCONTENT;\n$return .= htmlspecialchars( $button['id'], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_button\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( isset( $button['target'] ) ):\n$return .= <<<CONTENT\ntarget=\"\nCONTENT;\n$return .= htmlspecialchars( $button['target'], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( isset( $button['data'] ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nforeach ( $button['data'] as $k => $v ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\tdata-\nCONTENT;\n$return .= htmlspecialchars( $k, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n=\"\nCONTENT;\n$return .= htmlspecialchars( $v, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\"\n\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( isset( $button['hotkey'] ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\tdata-keyAction='\nCONTENT;\n$return .= htmlspecialchars( $button['hotkey'], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t>\n\t\t\t\t\nCONTENT;\n\nif ( $button['icon'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<i class='fa fa-\nCONTENT;\n$return .= htmlspecialchars( $button['icon'], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'><\/i>&nbsp;\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\n$val = \"{$button['title']}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\n\t\t\t\t\nCONTENT;\n\nif ( isset($button['dropdown']) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t&nbsp;<i class='fa fa-caret-down'><\/i>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/a>\n\t\t<\/li>\n\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n<\/ul>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction cachingLog( $log ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div id=\"elCachingLog\">\n\t\nCONTENT;\n\nforeach ( $log as $i => $log ):\n$return .= <<<CONTENT\n\n\t\t<div class=\"cCachingLog\" data-ipsDialog data-ipsDialog-content=\"#elCachingLog\nCONTENT;\n$return .= htmlspecialchars( $i, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu\">\n\t\t\t\nCONTENT;\n\nif ( $log[0] === 'get' ):\n$return .= <<<CONTENT\n\n\t\t\t\t<span class=\"cCachingLogMethod cCachingLogMethod_get\">get<\/span>\n\t\t\t\t<span class=\"cCachingLogKey\">\nCONTENT;\n$return .= htmlspecialchars( $log[1], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\nCONTENT;\n\nelseif ( $log[0] === 'set' ):\n$return .= <<<CONTENT\n\n\t\t\t\t<span class=\"cCachingLogMethod cCachingLogMethod_set\">set<\/span>\n\t\t\t\t<span class=\"cCachingLogKey\">\nCONTENT;\n$return .= htmlspecialchars( $log[1], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\nCONTENT;\n\nelseif ( $log[0] === 'check' ):\n$return .= <<<CONTENT\n\n\t\t\t\t<span class=\"cCachingLogMethod cCachingLogMethod_check\">check<\/span>\n\t\t\t\t<span class=\"cCachingLogKey\">\nCONTENT;\n$return .= htmlspecialchars( $log[1], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\nCONTENT;\n\nelseif ( $log[0] === 'key' ):\n$return .= <<<CONTENT\n\n\t\t\t\t<span class=\"cCachingLogMethod cCachingLogMethod_delete\">delete<\/span>\n\t\t\t\t<span class=\"cCachingLogKey\">\nCONTENT;\n$return .= htmlspecialchars( $log[1], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t\t<div id='elCachingLog\nCONTENT;\n$return .= htmlspecialchars( $i, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu' class='ipsPad ipsHide'>\n\t\t\t\nCONTENT;\n\nif ( $log[2] !== NULL ):\n$return .= <<<CONTENT\n\n\t\t\t\t<pre class=\"prettyprint lang-php\">\nCONTENT;\n$return .= htmlspecialchars( $log[2], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/pre>\n\t\t\t\t<hr class=\"ipsHr\">\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<pre class=\"prettyprint lang-php\">\nCONTENT;\n$return .= htmlspecialchars( $log[3], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/pre>\n\t\t<\/div>\n\t\t<hr class=\"ipsHr\">\n\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction comment( $item, $comment, $editorName, $app, $type, $class='' ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\n$idField = $comment::$databaseColumnId;\n$return .= <<<CONTENT\n\n<div id='comment-\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_wrap' data-controller='core.front.core.comment' data-commentApp='\nCONTENT;\n$return .= htmlspecialchars( $app, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-commentType='\nCONTENT;\n$return .= htmlspecialchars( $type, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-commentID=\"\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-quoteData='\nCONTENT;\n\n$return .= htmlspecialchars( json_encode( array('userid' => $comment->author()->member_id, 'username' => $comment->author()->name, 'timestamp' => $comment->mapped('date'), 'contentapp' => $app, 'contenttype' => $type, 'contentclass' => $class, 'contentid' => $item->id, 'contentcommentid' => $comment->$idField) ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsComment_content ipsType_medium'>\n\t\nCONTENT;\n\nif ( in_array( 'IPS\\Content\\Reputation', class_implements( $comment ) ) and \\IPS\\Settings::i()->reputation_highlight and $comment->reputation() >= \\IPS\\Settings::i()->reputation_highlight and \\IPS\\Settings::i()->reputation_enabled ):\n$return .= <<<CONTENT\n\n\t\t<strong class='ipsComment_popularFlag' data-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'this_is_a_popular_comment', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'><i class='fa fa-heart'><\/i><\/strong>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t<div class='ipsComment_header ipsPhotoPanel ipsPhotoPanel_mini'>\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( $comment->author(), 'mini', $comment->warningRef() );\n$return .= <<<CONTENT\n\n\t\t<div>\n\t\t\t<p class='ipsPos_right ipsType_reset ipsType_blendLinks'>\n\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->modPermission('can_use_ip_tools') and \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'modcp' ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<span class='ipsResponsive_hidePhone'>(<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=modcp&controller=modcp&tab=ip_tools&ip=$comment->ip_address\", null, \"modcp_ip_tools\", array(), 0 ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$sprintf = array($comment->ip_address); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'ip_prefix', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n<\/a>)\nCONTENT;\n\nif ( count( $comment->sharelinks() ) or count( $item->commentMultimodActions() ) ):\n$return .= <<<CONTENT\n &middot;\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( count( $comment->sharelinks() ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->item()->url()->setQueryString( array( 'do' => 'findComment', 'comment' => $comment->id ) ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'share_this_comment', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsMenu data-ipsMenu-closeOnClick='false' id='elShareComment_\nCONTENT;\n$return .= htmlspecialchars( $comment->id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-role='shareComment'><i class='fa fa-share-alt'><\/i><\/a>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( count( $item->commentMultimodActions() ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<span class='ipsCustomInput'>\n\t\t\t\t\t\t<input type=\"checkbox\" name=\"multimod[\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n]\" value=\"1\" data-role=\"moderation\" data-actions=\"\nCONTENT;\n\nif ( $comment->canSplit() ):\n$return .= <<<CONTENT\nsplit merge\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( $comment->hidden() === -1 AND $comment->canUnhide() ):\n$return .= <<<CONTENT\nunhide\nCONTENT;\n\nelseif ( $comment->hidden() === 1 AND $comment->canUnhide() ):\n$return .= <<<CONTENT\napprove\nCONTENT;\n\nelseif ( $comment->canHide() ):\n$return .= <<<CONTENT\nhide\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( $comment->canDelete() ):\n$return .= <<<CONTENT\ndelete\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" data-state='\nCONTENT;\n\nif ( $comment->tableStates() ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $comment->tableStates(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\t<span><\/span>\n\t\t\t\t\t<\/span>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/p>\n\t\t\t<h3 class='ipsComment_author ipsType_blendLinks'>\n\t\t\t\t<strong class='ipsType_normal'>\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userLink( $comment->author(), $comment->warningRef() );\n$return .= <<<CONTENT\n<\/strong>\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->reputationBadge( $comment->author() );\n$return .= <<<CONTENT\n\n\t\t\t<\/h3>\n\t\t\t<p class='ipsComment_meta ipsType_light ipsType_medium'>\n\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->item()->url()->setQueryString( array( 'do' => 'findComment', 'comment' => $comment->id ) ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsType_blendLinks'>{$comment->dateLine()}<\/a>\n\t\t\t\t\nCONTENT;\n\nif ( $comment->editLine() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t(\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edited_lc', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n)\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $comment->hidden() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t&middot; \nCONTENT;\n$return .= htmlspecialchars( $comment->hiddenBlurb(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $comment instanceof \\IPS\\Content\\ReportCenter and !\\IPS\\Member::loggedIn()->group['gbw_no_report'] and $comment->hidden() !== 1  ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t&middot; <a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('report'), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-remoteSubmit data-ipsDialog-size='medium' data-ipsDialog-flashMessage='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'report_submit_success', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsDialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'report', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" data-action='reportComment' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'report_content', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'report', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/p>\n\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->modPermission('mod_see_warn') and $comment->warning ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->commentWarned( $comment );\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t<\/div>\n\t<div class='ipsPad'>\n\t\t\n\t\t<div data-role='commentContent' class='ipsType_normal ipsType_richText ipsType_break ipsContained' data-controller='core.front.core.lightboxedImages'>\n\t\t\t\nCONTENT;\n\nif ( $comment->hidden() === 1 && $comment->author()->member_id == \\IPS\\Member::loggedIn()->member_id ):\n$return .= <<<CONTENT\n\n\t\t\t\t<strong class='ipsType_medium ipsType_warning'><i class='fa fa-info-circle'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'comment_awaiting_approval', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t{$comment->content()}\n\t\t\t\n\t\t\t\nCONTENT;\n\nif ( $comment->editLine() ):\n$return .= <<<CONTENT\n\n\t\t\t\t{$comment->editLine()}\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t\t\n\t\t\nCONTENT;\n\nif ( $comment->hidden() !== 1 && $comment instanceof \\IPS\\Content\\Reputation and \\IPS\\Settings::i()->reputation_enabled ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->reputation( $comment, 'ipsPos_right ipsResponsive_noFloat' );\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t\t<ul class='ipsComment_controls ipsClearfix' data-role=\"commentControls\">\n\t\t\t\nCONTENT;\n\nif ( $comment->hidden() === 1 && ( $comment->canUnhide() || $comment->canDelete() ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $comment->canUnhide() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('unhide')->csrf(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_verySmall ipsButton_positive' data-action='approveComment'><i class='fa fa-check'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'approve', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $comment->canDelete() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('delete')->csrf()->setQueryString('page',\\IPS\\Request::i()->page), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-confirm data-action='deleteComment' data-updateOnDelete=\"#commentCount\" class='ipsButton ipsButton_verySmall ipsButton_negative'><i class='fa fa-times'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'delete', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $comment->canEdit() || $comment->canSplit() || $comment->canHide() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<a href='#elControls_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu' id='elControls_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsMenu data-ipsMenu-appendTo='#comment-\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_wrap'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'options', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n &nbsp;<i class='fa fa-caret-down'><\/i><\/a>\n\t\t\t\t\t\t<ul id='elControls_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu' class='ipsMenu ipsMenu_narrow ipsHide'>\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $comment->canEdit() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $comment->mapped('first') and $comment->item()->canEdit() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->item()->url()->setQueryString( 'do', 'edit' ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('edit'), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action='editComment'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $comment->canSplit() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('split'), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action='splitComment' data-ipsDialog data-ipsDialog-title=\"\nCONTENT;\n\n$sprintf = array(\\IPS\\Member::loggedIn()->language()->addToStack( $item::$title )); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'split_to_new', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'split', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $comment instanceof \\IPS\\Content\\Hideable and $comment->canHide() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('hide')->csrf(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'hide', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'hide', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/ul>\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $comment->hidden() === 0 and $item->canComment() and $editorName ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li data-ipsQuote-editor='\nCONTENT;\n$return .= htmlspecialchars( $editorName, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsQuote-target='#comment-\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsJS_show'>\n\t\t\t\t\t\t<button class='ipsButton ipsButton_light ipsButton_verySmall ipsButton_narrow cMultiQuote ipsHide' data-action='multiQuoteComment' data-ipsTooltip data-ipsQuote-multiQuote data-mqId='mq\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'multiquote', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'><i class='fa fa-plus'><\/i><\/button>\n\t\t\t\t\t<\/li>\n\t\t\t\t\t<li data-ipsQuote-editor='\nCONTENT;\n$return .= htmlspecialchars( $editorName, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsQuote-target='#comment-\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsJS_show'>\n\t\t\t\t\t\t<a href='#' data-action=\"quoteComment\" data-ipsQuote-singleQuote>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'quote', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $comment->canEdit() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $comment->mapped('first') and $comment->item()->canEdit() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->item()->url()->setQueryString( 'do', 'edit' ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('edit'), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action='editComment'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $comment->canDelete() || $comment->canSplit() || ( $comment instanceof \\IPS\\Content\\Hideable AND ( ( !$comment->hidden() and $comment->canHide() ) || ( $comment->hidden() and $comment->canUnhide() ) ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<a href='#elControls_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu' id='elControls_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsMenu data-ipsMenu-appendTo='#comment-\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_wrap'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'options', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n &nbsp;<i class='fa fa-caret-down'><\/i><\/a>\n\t\t\t\t\t\t<ul id='elControls_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu' class='ipsMenu ipsMenu_narrow ipsHide'>\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $comment instanceof \\IPS\\Content\\Hideable ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( !$comment->hidden() and $comment->canHide() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('hide')->csrf(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'hide', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'hide', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nelseif ( $comment->hidden() and $comment->canUnhide() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('unhide')->csrf(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'unhide', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $comment->canSplit() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('split'), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action='splitComment' data-ipsDialog data-ipsDialog-title=\"\nCONTENT;\n\n$sprintf = array(\\IPS\\Member::loggedIn()->language()->addToStack( $item::$title )); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'split_to_new', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'split', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $comment->canDelete() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('delete')->csrf()->setQueryString('page',\\IPS\\Request::i()->page), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action='deleteComment' data-updateOnDelete=\"#commentCount\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'delete', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/ul>\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<li class='ipsHide' data-role='commentLoading'>\n\t\t\t\t<span class='ipsLoading ipsLoading_tiny ipsLoading_noAnim'><\/span>\n\t\t\t<\/li>\n\t\t<\/ul>\n\t<\/div>\n\n\t<div class='ipsMenu ipsMenu_wide ipsHide cPostShareMenu' id='elShareComment_\nCONTENT;\n$return .= htmlspecialchars( $comment->id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu'>\n\t\t<div class='ipsPad'>\n\t\t\t<h4 class='ipsType_sectionHead'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'share_this_comment', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h4>\n\t\t\t<hr class='ipsHr'>\n\t\t\t<h5 class='ipsType_normal ipsType_reset'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'link_to_comment', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h5>\n\t\t\t<input type='text' value='\nCONTENT;\n$return .= htmlspecialchars( $comment->item()->url()->setQueryString( array( 'do' => 'findComment', 'comment' => $comment->id ) ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsField_fullWidth'>\n\t\t\t\nCONTENT;\n\nif ( count( $comment->sharelinks() ) ):\n$return .= <<<CONTENT\n\n\t\t\t<h5 class='ipsType_normal ipsType_reset ipsSpacer_top'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'share_externally', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h5>\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->sharelinks( $comment );\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t<\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction commentContainer( $item, $comment ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\n$idField = $comment::$databaseColumnId;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\n$itemClassSafe = str_replace( '\\\\', '_', mb_substr( $comment::$itemClass, 4 ) );\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( $comment->isIgnored() ):\n$return .= <<<CONTENT\n\n\t<div class='ipsComment ipsComment_ignored ipsPad_half ipsType_light' id='elIgnoreComment_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ignoreCommentID='elComment_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ignoreUserID='\nCONTENT;\n$return .= htmlspecialchars( $comment->author()->member_id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t\t\nCONTENT;\n\n$sprintf = array($comment->author()->name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'ignoring_content', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n <a href='#elIgnoreComment_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu' data-ipsMenu data-ipsMenu-menuID='elIgnoreComment_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu' data-ipsMenu-appendTo='#elIgnoreComment_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action=\"ignoreOptions\" title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'see_post_ignore_options', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' class='ipsType_blendLinks'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'options', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n <i class='fa fa-caret-down'><\/i><\/a>\n\t\t<ul class='ipsMenu ipsHide' id='elIgnoreComment_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu'>\n\t\t\t<li class='ipsMenu_item' data-ipsMenuValue='showPost'><a href='#'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'show_this_comment', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t<li class='ipsMenu_sep'><hr><\/li>\n\t\t\t<li class='ipsMenu_item' data-ipsMenuValue='stopIgnoring'><a href='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=ignore&do=remove&id={$comment->author()->member_id}\", null, \"ignore\", array(), 0 ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$sprintf = array($comment->author()->name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'stop_ignoring_posts_by', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=ignore\", null, \"ignore\", array(), 0 ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'change_ignore_preferences', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t<\/ul>\n\t<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n<a id='comment-\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'><\/a>\n<article itemscope \nCONTENT;\n\nif ( $comment->author()->hasHighlightedReplies() ):\n$return .= <<<CONTENT\ndata-memberGroup=\"\nCONTENT;\n$return .= htmlspecialchars( $comment->author()->member_group_id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n itemtype=\"http:\/\/schema.org\/Comment\" id='elComment_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsComment \nCONTENT;\n\nif ( in_array( 'IPS\\Content\\Reputation', class_implements( $comment ) ) and \\IPS\\Settings::i()->reputation_highlight and $comment->reputation() >= \\IPS\\Settings::i()->reputation_highlight and \\IPS\\Settings::i()->reputation_enabled ):\n$return .= <<<CONTENT\nipsComment_popular\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n ipsComment_parent ipsClearfix ipsClear \nCONTENT;\n\nif ( $comment->isIgnored() ):\n$return .= <<<CONTENT\nipsHide\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( $comment->author()->hasHighlightedReplies() ):\n$return .= <<<CONTENT\nipsComment_highlighted\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\nif ( $comment->hidden() ):\n$return .= <<<CONTENT\nipsModerated\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->comment( $item, $comment, $item::$formLangPrefix . 'comment', $item::$application, $item::$module, $itemClassSafe );\n$return .= <<<CONTENT\n\n<\/article>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction commentEditHistory( $editHistory, $comment ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( !\\IPS\\Request::i()->isAjax() ):\n$return .= <<<CONTENT\n\n<h1 class='ipsType_pageTitle'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit_history_title', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h1>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n<div class=\"ipsPad\" data-role=\"commentFeed\">\n\t\nCONTENT;\n\nif ( count($editHistory)  ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nforeach ( $editHistory as $edit ):\n$return .= <<<CONTENT\n\n\t<article class='ipsComment ipsComment_parent ipsClearfix ipsClear'>\n\t\t<div class='ipsComment_header ipsPhotoPanel ipsPhotoPanel_mini ipsPhotoPanel_notPhone'>\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( \\IPS\\Member::load( $edit['member'] ), 'mini' );\n$return .= <<<CONTENT\n\n\t\t\t<div>\n\t\t\t\t<h3 class='ipsComment_author ipsType_sectionHead'>\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::load( $edit['member'] )->link();\n$return .= <<<CONTENT\n\n\t\t\t\t<\/h3>\n\t\t\t\t<p class='ipsComment_meta ipsType_light'>\n\t\t\t\t\t\nCONTENT;\n\n$val = ( $edit['time'] instanceof \\IPS\\DateTime ) ? $edit['time'] : \\IPS\\DateTime::ts( $edit['time'] );$return .= $val->html();\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $edit['reason'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<br>\n\t\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $edit['reason'], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/p>\n\t\t\t<\/div>\n\t\t<\/div>\n\t\t<div class='ipsAreaBackground_reset ipsPad'>\n\t\t\t<div class='ipsType_richText'>\n\t\t\t\t{$edit['new']}\n\t\t\t<\/div>\n\t\t<\/div>\n\t<\/article>\n\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t<article class='ipsComment ipsComment_parent ipsClearfix ipsClear'>\n\t\t<div class='ipsComment_header ipsPhotoPanel ipsPhotoPanel_mini ipsPhotoPanel_notPhone'>\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( $comment->author(), 'mini' );\n$return .= <<<CONTENT\n\n\t\t\t<div>\n\t\t\t\t<h3 class='ipsComment_author ipsType_sectionHead'>\n\t\t\t\t\t{$comment->author()->link()}\n\t\t\t\t<\/h3>\n\t\t\t\t<p class='ipsComment_meta ipsType_light'>\n\t\t\t\t\t\nCONTENT;\n\n$val = ( $comment->mapped('date') instanceof \\IPS\\DateTime ) ? $comment->mapped('date') : \\IPS\\DateTime::ts( $comment->mapped('date') );$return .= $val->html();\n$return .= <<<CONTENT\n\n\t\t\t\t<\/p>\n\t\t\t<\/div>\n\t\t<\/div>\n\t\t<div class='ipsAreaBackground_reset ipsPad'>\n\t\t\t<div class='ipsType_richText'>\n\t\t\t\t{$edit['old']}\n\t\t\t<\/div>\n\t\t<\/div>\n\t<\/article>\n\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t<p class='ipsType_large ipsType_light'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'no_edit_history', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/div>\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction commentEditLine( $comment, $supportsReason=FALSE ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n<span class='ipsType_reset ipsType_medium ipsType_light' data-excludequote>\n\t<strong>\nCONTENT;\n\n$htmlsprintf = array(\\IPS\\DateTime::ts( $comment->mapped('edit_time') )->html(FALSE), htmlspecialchars( $comment->mapped('edit_member_name'), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE )); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'date_edited', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'htmlsprintf' => $htmlsprintf ) );\n$return .= <<<CONTENT\n<\/strong>\n\t\nCONTENT;\n\nif ( $supportsReason && $comment->mapped('edit_reason') ):\n$return .= <<<CONTENT\n\n\t\t<br>\nCONTENT;\n$return .= htmlspecialchars( $comment->mapped('edit_reason'), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->edit_log == 2 and ( \\IPS\\Settings::i()->edit_log_public or \\IPS\\Member::loggedIn()->modPermission('can_view_editlog') )  ):\n$return .= <<<CONTENT\n\n\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('editlog'), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='' data-ipsDialog data-ipsDialog-title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit_history_title', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit_history', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>(\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit_history', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n)<\/a>\n\t\t\nCONTENT;\n\nif ( !$comment->mapped('edit_show') AND \\IPS\\Member::loggedIn()->modPermission('can_view_editlog') ):\n$return .= <<<CONTENT\n\n\t\t<br>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'comment_edit_show_anyways', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/span>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction commentMultimod( $item, $type='comment' ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<input type=\"hidden\" name=\"csrfKey\" value=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Session::i()->csrfKey, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" \/>\n\nCONTENT;\n\n$method = $type . 'MultimodActions';\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( $actions = $item->$method() and count( $actions ) ):\n$return .= <<<CONTENT\n\n\t<div class=\"ipsClearfix\">\n\t\t<div class=\"ipsAreaBackground ipsPad ipsClearfix\" data-role=\"pageActionOptions\">\n\t\t\t<div class=\"ipsPos_right\">\n\t\t\t\t<select name=\"modaction\" data-role=\"moderationAction\">\n\t\t\t\t\t\nCONTENT;\n\nif ( in_array( 'approve', $actions ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<option value='approve' data-icon='check-circle'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'approve', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/option>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( in_array( 'split_merge', $actions ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<option value='split' data-icon='expand'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'split', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/option>\n\t\t\t\t\t\t<option value='merge' data-icon='level-up'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'merge', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/option>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( in_array( 'hide', $actions ) or in_array( 'unhide', $actions ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<optgroup label=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'hide', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" data-icon='eye' data-action='hide'>\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( in_array( 'hide', $actions ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<option value='hide'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'hide', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/option>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( in_array( 'unhide', $actions ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<option value='unhide'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'unhide', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/option>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/optgroup>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( in_array( 'delete', $actions ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<option value='delete' data-icon='trash'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'delete', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/option>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/select>\n\t\t\t\t<button type=\"submit\" class=\"ipsButton ipsButton_alternate ipsButton_verySmall\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'submit', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/button>\n\t\t\t<\/div>\n\t\t<\/div>\n\t<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction commentTableHeader( $comment, $status ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n\n<div class='ipsDataList ipsAreaBackground_light ipsClearfix'>\n\t<div class='ipsDataItem'>\n\t\t<div class='ipsDataItem_icon'>\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( $status->author() );\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t\t<div class='ipsDataItem_main'>\n\t\t\t<p class='ipsType_medium ipsType_light ipsType_blendLinks ipsType_reset'>\n\t\t\t\t\nCONTENT;\n\n$htmlsprintf = array($status->author()->link()); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'status_updated_by', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'htmlsprintf' => $htmlsprintf ) );\n$return .= <<<CONTENT\n\n\t\t\t<\/p>\n\t\t\t<div class='ipsType_richText ipsType_medium' data-ipsTruncate data-ipsTruncate-size='5 lines' data-ipsTruncate-type='remove'>\n\t\t\t\t{$status->truncated()}\n\t\t\t<\/div>\n\t\t<\/div>\n\t<\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction commentWarned( $comment ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n<!-- Moderator warning -->\n<div class=\"ipsType_reset ipsPad ipsAreaBackground_light ipsClearfix ipsPhotoPanel ipsPhotoPanel_mini\">\n\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( \\IPS\\Member::load( $comment->warning->moderator ), 'mini' );\n$return .= <<<CONTENT\n\n\t<div>\n\t\t<strong class='ipsType_warning ipsType_normal'>\nCONTENT;\n\n$sprintf = array(\\IPS\\Member::load( $comment->warning->moderator )->name, \\IPS\\Member::load( $comment->warning->member )->name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'member_given_post_warning', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n<\/strong>\n\t\t<br>\n\t\t<span class='ipsType_light'>\n\t\t\t<strong>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'warn_reason_message', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong> \nCONTENT;\n\n$val = \"core_warn_reason_{$comment->warning->reason}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n &middot; <strong>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'warn_points_message', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong> \nCONTENT;\n$return .= htmlspecialchars( $comment->warning->points, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n &middot; <a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=warnings&do=view&id={$comment->warning->member}&w={$comment->warning->id}\", null, \"warn_view\", array( $comment->author()->members_seo_name ), 0 ) );\n$return .= <<<CONTENT\n\" title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'view_warning_details_title', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-size='narrow'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'view_warning_details', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t<\/span>\n\t<\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction commentsAndReviewsTabs( $content, $id ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div data-controller='core.front.core.commentsWrapper' data-tabsId='\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t{$content}\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction controlStrip( $buttons ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<ul class='ipsControlStrip ipsType_noBreak ipsList_reset' data-ipsControlStrip>\n\t\nCONTENT;\n\nforeach ( $buttons as $button ):\n$return .= <<<CONTENT\n\n\t\t<li class='ipsControlStrip_button \nCONTENT;\n\nif ( isset( $button['hidden'] ) and $button['hidden'] ):\n$return .= <<<CONTENT\nipsJS_hide\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( isset( $button['id'] ) ):\n$return .= <<<CONTENT\nid=\"\nCONTENT;\n$return .= htmlspecialchars( $button['id'], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t<a\n\t\t\t\t\nCONTENT;\n\nif ( isset( $button['link'] ) ):\n$return .= <<<CONTENT\nhref='\nCONTENT;\n$return .= htmlspecialchars( $button['link'], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\ttitle='\nCONTENT;\n\n$val = \"{$button['title']}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'\n\t\t\t\tdata-ipsTooltip\n\t\t\t\taria-label=\"\nCONTENT;\n\n$val = \"{$button['title']}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\"\n\t\t\t\t\n\t\t\t\t\nCONTENT;\n\nif ( isset( $button['class'] ) ):\n$return .= <<<CONTENT\nclass='\nCONTENT;\n$return .= htmlspecialchars( $button['class'], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( isset( $button['data'] ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nforeach ( $button['data'] as $k => $v ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\tdata-\nCONTENT;\n$return .= htmlspecialchars( $k, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n=\"\nCONTENT;\n$return .= htmlspecialchars( $v, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\"\n\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( isset( $button['hotkey'] ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\tdata-keyAction='\nCONTENT;\n$return .= htmlspecialchars( $button['hotkey'], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t>\n\t\t\t\t<i class='ipsControlStrip_icon fa fa-\nCONTENT;\n$return .= htmlspecialchars( $button['icon'], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'><\/i>\n\t\t\t\t<span class='ipsControlStrip_item'>\nCONTENT;\n\n$val = \"{$button['title']}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t<\/a>\n\t\t<\/li>\n\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n<\/ul>\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction coverPhoto( $url, $coverPhoto ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div class='ipsPageHead_special ipsCoverPhoto' data-controller='core.front.core.coverPhoto' data-url=\"\nCONTENT;\n$return .= htmlspecialchars( $url->csrf(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-coverOffset='\nCONTENT;\n$return .= htmlspecialchars( $coverPhoto->offset, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t\nCONTENT;\n\nif ( $coverPhoto->file ):\n$return .= <<<CONTENT\n\n\t\t<div class='ipsCoverPhoto_container'>\n\t\t\t<img src='\nCONTENT;\n$return .= htmlspecialchars( $coverPhoto->file->url, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsCoverPhoto_photo' alt=''>\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( $coverPhoto->editable ):\n$return .= <<<CONTENT\n\n\t\t<a href='#elEditPhoto_menu' data-hideOnCoverEdit class='ipsCoverPhoto_button ipsPos_right ipsButton ipsButton_verySmall ipsButton_narrow ipsButton_overlaid' data-ipsMenu id='elEditPhoto' data-role='coverPhotoOptions'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'cover_photo_button', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n <i class='fa fa-caret-down'><\/i><\/a>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<div class='ipsColumns ipsColumns_collapsePhone' data-hideOnCoverEdit>\n\t\t<div class='ipsColumn ipsColumn_fluid'>\n\t\t\t\nCONTENT;\n\nif ( $coverPhoto->editable ):\n$return .= <<<CONTENT\n\n\t\t\t\t<ul class='ipsMenu ipsMenu_auto ipsHide' id='elEditPhoto_menu'>\n\t\t\t\t\t\nCONTENT;\n\nif ( $coverPhoto->file ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li class='ipsMenu_item'>\n\t\t\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $url->setQueryString( 'do', 'coverPhotoRemove' )->csrf(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action='removeCoverPhoto'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'cover_photo_remove', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t<li class='ipsMenu_item ipsHide'>\n\t\t\t\t\t\t\t<a href='#' data-action='positionCoverPhoto'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'cover_photo_reposition', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class='ipsMenu_item'>\n\t\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $url->setQueryString( 'do', 'coverPhotoUpload' ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'cover_photo_add', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'cover_photo_add', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t<\/li>\n\t\t\t\t<\/ul>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t{$coverPhoto->overlay}\n\t\t<\/div>\n\t<\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction customFieldsDisplay( $author ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nforeach ( $author->contentProfileFields() as $group => $fields ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nforeach ( $fields as $field => $value ):\n$return .= <<<CONTENT\n\n\t<li class='ipsResponsive_hidePhone ipsType_break'>\n\t\t{$value}\n\t<\/li>\n\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction designersModeBuilding( $html, $title=NULL ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<!DOCTYPE html>\n<html lang=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->language()->bcp47(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" dir=\"\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->language()->isrtl ):\n$return .= <<<CONTENT\nrtl\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nltr\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\">\n\t<head>\n\t\t<title>\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Output::i()->getTitle( $title ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/title>\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'global' )->includeMeta(  );\n$return .= <<<CONTENT\n\n\t<style type=\"text\/css\">\n\t\t\/* ======================================================== *\/\n\/* PROGRESS BAR *\/\n@-webkit-keyframes progress-bar-stripes {\n  from { background-position: 40px 0; }\n  to { background-position: 0 0; }\n}\n@-moz-keyframes progress-bar-stripes {\n  from { background-position: 40px 0; }\n  to { background-position: 0 0; }\n}\n@-ms-keyframes progress-bar-stripes {\n  from { background-position: 40px 0; }\n  to { background-position: 0 0; }\n}\n@-o-keyframes progress-bar-stripes {\n  from { background-position: 0 0; }\n  to { background-position: 40px 0; }\n}\n@keyframes progress-bar-stripes {\n  from { background-position: 40px 0; }\n  to { background-position: 0 0; }\n}\n\n.ipsProgressBar {\n\twidth: 50%;\n\tmargin: auto;\n\theight: 26px;\n\toverflow: hidden;\n\tbackground: rgb(156,156,156);\n\tbackground: -moz-linear-gradient(top, rgba(156,156,156,1) 0%, rgba(180,180,180,1) 100%);\n\tbackground: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(156,156,156,1)), color-stop(100%,rgba(180,180,180,1)));\n\tbackground: -webkit-linear-gradient(top, rgba(156,156,156,1) 0%,rgba(180,180,180,1) 100%);\n\tbackground: -o-linear-gradient(top, rgba(156,156,156,1) 0%,rgba(180,180,180,1) 100%);\n\tbackground: -ms-linear-gradient(top, rgba(156,156,156,1) 0%,rgba(180,180,180,1) 100%);\n\tbackground: linear-gradient(to bottom, rgba(156,156,156,1) 0%,rgba(180,180,180,1) 100%);\n\tborder-radius: 4px;\n\tbox-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);\n}\n\t\n\t.ipsProgressBar.ipsProgressBar_fullWidth {\n\t\twidth: 100%;\n\t}\n\n\t.ipsProgressBar.ipsProgressBar_animated .ipsProgressBar_progress {\n\t\tbackground-color: #5490c0;\n\t\tbackground-image: -webkit-gradient(linear, 0 100%, 100% 0, color-stop(0.25, rgba(255, 255, 255, 0.15)), color-stop(0.25, transparent), color-stop(0.5, transparent), color-stop(0.5, rgba(255, 255, 255, 0.15)), color-stop(0.75, rgba(255, 255, 255, 0.15)), color-stop(0.75, transparent), to(transparent));\n\t\tbackground-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);\n\t\tbackground-image: -moz-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);\n\t\tbackground-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);\n\t\tbackground-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);\n\t\tbackground-size: 40px 40px;\n\t}\n\n.ipsProgressBar_progress {\n\tfloat: left;\n\twidth: 0;\n\theight: 100%;\n\tfont-size: 12px;\n\tfont-weight: bold;\n\tcolor: #ffffff;\n\ttext-align: center;\n\ttext-shadow: 1px 1px 0 rgba(0, 0, 0, 0.25);\n\tbackground: #5490c0;\n\tposition: relative;\n\twhite-space: nowrap;\n\tline-height: 26px;\n}\n\t\n\t.ipsProgressBar_warning .ipsProgressBar_progress {\n\t\tbackground: #8c3737;\n\t}\n\n\t.ipsProgressBar > span:first-child {\n\t\tpadding-left: 7px;\n\t}\n\n\t.ipsProgressBar_progress[data-progress]:after {\n\t\tposition: absolute;\n\t\tright: 5px;\n\t\ttop: 0;\n\t\tline-height: 32px;\n\t\tcolor: #fff;\n\t\tcontent: attr(data-progress);\n\t\tdisplay: block;\n\t\tfont-weight: bold;\n\t}\n\t\n\tspan[data-role=message] {\n\t\ttext-align: center;\n\t\tdisplay: block;\n\t\tmargin: 8px;\n\t\tfont-family: Helvetica;\n\t}\n\n\t<\/style>\n\t<\/head>\n\t<body class=\"ipsApp ipsApp_front ipsJS_none ipsClearfix ipsLayout_noBackground\">\n\t\t{$html}\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'global' )->includeJS(  );\n$return .= <<<CONTENT\n\n\t<\/body>\n<\/html>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction embedComment( $item, $comment, $url, $image=NULL ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div class='ipsEmbedded \nCONTENT;\n\nif ( $image ):\n$return .= <<<CONTENT\nipsEmbedded_withImage\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t<div class='ipsEmbedded_headerArea'>\n\t\t<h4 class='ipsType_reset ipsType_normal ipsTruncate ipsTruncate_line'>\n\t\t\t<i class='fa fa-\nCONTENT;\n$return .= htmlspecialchars( $comment::$icon, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsTooltip title='\nCONTENT;\n\n$val = \"{$comment::$title}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'><\/i> &nbsp;\n\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $url, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' target='_top'>\n\t\t\t\t\nCONTENT;\n\nif ( $item::$firstCommentRequired ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $comment->isFirst() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $item->mapped('title'), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\n$sprintf = array($item->mapped('title')); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'embed_reply_to', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$sprintf = array($item->mapped('title')); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'embed_comment_on', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/a>\n\t\t<\/h4>\n\t<\/div>\n\t<div class='ipsEmbedded_content'>\n\t\t<div class='ipsPhotoPanel ipsPhotoPanel_notPhone ipsPhotoPanel_mini ipsClearfix ipsType_medium'>\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( $comment->author(), 'mini', NULL, '', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t<div>\n\t\t\t\t<span class='ipsType_light ipsType_small'>\nCONTENT;\n\n$sprintf = array($comment->author()->name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'byline', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n \nCONTENT;\n\n$val = ( $comment->mapped('date') instanceof \\IPS\\DateTime ) ? $comment->mapped('date') : \\IPS\\DateTime::ts( $comment->mapped('date') );$return .= $val->html();\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t<div data-ipsTruncate data-ipsTruncate-size='1 lines' data-ipsTruncate-type='remove'>\n\t\t\t\t\t{$comment->truncated( TRUE )}\n\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t<\/div>\n\t<\/div>\n\t\nCONTENT;\n\nif ( $image ):\n$return .= <<<CONTENT\n\n\t\t<div style='background-image: url( \"\nCONTENT;\n\n$return .= htmlspecialchars( str_replace( array( '(', ')' ), array( '\\(', '\\)' ), $image->url ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" );' class='ipsEmbedded_image'>\n\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $url, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' target='_top'>\n\t\t\t\t<img src='\nCONTENT;\n$return .= htmlspecialchars( $image->url, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t\t\t<\/a>\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction embedExternal( $output, $js ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<!DOCTYPE html>\n<html lang=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->language()->bcp47(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" dir=\"\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->language()->isrtl ):\n$return .= <<<CONTENT\nrtl\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nltr\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\">\n\t<head>\n\t\t<script type='text\/javascript'>\n\t\t\tvar ipsDebug = \nCONTENT;\n\nif ( ( \\IPS\\IN_DEV and \\IPS\\DEV_DEBUG_JS ) or \\IPS\\DEBUG_JS ):\n$return .= <<<CONTENT\ntrue\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nfalse\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n;\n\t\t<\/script>\n\n\t\t\nCONTENT;\n\nif ( is_array( $js ) ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nforeach ( $js as $jsInclude ):\n$return .= <<<CONTENT\n\n\t\t\t\t<script type='text\/javascript' src='\nCONTENT;\n$return .= htmlspecialchars( $jsInclude, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'><\/script>\n\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t\t<style type='text\/css' rel='stylesheet'>\n\t\t\tbody {\n\t\t\t\tpadding: 0;\n\t\t\t\tmargin: 0;\n\t\t\t}\n\t\t\tbody #ipsEmbedLoading {\n\t\t\t\tdisplay: none;\n\t\t\t}\n\t\t\tbody.unloaded #ipsEmbedLoading {\n\t\t\t\tdisplay: block;\n\t\t\t\tposition: fixed;\n\t\t\t\ttop: 0;\n\t\t\t\tleft: 0;\n\t\t\t\tright: 0;\n\t\t\t\tbottom: 0;\n\t\t\t\tborder: 1px solid rgba(0,0,0,0.05);\n\t\t\t\tbackground: #fff;\n\t\t\t}\n\n\t\t\t@-webkit-keyframes dummy_anim {\n\t\t\t  0% { background-color: #f8f8f8; }\n\t\t\t  50% { background-color: #f2f2f2; }\n\t\t\t  99% { background-color: #f8f8f8; }\n\t\t\t}\n\t\t\t@-moz-keyframes dummy_anim {\n\t\t\t  0% { background-color: #f8f8f8; }\n\t\t\t  50% { background-color: #f2f2f2; }\n\t\t\t  99% { background-color: #f8f8f8; }\n\t\t\t}\n\t\t\t@-ms-keyframes dummy_anim {\n\t\t\t  0% { background-color: #f8f8f8; }\n\t\t\t  50% { background-color: #f2f2f2; }\n\t\t\t  99% { background-color: #f8f8f8; }\n\t\t\t}\n\t\t\t@-o-keyframes dummy_anim {\n\t\t\t  0% { background-color: #f8f8f8; }\n\t\t\t  50% { background-color: #f2f2f2; }\n\t\t\t  99% { background-color: #f8f8f8; }\n\t\t\t}\n\t\t\t@keyframes dummy_anim {\n\t\t\t  0% { background-color: #f8f8f8; }\n\t\t\t  50% { background-color: #f2f2f2; }\n\t\t\t  99% { background-color: #f8f8f8; }\n\t\t\t}\n\t\t\t#ipsEmbedLoading:before,\n\t\t\t#ipsEmbedLoading:after,\n\t\t\t#ipsEmbedLoading span:before,\n\t\t\t#ipsEmbedLoading span:after {\n\t\t\t\tdisplay: block;\n\t\t\t\tcontent: '';\n\t\t\t\tposition: absolute;\n\t\t\t\t\nCONTENT;\n\n$return .= \"-webkit-animation: dummy_anim 1s infinite;\r\n\t-moz-animation: dummy_anim 1s infinite;\r\n\t-ms-animation: dummy_anim 1s infinite;\r\n\t-o-animation: dummy_anim 1s infinite;\r\n\tanimation: dummy_anim 1s infinite;\";\n$return .= <<<CONTENT\n\n\t\t\t}\n\t\t\t#ipsEmbedLoading:before {\n\t\t\t\twidth: 50px;\n\t\t\t\theight: 50px;\n\t\t\t\ttop: 15px;\n\t\t\t\tleft: 15px;\n\t\t\t}\n\t\t\t#ipsEmbedLoading:after {\n\t\t\t\twidth: 300px;\n\t\t\t\theight: 17px;\n\t\t\t\ttop: 15px;\n\t\t\t\tleft: 80px;\n\t\t\t}\n\t\t\t#ipsEmbedLoading span:before {\n\t\t\t\twidth: 200px;\n\t\t\t\theight: 12px;\n\t\t\t\ttop: 40px;\n\t\t\t\tleft: 80px;\n\t\t\t}\n\t\t\t#ipsEmbedLoading span:after {\n\t\t\t\twidth: 90%;\n\t\t\t\topacity: 0.5;\n\t\t\t\tleft: 15px;\n\t\t\t\ttop: 80px;\n\t\t\t\tbottom: 15px;\n\t\t\t}\n\n\t\t\t.ipsJS_has#ipsEmbed {\n\t\t\t\topacity: 0.0001;\n\t\t\t}\n\t\t<\/style>\n\t<\/head>\n\t<body class='unloaded \nCONTENT;\n\nif ( isset( \\IPS\\Request::i()->cookie['hasJS'] ) ):\n$return .= <<<CONTENT\nipsJS_has\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsJS_none\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\t<div id='ipsEmbed'>\n\t\t\t{$output}\n\t\t<\/div>\n\t\t<div id='ipsEmbedLoading'>\n\t\t\t<span><\/span>\n\t\t<\/div>\n\t<\/body>\n<\/html>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction embedItem( $item, $url, $image=NULL ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div class='ipsEmbedded \nCONTENT;\n\nif ( $image ):\n$return .= <<<CONTENT\nipsEmbedded_withImage\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t<div class='ipsEmbedded_headerArea'>\n\t\t<h4 class='ipsType_reset ipsType_normal ipsTruncate ipsTruncate_line'><i class='fa fa-\nCONTENT;\n$return .= htmlspecialchars( $item::$icon, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsTooltip title='\nCONTENT;\n\n$val = \"{$item::$title}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'><\/i> &nbsp;<a href='\nCONTENT;\n$return .= htmlspecialchars( $url, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' target='_top'>\nCONTENT;\n$return .= htmlspecialchars( $item->mapped('title'), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a><\/h4>\n\t<\/div>\n\t<div class='ipsEmbedded_content'>\n\t\t<div class='ipsPhotoPanel ipsPhotoPanel_notPhone ipsPhotoPanel_mini ipsClearfix ipsType_medium'>\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( $item->author(), 'mini', NULL, '', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t<div>\n\t\t\t\t\nCONTENT;\n\nif ( $container = $item->containerWrapper() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<span class='ipsType_light ipsType_small'>\n\t\t\t\t\t\t\nCONTENT;\n\n$sprintf = array($item->author()->name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'byline_nodate', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'in', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n \nCONTENT;\n$return .= htmlspecialchars( $container->_title, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n, \nCONTENT;\n\n$val = ( $item->mapped('date') instanceof \\IPS\\DateTime ) ? $item->mapped('date') : \\IPS\\DateTime::ts( $item->mapped('date') );$return .= $val->html();\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/span>\n\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t<span class='ipsType_light ipsType_small'>\nCONTENT;\n\n$sprintf = array($item->author()->name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'byline', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n \nCONTENT;\n\n$val = ( $item->mapped('date') instanceof \\IPS\\DateTime ) ? $item->mapped('date') : \\IPS\\DateTime::ts( $item->mapped('date') );$return .= $val->html();\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<div data-ipsTruncate data-ipsTruncate-size='1 lines' data-ipsTruncate-type='remove'>\n\t\t\t\t\t{$item->truncated( TRUE )}\n\t\t\t\t<\/div>\n\t\t\t\t<ul class='ipsList_inline ipsType_small ipsEmbedded_stats'>\n\t\t\t\t\t\nCONTENT;\n\nif ( $item instanceof \\IPS\\Content\\Ratings and $rating = $item->averageRating() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li>\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->rating( 'small', $rating, 5, $item->memberRating() );\n$return .= <<<CONTENT\n<\/li>\n\t\t\t\t\t\nCONTENT;\n\nelseif ( isset( $item::$reviewClass ) AND $rating = $item->averageReviewRating() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li>\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->rating( 'small', $rating, \\IPS\\Settings::i()->reviews_rating_out_of, $item->memberReviewRating() );\n$return .= <<<CONTENT\n<span class='ipsType_light'>\nCONTENT;\n\nif ( $item->reviews ):\n$return .= <<<CONTENT\n(\nCONTENT;\n\n$pluralize = array( $item->reviews ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'from_num_reviews', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n)\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'no_reviews_yet', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n<\/span><\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $item::$commentClass ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $item::$firstCommentRequired ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li><i class='fa fa-comment'><\/i> \nCONTENT;\n\n$pluralize = array( $item->mapped('num_comments') - 1 ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'replies_number', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n<\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li><i class='fa fa-comment'><\/i> \nCONTENT;\n\n$pluralize = array( $item->mapped('num_comments') ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'num_comments', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n<\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/ul>\n\t\t\t<\/div>\n\t\t<\/div>\n\t<\/div>\n\t\nCONTENT;\n\nif ( $image ):\n$return .= <<<CONTENT\n\n\t\t<div style='background-image: url( \"\nCONTENT;\n\n$return .= htmlspecialchars( str_replace( array( '(', ')' ), array( '\\(', '\\)' ), $image->url ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" );' class='ipsEmbedded_image'>\n\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $url, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' target='_top'>\n\t\t\t\t<img src='\nCONTENT;\n$return .= htmlspecialchars( $image->url, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t\t\t<\/a>\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction embedReview( $item, $review, $url, $image=NULL ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div class='ipsEmbedded \nCONTENT;\n\nif ( $image ):\n$return .= <<<CONTENT\nipsEmbedded_withImage\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t<div class='ipsEmbedded_headerArea'>\n\t\t<h4 class='ipsType_reset ipsType_normal ipsTruncate ipsTruncate_line'>\n\t\t\t<i class='fa fa-\nCONTENT;\n$return .= htmlspecialchars( $review::$icon, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsTooltip title='\nCONTENT;\n\n$val = \"{$review::$title}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'><\/i> &nbsp;\n\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $url, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' target='_top'>\n\t\t\t\t\nCONTENT;\n\n$sprintf = array($item->mapped('title')); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'embed_review_of', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\n\t\t\t<\/a>\n\t\t<\/h4>\n\t<\/div>\n\t<div class='ipsEmbedded_content'>\n\t\t<div class='ipsPhotoPanel ipsPhotoPanel_notPhone ipsPhotoPanel_mini ipsClearfix ipsType_medium'>\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( $review->author(), 'mini', NULL, '', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t<div>\n\t\t\t\t<span class='ipsType_light ipsType_small'>\nCONTENT;\n\n$sprintf = array($review->author()->name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'byline', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n \nCONTENT;\n\n$val = ( $review->mapped('date') instanceof \\IPS\\DateTime ) ? $review->mapped('date') : \\IPS\\DateTime::ts( $review->mapped('date') );$return .= $val->html();\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->rating( 'small', $review->mapped('rating') );\n$return .= <<<CONTENT\n\n\t\t\t\t<div data-ipsTruncate data-ipsTruncate-size='1 lines' data-ipsTruncate-type='remove'>\n\t\t\t\t\t{$review->truncated( TRUE )}\n\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t<\/div>\n\t<\/div>\n\t\nCONTENT;\n\nif ( $image ):\n$return .= <<<CONTENT\n\n\t\t<div style='background-image: url( \"\nCONTENT;\n\n$return .= htmlspecialchars( str_replace( array( '(', ')' ), array( '\\(', '\\)' ), $image->url ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" );' class='ipsEmbedded_image'>\n\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $url, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' target='_top'>\n\t\t\t\t<img src='\nCONTENT;\n$return .= htmlspecialchars( $image->url, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t\t\t<\/a>\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction error( $title, $message, $code, $extra, $member, $faultyPluginOrApp=NULL ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n<section id='elError' class='ipsType_center'>\n\t<div class='ipsAreaBackground_light ipsPad'>\n\t\t<i class='fa fa-exclamation-circle ipsType_huge'><\/i>\n\t\t<p class='ipsType_reset ipsType_light ipsType_large'>\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'something_went_wrong', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t<\/p>\n\t\t<div id='elErrorMessage' class='ipsPos_center'>\n\t\t\t{$message}\n\t\t<\/div>\n\t\t<p class='ipsType_light ipsType_reset ipsType_normal'>\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'error_page_code', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n <strong>\nCONTENT;\n$return .= htmlspecialchars( $code, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/strong>\n\t\t<\/p>\n\t\t\nCONTENT;\n\nif ( ( \\IPS\\IN_DEV or $member->isAdmin() ) and $extra ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( $faultyPluginOrApp ):\n$return .= <<<CONTENT\n\n\t\t\t<p class=\"ipsType_reset  ipsType_large ipsPos_center\">\n\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $faultyPluginOrApp, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t<\/p>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t\t\t<div class=\"ipsPad ipsType_left\">\n\t\t\t\t<h3 class=\"ipsType_minorHeading\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'error_technical_details', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h3>\n\t\t\t\t<textarea rows=\"13\" style=\"font-family: monospace;\">\nCONTENT;\n$return .= htmlspecialchars( $extra, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/textarea>\n\t\t\t\t<p class=\"ipsType_small ipsType_light\">\n\t\t\t\t\t\nCONTENT;\n\nif ( $member->isAdmin() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'error_technical_details_desc', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $member->hasAcpRestriction( 'core', 'support', 'system_logs_view' ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'error_technical_details_logs', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nelseif ( \\IPS\\IN_DEV ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'error_technical_details_dev', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/p>\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/div>\n\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->isAdmin() and \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'support', 'get_support' ) ):\n$return .= <<<CONTENT\n\n\t\t<p class='ipsType_light ipsType_large'>\n\t\t\t<a href='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=support&controller=support\", \"admin\", \"\", array(), 0 ) );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'get_support', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\n\t\t\t\t<i class=\"fa fa-lock\"><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'get_support', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t<\/a>\n\t\t<\/p>\n\t\nCONTENT;\n\nelseif ( \\IPS\\core\\modules\\front\\contact\\contact::canUseContactUs() and !( \\IPS\\Dispatcher::i()->application->directory == 'core' and \\IPS\\Dispatcher::i()->module and \\IPS\\Dispatcher::i()->module->key == 'contact' ) ):\n$return .= <<<CONTENT\n\n\t\t<p class='ipsType_light ipsType_large'>\n\t\t\t<a href='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=contact&controller=contact\", null, \"contact\", array(), 0 ) );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'contact_admin', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'contact_admin', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t<\/a>\n\t\t<\/p>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( !\\IPS\\Member::loggedIn()->member_id ):\n$return .= <<<CONTENT\n\n\t\t<br>\n\t\t<a href='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=login\", null, \"login\", array(), 0 ) );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_normal ipsButton_medium' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sign_in', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sign_in', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t<\/a>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/section>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction favico(  ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( isset( \\IPS\\Theme::i()->logo['favicon'] ) and \\IPS\\Theme::i()->logo['favicon'] !== null ):\n$return .= <<<CONTENT\n\n\t<link rel='shortcut icon' href='\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->logo_favicon;\n$return .= <<<CONTENT\n'>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction findComment( $header, $item, $comment ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\n$idField = $comment::$databaseColumnId;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\n$itemClassSafe = str_replace( '\\\\', '_', mb_substr( $comment::$itemClass, 4 ) );\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( ! \\IPS\\Request::i()->isAjax() ):\n$return .= <<<CONTENT\n\n\t<h1 class='ipsType_pageTitle'><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $item->url()->setQueryString( array( 'do' => 'findComment', 'comment' => $comment->$idField ) ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n$return .= htmlspecialchars( $header, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a><\/h1>\n\t<br \/>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<article itemscope itemtype=\"http:\/\/schema.org\/Comment\" id='elComment_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsComment \nCONTENT;\n\nif ( in_array( 'IPS\\Content\\Reputation', class_implements( $comment ) ) and \\IPS\\Settings::i()->reputation_highlight and $comment->reputation() >= \\IPS\\Settings::i()->reputation_highlight ):\n$return .= <<<CONTENT\nipsComment_popular\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n ipsComment_parent ipsClearfix ipsClear \nCONTENT;\n\nif ( $comment->hidden() ):\n$return .= <<<CONTENT\nipsModerated\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t<div id='comment-\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_wrap' data-controller='core.front.core.comment' data-commentApp='\nCONTENT;\n$return .= htmlspecialchars( $comment::$application, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-commentType='\nCONTENT;\n$return .= htmlspecialchars( $item::$module, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-commentID=\"\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-quoteData='\nCONTENT;\n\n$return .= htmlspecialchars( json_encode( array('userid' => $comment->author()->member_id, 'username' => $comment->author()->name, 'timestamp' => $comment->mapped('date'), 'contentapp' => $comment::$application, 'contenttype' => $item::$module, 'contentclass' => $itemClassSafe, 'contentid' => $item->id, 'contentcommentid' => $comment->$idField) ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsComment_content ipsType_medium'>\n\t\t\nCONTENT;\n\nif ( in_array( 'IPS\\Content\\Reputation', class_implements( $comment ) ) and \\IPS\\Settings::i()->reputation_highlight and $comment->reputation() >= \\IPS\\Settings::i()->reputation_highlight and \\IPS\\Settings::i()->reputation_enabled ):\n$return .= <<<CONTENT\n\n\t\t\t<strong class='ipsComment_popularFlag' data-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'this_is_a_popular_comment', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'><i class='fa fa-heart'><\/i><\/strong>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\n\t\t<div class='ipsComment_header ipsPhotoPanel ipsPhotoPanel_mini ipsPhotoPanel_notPhone'>\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( $comment->author(), 'mini', $comment->warningRef() );\n$return .= <<<CONTENT\n\n\t\t\t<div>\n\t\t\t\t<h3 class='ipsComment_author ipsType_blendLinks'>\n\t\t\t\t\t<strong class='ipsType_sectionHead'>\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userLink( $comment->author(), $comment->warningRef() );\n$return .= <<<CONTENT\n<\/strong>\n\t\t\t\t<\/h3>\n\t\t\t\t<p class='ipsComment_meta ipsType_light ipsType_medium'>\n\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->item()->url()->setQueryString( array( 'do' => 'findComment', 'comment' => $comment->id ) ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsType_blendLinks'>{$comment->dateLine()}<\/a>\n\t\t\t\t\t\nCONTENT;\n\nif ( $comment->editLine() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t&middot; {$comment->editLine()}\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $comment->hidden() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t&middot; \nCONTENT;\n$return .= htmlspecialchars( $comment->hiddenBlurb(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/p>\n\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->modPermission('mod_see_warn') and $comment->warning ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->commentWarned( $comment );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t<\/div>\n\t\t<div class='ipsAreaBackground_reset ipsPad'>\t\t\t\n\t\t\t<div data-role='commentContent' class='ipsType_richText ipsContained' data-controller='core.front.core.lightboxedImages'>\n\t\t\t\t\nCONTENT;\n\nif ( $comment->hidden() === 1 && $comment->author()->member_id == \\IPS\\Member::loggedIn()->member_id ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<strong class='ipsType_medium ipsType_warning'><i class='fa fa-info-circle'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'comment_awaiting_approval', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t{$comment->content()}\n\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nif ( $comment->hidden() !== 1 && $comment instanceof \\IPS\\Content\\Reputation and \\IPS\\Settings::i()->reputation_enabled ):\n$return .= <<<CONTENT\n\n\t\t\t\t<br>\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->reputation( $comment );\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t<\/div>\n<\/article>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction follow( $app, $area, $id, $count ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n<div data-followApp='\nCONTENT;\n$return .= htmlspecialchars( $app, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-followArea='\nCONTENT;\n$return .= htmlspecialchars( $area, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-followID='\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-controller='core.front.core.followButton'>\n\t\nCONTENT;\n\nif ( !\\IPS\\Member::loggedIn()->member_id ):\n$return .= <<<CONTENT\n\n\t\t<span class='ipsType_light ipsType_blendLinks ipsResponsive_hidePhone ipsResponsive_inline'><i class='fa fa-info-circle'><\/i> <a href='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=login\", null, \"login\", array(), 0 ) );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sign_in_title', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'follow_sign_in', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>&nbsp;&nbsp;<\/span>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->followButton( $app, $area, $id, $count );\n$return .= <<<CONTENT\n\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction followButton( $app, $area, $id, $count ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->member_id ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->following( $app, $area, $id ) ):\n$return .= <<<CONTENT\n\n\t\t<div class=\"ipsFollow ipsButton ipsButton_primary ipsButton_verySmall\" data-role=\"followButton\" data-following=\"true\">\n\t\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=notifications&do=follow&follow_app={$app}&follow_area={$area}&follow_id={$id}\", null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n\" title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'following_this_content', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" data-ipsTooltip class=\"ipsType_blendLinks ipsType_noUnderline\" data-ipsHover data-ipsHover-cache='false' data-ipsHover-onClick><i class='fa fa-check'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'following_this', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n <i class='fa fa-caret-down'><\/i><\/a>\n\t\t\t<a class='ipsCommentCount' href='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=notifications&do=followers&follow_app={$app}&follow_area={$area}&follow_id={$id}\", null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'followers_tooltip', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsTooltip data-ipsDialog data-ipsDialog-size='narrow' data-ipsDialog-title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'who_follows_this', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n$return .= htmlspecialchars( $count, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a>\n\t\t<\/div>\n\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\t\n\t\t<div class=\"ipsFollow ipsButton ipsButton_light ipsButton_verySmall\" data-role=\"followButton\" data-following=\"false\">\n\t\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=notifications&do=follow&follow_app={$app}&follow_area={$area}&follow_id={$id}\", null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n\" title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'follow_this_content', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" data-ipsTooltip class=\"ipsType_blendLinks ipsType_noUnderline\" data-ipsHover data-ipsHover-cache='false' data-ipsHover-onClick>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'follow', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\nCONTENT;\n\nif ( $count > 0 ):\n$return .= <<<CONTENT\n\n\t\t\t\t<a class='ipsCommentCount' href='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=notifications&do=followers&follow_app={$app}&follow_area={$area}&follow_id={$id}\", null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'followers_tooltip', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsTooltip data-ipsDialog data-ipsDialog-size='narrow' data-ipsDialog-title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'who_follows_this', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n$return .= htmlspecialchars( $count, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t<span class='ipsCommentCount'>\nCONTENT;\n$return .= htmlspecialchars( $count, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t<div class=\"ipsFollow ipsPos_middle ipsButton ipsButton_light ipsButton_verySmall \nCONTENT;\n\nif ( $count == 0 ):\n$return .= <<<CONTENT\nipsButton_disabled\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" data-role=\"followButton\">\n\t\t\nCONTENT;\n\nif ( $count > 0 ):\n$return .= <<<CONTENT\n\n\t\t\t<a href='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=notifications&do=followers&follow_app={$app}&follow_area={$area}&follow_id={$id}\", null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'followers_tooltip', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' class='ipsType_blendLinks ipsType_noUnderline' data-ipsTooltip data-ipsDialog data-ipsDialog-size='narrow' data-ipsDialog-title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'who_follows_this', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<span>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'followers', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t<span class='ipsCommentCount'>\nCONTENT;\n$return .= htmlspecialchars( $count, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\nCONTENT;\n\nif ( $count ):\n$return .= <<<CONTENT\n\n\t\t\t<\/a>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction footer(  ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( ( \\IPS\\Settings::i()->site_online || \\IPS\\Member::loggedIn()->group['g_access_offline'] ) and ( \\IPS\\Dispatcher::i()->application instanceof \\IPS\\Application AND \\IPS\\Dispatcher::i()->application->canAccess() ) ):\n$return .= <<<CONTENT\n\n<div class=\"ipsPos_left\">\n<ul class='ipsList_inline' id=\"elFooterLinks\">\n\t\nCONTENT;\n\n$languages = \\IPS\\Lang::getEnabledLanguages();\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( count( $languages ) > 1 ):\n$return .= <<<CONTENT\n\n\t\t<li>\n\t\t\t<a href='#elNavLang_menu' id='elNavLang' data-ipsMenu data-ipsMenu-above>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'language', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n <i class='fa fa-caret-down'><\/i><\/a>\n\t\t\t<ul id='elNavLang_menu' class='ipsMenu ipsMenu_selectable ipsHide'>\n\t\t\t\nCONTENT;\n\nforeach ( $languages as $id => $lang  ):\n$return .= <<<CONTENT\n\n\t\t\t\t<li class='ipsMenu_item\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->language()->id == $id || ( $lang->default && \\IPS\\Member::loggedIn()->language === 0 ) ):\n$return .= <<<CONTENT\n ipsMenu_itemChecked\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t<form action=\"\nCONTENT;\n\n$return .= str_replace( array( 'http:\/\/', 'https:\/\/' ), '\/\/', str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=language\" . \"&csrfKey=\" . \\IPS\\Session::i()->csrfKey, null, \"language\", array(), 0 ) ) );\n$return .= <<<CONTENT\n\" method=\"post\">\n\t\t\t\t\t<button type='submit' name='id' value='\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_link'>\nCONTENT;\n\nif ( $lang->get__icon() ):\n$return .= <<<CONTENT\n<i class='\nCONTENT;\n$return .= htmlspecialchars( $lang->get__icon(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'><\/i> \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $lang->title, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( $lang->default ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'default', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n<\/button>\n\t\t\t\t\t<\/form>\n\t\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t<\/ul>\n\t\t<\/li>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\n$themes = \\IPS\\Theme::getThemesWithAccessPermission();\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( count ( $themes ) > 1  ):\n$return .= <<<CONTENT\n\n\t\t<li>\n\t\t\t<a href='#elNavTheme_menu' id='elNavTheme' data-ipsMenu data-ipsMenu-above>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'skin', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n <i class='fa fa-caret-down'><\/i><\/a>\n\t\t\t<ul id='elNavTheme_menu' class='ipsMenu ipsMenu_selectable ipsHide'>\n\t\t\t\nCONTENT;\n\nforeach ( $themes as $id => $set  ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $set->canAccess() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class='ipsMenu_item\nCONTENT;\n\nif ( \\IPS\\Theme::i()->id == $id ):\n$return .= <<<CONTENT\n ipsMenu_itemChecked\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\t<form action=\"\nCONTENT;\n\n$return .= str_replace( array( 'http:\/\/', 'https:\/\/' ), '\/\/', str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=theme\" . \"&csrfKey=\" . \\IPS\\Session::i()->csrfKey, null, \"theme\", array(), 0 ) ) );\n$return .= <<<CONTENT\n\" method=\"post\">\n\t\t\t\t\t\t<button type='submit' name='id' value='\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_link'>\nCONTENT;\n\n$val = \"{$set->_title}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( $set->is_default ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'default', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n<\/button>\n\t\t\t\t\t\t<\/form>\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t<\/ul>\n\t\t<\/li>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->privacy_type != \"none\" ):\n$return .= <<<CONTENT\n\n\t\t<li><a href='\nCONTENT;\n\nif ( \\IPS\\Settings::i()->privacy_type == \"internal\" ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=privacy\", null, \"privacy\", array(), 0 ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Settings::i()->privacy_link;\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'privacy', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( \\IPS\\core\\modules\\front\\contact\\contact::canUseContactUs() and !( \\IPS\\Dispatcher::i()->application->directory == 'core' and \\IPS\\Dispatcher::i()->module and \\IPS\\Dispatcher::i()->module->key == 'contact' ) ):\n$return .= <<<CONTENT\n\n\t\t<li><a href='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=contact&controller=contact\", null, \"contact\", array(), 0 ) );\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( \\IPS\\Settings::i()->contact_type != 'contact_redirect'  ):\n$return .= <<<CONTENT\ndata-ipsdialog data-ipsDialog-remoteSubmit data-ipsDialog-flashMessage='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'contact_sent_blurb', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsdialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'contact', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'contact', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/ul>\n<div id=\"MagnumCopyright\"><a href=\"https:\/\/invisionpower.com\/profile\/537452-taman\/\">IPS Magnum Theme<\/a><\/div>\n\nCONTENT;\n\nif ( \\IPS\\Dispatcher::i()->application instanceof \\IPS\\Application AND \\IPS\\Dispatcher::i()->application->canManageWidgets() ):\n$return .= <<<CONTENT\n\n\t<button type='button' id='elWidgetControls' data-action='openSidebar' data-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'manage_blocks', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_primary ipsButton_narrow'><i class='fa fa-chevron-right'><\/i><\/button>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<p id='elCopyright'>\n\t<span id='elCopyright_userLine'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'copyright_line_value', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span>\n\t\nCONTENT;\n\nif ( !$licenseData = \\IPS\\IPS::licenseKey() or !isset($licenseData['products']['copyright']) or !$licenseData['products']['copyright'] ):\n$return .= <<<CONTENT\n<a rel='nofollow' title='Community Software by Invision Power Services, Inc.' href='http:\/\/anonymz.com\/?https:\/\/www.invisionpower.com\/'>Community Software by Invision Power Services, Inc.<\/a>\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/p>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction genericBlock( $content, $title='', $classes=NULL ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( $title ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'front' )->pageHeader( $title );\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<div class='\nCONTENT;\n\nif ( $classes ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $classes, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t{$content}\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction globalTemplate( $title,$html,$location=array() ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n<!DOCTYPE html><html lang=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->language()->bcp47(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" dir=\"\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->language()->isrtl ):\n$return .= <<<CONTENT\nrtl\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nltr\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\"><head><title>\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Output::i()->getTitle( $title ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/title>\n<!--[if lt IE 9]>\n\t\t\t\nCONTENT;\n\nforeach ( \\IPS\\Theme::i()->css( 'extra\/ie8.css', 'core' ) as $css ):\n$return .= <<<CONTENT\n<link rel=\"stylesheet\" type=\"text\/css\" href=\"\nCONTENT;\n$return .= htmlspecialchars( $css, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t    <script src=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"applications\/core\/interface\/html5shiv\/html5shiv.js\", \"none\", \"\", array(), \\IPS\\Http\\Url::PROTOCOL_RELATIVE ) );\n$return .= <<<CONTENT\n\"><\/script>\n\t\t<![endif]-->\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'global' )->includeMeta(  );\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'global' )->includeCSS(  );\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['js_include'] != 'footer' ):\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'global' )->includeJS(  );\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'front' )->favico(  );\n$return .= <<<CONTENT\n\n\t<\/head><body class=\"ipsApp ipsApp_front \nCONTENT;\n\nif ( isset( \\IPS\\Request::i()->cookie['hasJS'] ) ):\n$return .= <<<CONTENT\nipsJS_has\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsJS_none\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n ipsClearfix\nCONTENT;\n\nforeach ( \\IPS\\Output::i()->bodyClasses as $class ):\n$return .= <<<CONTENT\n \nCONTENT;\n$return .= htmlspecialchars( $class, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\" \nCONTENT;\n\nif ( \\IPS\\Output::i()->globalControllers ):\n$return .= <<<CONTENT\ndata-controller=\"\nCONTENT;\n\n$return .= htmlspecialchars( implode( ',', \\IPS\\Output::i()->globalControllers ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( isset( \\IPS\\Output::i()->inlineMessage ) ):\n$return .= <<<CONTENT\ndata-message=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Output::i()->inlineMessage, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n data-pageapp=\"\nCONTENT;\n$return .= htmlspecialchars( $location['app'], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-pagelocation=\"front\" data-pagemodule=\"\nCONTENT;\n$return .= htmlspecialchars( $location['module'], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-pagecontroller=\"\nCONTENT;\n$return .= htmlspecialchars( $location['controller'], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" itemscope itemtype=\"http:\/\/schema.org\/WebSite\"><meta itemprop=\"url\" content=\"\nCONTENT;\n\n$return .= \\IPS\\Settings::i()->base_url;\n$return .= <<<CONTENT\n\">\n<a href=\"#elContent\" class=\"ipsHide\" title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'jump_to_content_desc', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" accesskey=\"m\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'jump_to_content', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\nCONTENT;\n\nif ( !\\IPS\\Settings::i()->site_online && \\IPS\\Member::loggedIn()->group['g_access_offline'] ):\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->offlineMessage(  );\nendif;\n$return .= <<<CONTENT\n\n\t\t<div id=\"ipsLayout_header\" class=\"ipsClearfix\">\n\t\t\t\nCONTENT;\n\nif ( !in_array('ipsLayout_minimal', \\IPS\\Output::i()->bodyClasses ) ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->mobileNavBar(  );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<header><div class=\"ipsLayout_container logobg \nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['remove_logo_mt'] == 1 ):\n$return .= <<<CONTENT\nipsResponsive_hidePhone ipsResponsive_hideTablet\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\">\n                      \nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->logo(  );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/div>\n\t\t\t\t<div class=\"magnumNav\">\n\t\t\t\t\t\nCONTENT;\n\nif ( !in_array('ipsLayout_minimal', \\IPS\\Output::i()->bodyClasses ) ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userBar(  );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->navBar(  );\n$return .= <<<CONTENT\n\t\t\t\n\t\t\t\t<\/div>\n\t\t\t<\/header>\n<\/div>\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->ta_swipersliderBase(  );\n$return .= <<<CONTENT\n\n\t\t<main role=\"main\" id=\"ipsLayout_body\" class=\"ipsLayout_container\"><div id=\"ipsLayout_contentArea\">\n\t\t\t\t<div id=\"ipsLayout_contentWrapper\">\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->breadcrumb( true, 'top' );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['enable_widget_top'] == '1' ):\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->ta_WidgetsT(  );\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['sidebar_position'] == 'left' ):\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->sidebar( 'left' );\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<div id=\"ipsLayout_mainArea\">\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"gms\" )->messageList(  );\n$return .= <<<CONTENT\n<a id=\"elContent\"><\/a>\n                      \t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->updateWarning(  );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'global' )->lkeyWarning(  );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\core\\Advertisement::loadByLocation( 'ad_global_header' );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->members_bitoptions['unacknowledged_warnings'] ):\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->acknowledgeWarning( \\IPS\\Member::loggedIn()->warnings( 1, FALSE ) );\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->widgetContainer( 'header', 'horizontal' );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t{$html}\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->widgetContainer( 'footer', 'horizontal' );\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/div>\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['sidebar_position'] == 'right' ):\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->sidebar( 'right' );\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['enable_widget_bottom'] == '1' ):\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->ta_WidgetsB(  );\nendif;\n$return .= <<<CONTENT\n\n                  \t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->breadcrumb( false, 'bottom' );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->msg_show_notification and $conversation = \\IPS\\core\\Messenger\\Conversation::latestUnreadConversation() ):\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->inlineMessage( $conversation->comments( 1, 0, 'date', 'desc' ) );\nendif;\n$return .= <<<CONTENT\n\n      \t<\/main><footer class=\"footer-wrap\">\n            \nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['footer_enabled'] == '1'  ):\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->ta_Footer(  );\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<!-- SCROLL TO TOP -->\r\n<div class=\"scroll-top-wrapper\">\r\n   <span class=\"scroll-top-inner\"><i class=\"fa fa-2x fa-arrow-circle-up\"><\/i><\/span>\r\n<\/div>\n<div id=\"ipsLayout_footer\">\n          \t\t<div class=\"ipsLayout_container ipsClearfix\">\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\core\\Advertisement::loadByLocation( 'ad_global_footer' );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->footer(  );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/div>\n        \t<\/div>\n\t\t<\/footer>\n\t\t\nCONTENT;\n\nif ( !in_array('ipsLayout_minimal', \\IPS\\Output::i()->bodyClasses ) ):\n$return .= <<<CONTENT\n\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['responsive'] ):\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->mobileNavigation(  );\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['js_include'] == 'footer' ):\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'global' )->includeJS(  );\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->ipbseo_ga_enabled ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Settings::i()->ipseo_ga;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->viglink_enabled ):\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->viglink(  );\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( isset( $_SESSION['live_meta_tags'] ) and $_SESSION['live_meta_tags'] and \\IPS\\Member::loggedIn()->isAdmin() ):\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->metaTagEditor(  );\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( !\\IPS\\Member::loggedIn()->member_id and \\IPS\\Settings::i()->guest_terms_bar ):\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->guestTermsBar( base64_encode( \\IPS\\Settings::i()->base_url ) );\nendif;\n$return .= <<<CONTENT\n\n      \t<!--ipsQueryLog-->\n\t\t<!--ipsCachingLog-->\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Output::i()->endBodyCode;\n$return .= <<<CONTENT\n\n        \nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'global' )->ta_includeJS(  );\n$return .= <<<CONTENT\n\n  \t<\/body><\/html>\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction guestCommentTeaser( $item, $login, $isReview=FALSE ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n\nCONTENT;\n\n$ref = base64_encode( $item->url() . '#replyForm' );\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( \\IPS\\Settings::i()->allow_reg ):\n$return .= <<<CONTENT\n\n\t<div class='ipsType_center ipsPad'>\n\t\t\nCONTENT;\n\nif ( $isReview ):\n$return .= <<<CONTENT\n\n\t\t\t<h2 class='ipsType_pageTitle'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'teaser_review_title_reg', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h2>\n\t\t\t<p class='ipsType_light ipsType_normal ipsType_reset'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'teaser_review_desc_reg', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t<h2 class='ipsType_pageTitle'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'teaser_title_reg', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h2>\n\t\t\t<p class='ipsType_light ipsType_normal ipsType_reset'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'teaser_desc_reg', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\n\t\t<div class='ipsGrid ipsGrid_collapsePhone ipsSpacer_top'>\n\t\t\t<div class='ipsGrid_span6 ipsAreaBackground_light ipsPad'>\n\t\t\t\t<h2 class='ipsType_sectionHead'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'teaser_account', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h2>\n\t\t\t\t<p class='ipsType_normal ipsType_reset ipsType_light'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'teaser_account_desc', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\t<br>\n\t\t\t\t<a href='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=register\", null, \"register\", array(), \\IPS\\Settings::i()->logins_over_https ) );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_primary ipsButton_small'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'teaser_account_button', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t<\/div>\n\t\t\t<div class='ipsGrid_span6 ipsAreaBackground_light ipsPad'>\n\t\t\t\t<h2 class='ipsType_sectionHead'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'teaser_signin', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h2>\n\t\t\t\t<p class='ipsType_normal ipsType_reset ipsType_light'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'teaser_signin_desc', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\t<br>\n\t\t\t\t<a href='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=login&ref={$ref}\", null, \"login\", array(), \\IPS\\Settings::i()->logins_over_https ) );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-size='medium' data-ipsDialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'teaser_signin_button', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" class='ipsButton ipsButton_primary ipsButton_small'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'teaser_signin_button', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t<\/div>\n\t\t<\/div>\n\t<\/div>\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t<div class='ipsType_center ipsPad'>\n\t\t<h2 class='ipsType_pageTitle'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'teaser_title_noreg', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h2>\n\t\t<p class='ipsType_light ipsType_normal ipsType_reset'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'teaser_desc_noreg', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t<br>\n\t\t<br>\n\t\t<a href='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=login&ref={$ref}\", null, \"login\", array(), 0 ) );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-size='medium' data-ipsDialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'teaser_signin_button', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" class='ipsButton ipsButton_alternate ipsButton_large'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'teaser_signin_button', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction guestTermsBar( $currentUrl ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\n$termsLang = \\IPS\\Member::loggedIn()->language()->addToStack( 'terms_of_use' );\n$return .= <<<CONTENT\n\n\nCONTENT;\n\n$privacyLang = \\IPS\\Member::loggedIn()->language()->addToStack( 'terms_privacy' );\n$return .= <<<CONTENT\n\n\nCONTENT;\n\n$glLang = \\IPS\\Member::loggedIn()->language()->addToStack( 'guidelines' );\n$return .= <<<CONTENT\n\n\nCONTENT;\n\n$termsUrl = (string) \\IPS\\Http\\Url::internal( 'app=core&module=system&controller=terms', 'front', 'terms' );\n$return .= <<<CONTENT\n\n\nCONTENT;\n\n$terms = \"<a href='$termsUrl'>$termsLang<\/a>\";\n$return .= <<<CONTENT\n\n\n\nCONTENT;\n\nif ( \\IPS\\Settings::i()->privacy_type == 'internal' ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\n$privacyUrl = (string) \\IPS\\Http\\Url::internal( 'app=core&module=system&controller=privacy', 'front', 'privacy' );\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\n$privacyUrl = \\IPS\\Settings::i()->privacy_link;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\n$privacy = \"<a href='$privacyUrl'>$privacyLang<\/a>\";\n$return .= <<<CONTENT\n\n\n\nCONTENT;\n\nif ( \\IPS\\Settings::i()->gl_type == 'internal' ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\n$glUrl = (string) \\IPS\\Http\\Url::internal( 'app=core&module=system&controller=guidelines', 'front', 'guidelines' );\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\n$glUrl = \\IPS\\Settings::i()->gl_link;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\n$guidelines = \"<a href='$glUrl'>$glLang<\/a>\";\n$return .= <<<CONTENT\n\n\n<div id='elGuestTerms' class='ipsPad_half ipsJS_hide' data-role='guestTermsBar' data-controller='core.front.core.guestTerms'>\n\t<div class='ipsLayout_container'>\n\t\t<div class='ipsGrid ipsGrid_collapsePhone'>\n\t\t\t<div class='ipsGrid_span10'>\n\t\t\t\t<h2 class='ipsType_sectionHead'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'guest_terms_title', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h2>\n\t\t\t\t<p class='ipsType_reset ipsType_medium cGuestTerms_contents'>\nCONTENT;\n\n$htmlsprintf = array($terms, $privacy, $guidelines); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'guest_terms_bar_text_value', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'htmlsprintf' => $htmlsprintf ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t<\/div>\n\t\t\t<div class='ipsGrid_span2'>\n\t\t\t\t<a href='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=terms&do=dismiss&ref={$currentUrl}\", null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_veryLight ipsButton_large ipsButton_fullWidth' data-action='dismissTerms'><i class='fa fa-check'><\/i>&nbsp; \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'guest_terms_close', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t<\/div>\n\t\t<\/div>\n\t<\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction inlineMessage( $message ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div id='elInlineMessage' class='ipsPad' title='\nCONTENT;\n\n$sprintf = array($message->author()->name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'messenger_inline_title', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n'>\n\t<div class='ipsPhotoPanel ipsPhotoPanel_medium'>\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( $message->author(), 'medium' );\n$return .= <<<CONTENT\n\n\t\t<div class='ipsType_normal'>\n\t\t\t<strong>\nCONTENT;\n$return .= htmlspecialchars( $message->item()->title, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/strong><br>\n\t\t\t<span class='ipsType_light'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'messenger_inline_date', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n \nCONTENT;\n\n$val = ( $message->date instanceof \\IPS\\DateTime ) ? $message->date : \\IPS\\DateTime::ts( $message->date );$return .= $val->html();\n$return .= <<<CONTENT\n<\/span>\n\t\t\t<br>\n\t\t\t<div data-ipsTruncate data-ipsTruncate-type=\"remove\" data-ipsTruncate-size=\"3 lines\">\n\t\t\t\t{$message->post}\n\t\t\t<\/div>\n\t\t\t<hr class='ipsHr'>\n\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $message->url(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_primary ipsButton_small'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'messenger_inline_button', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->msg_count_new > 1 ):\n$return .= <<<CONTENT\n <a href='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=messaging&controller=messenger\", null, \"messaging\", array(), 0 ) );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_primary ipsButton_small'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'messenger_inline_view_all', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\nif ( $message->canReport() ):\n$return .= <<<CONTENT\n &nbsp;&nbsp; <a href='\nCONTENT;\n$return .= htmlspecialchars( $message->url('report'), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'><span class='ipsResponsive_showPhone ipsResponsive_inline'><i class='fa fa-flag'><\/i><\/span><span class='ipsResponsive_hidePhone ipsResponsive_inline'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'report_post', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span><\/a>\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t<\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction itemIcon( $iconInfo ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n<span class='ipsItemStatus \nCONTENT;\n\nif ( $iconInfo['size'] ):\n$return .= <<<CONTENT\nipsItemStatus_\nCONTENT;\n$return .= htmlspecialchars( $iconInfo['size'], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'><i class='\nCONTENT;\n\nif ( $iconInfo['type'] == 'unread' ):\n$return .= <<<CONTENT\nfa fa-circle\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'><\/i><\/span>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction loginPopup( $login ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div id='elUserSignIn_menu' class='ipsMenu ipsMenu_auto ipsHide'>\n\t<div data-role=\"loginForm\">\n\t\t\nCONTENT;\n\nif ( count ( $login->forms( FALSE, TRUE ) ) > 1 ):\n$return .= <<<CONTENT\n\n\t\t\t<div class='ipsColumns ipsColumns_noSpacing'>\n\t\t\t\t<div class='ipsColumn ipsColumn_wide' id='elUserSignIn_internal'>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nforeach ( $login->forms( FALSE, TRUE ) as $k => $form ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( $k === '_standard' ):\n$return .= <<<CONTENT\n\n\t\t\t\t{$form->customTemplate( array( \\IPS\\Theme::i()->getTemplate( 'global', 'core', 'front' ), 'loginPopupForm' ) )}\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( count ( $login->forms( FALSE, TRUE ) ) > 1 ):\n$return .= <<<CONTENT\n\n\t\t\t\t<\/div>\n\t\t\t\t<div class='ipsColumn ipsColumn_wide'>\n\t\t\t\t\t<div class='ipsPad' id='elUserSignIn_external'>\n\t\t\t\t\t\t<div class='ipsAreaBackground_light ipsPad_half'>\n\t\t\t\t\t\t\t<p class='ipsType_reset ipsType_small ipsType_center'><strong>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sign_in_with_these', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong><\/p>\n\t\t\t\t\t\t\t<br>\n\t\t\t\t\t\t\t\nCONTENT;\n\nforeach ( $login->forms( FALSE, TRUE ) as $k => $form ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $k !== '_standard' ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<div class='ipsPad_half ipsType_center'>\n\t\t\t\t\t\t\t\t\t\t{$form}\n\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/div>\n\t\t\t\t\t<\/div>\n\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction loginPopupForm( $id, $action, $elements, $hiddenValues, $actionButtons, $uploadField, $class='', $attributes=array(), $sidebar, $form=NULL ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<form accept-charset='utf-8' class=\"ipsPad ipsForm ipsForm_vertical\" method='post' action='\nCONTENT;\n$return .= htmlspecialchars( $action, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsValidation novalidate>\n\t<input type=\"hidden\" name=\"\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_submitted\" value=\"1\">\n\t\nCONTENT;\n\nforeach ( $hiddenValues as $k => $v ):\n$return .= <<<CONTENT\n\n\t\t<input type=\"hidden\" name=\"\nCONTENT;\n$return .= htmlspecialchars( $k, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" value=\"\nCONTENT;\n$return .= htmlspecialchars( $v, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t<h4 class=\"ipsType_sectionHead\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'login', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h4>\n\t<br><br>\n\t<ul class='ipsList_reset'>\n\t\t\nCONTENT;\n\nforeach ( $elements as $collection ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nforeach ( $collection as $input ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $input instanceof \\IPS\\Helpers\\Form\\Text ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class=\"ipsFieldRow ipsFieldRow_noLabel ipsFieldRow_fullWidth\">\n\t\t\t\t\t\t<input type=\"\nCONTENT;\n$return .= htmlspecialchars( $input->formType, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" required placeholder=\"\nCONTENT;\n\n$val = \"{$input->name}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" name='\nCONTENT;\n$return .= htmlspecialchars( $input->name, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' id='\nCONTENT;\n$return .= htmlspecialchars( $input->htmlId, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t{$input->rowHtml($form)}\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t<li class=\"ipsFieldRow ipsFieldRow_fullWidth\">\n\t\t\t<br>\n\t\t\t<button type=\"submit\" class=\"ipsButton ipsButton_primary ipsButton_small\" id=\"elSignIn_submit\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'login', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/button>\n\t\t\t<br>\n\t\t\t<p class=\"ipsType_right ipsType_small\">\n\t\t\t\t<a href='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=lostpass\", null, \"lostpassword\", array(), 0 ) );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'forgotten_password', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'forgotten_password', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t<\/p>\n\t\t<\/li>\n\t<\/ul>\n<\/form>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction logo(   ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( \\IPS\\Theme::i()->logo['front']['url'] !== null  ):\n$return .= <<<CONTENT\n\n\nCONTENT;\n\n$logo = \\IPS\\File::get( 'core_Theme', \\IPS\\Theme::i()->logo['front']['url'] )->url;\n$return .= <<<CONTENT\n\n<a href='\nCONTENT;\n\n$return .= \\IPS\\Settings::i()->base_url;\n$return .= <<<CONTENT\n' id='elLogo' accesskey='1'><img src=\"\nCONTENT;\n$return .= htmlspecialchars( $logo, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" alt='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Settings::i()->board_name, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n'><\/a>\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n<a href='\nCONTENT;\n\n$return .= \\IPS\\Settings::i()->base_url;\n$return .= <<<CONTENT\n' id='elSiteTitle' accesskey='1'>\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['site_title'] ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['site_title'];\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Settings::i()->board_name;\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n<\/a>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction metaTagEditor(  ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n<div id='elMetaTagEditor' class='ipsToolbox ipsPad ipsScrollbar' data-controller=\"core.front.system.metaTagEditor\">\n\t<h3 class='ipsToolbox_title ipsType_reset'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'live_meta_tag_editor', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h3>\n\t<form accept-charset='utf-8' method='post' action=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=metatags&do=save\", null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n\" data-ipsForm>\n\t\t<input type='hidden' name='meta_url' value='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Output::i()->metaTagsUrl, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t\t<input type=\"hidden\" name=\"csrfKey\" value=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Session::i()->csrfKey, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\n\t\t<h4 class='ipsToolbox_sectionTitle'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'metatags_page_title', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h4>\n\t\t<input name='meta_tag_title' type='text' value=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Output::i()->metaTagsTitle, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\t<br><br>\n\n\t\t<h4 class='ipsToolbox_sectionTitle'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'meta_tags_blurb', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h4>\n\n\t\t<ul class='ipsList_reset' id='elMetaTagEditor_tags'>\n\t\t\t\nCONTENT;\n\nforeach ( \\IPS\\Output::i()->metaTags as $name => $content ):\n$return .= <<<CONTENT\n\n\t\t\t\t<li>\n\t\t\t\t\t<ul class='ipsForm ipsForm_vertical'>\n\t\t\t\t\t\t<li class='ipsFieldRow ipsFieldRow_fullWidth'>\n\t\t\t\t\t\t\t<select name='meta_tag_name[]'>\n\t\t\t\t\t\t\t\t<option value='keywords' \nCONTENT;\n\nif ( $name == 'keywords' ):\n$return .= <<<CONTENT\nselected\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'meta_keywords', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/option>\n\t\t\t\t\t\t\t\t<option value='description' \nCONTENT;\n\nif ( $name == 'description' ):\n$return .= <<<CONTENT\nselected\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'meta_description', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/option>\n\t\t\t\t\t\t\t\t<option value='robots' \nCONTENT;\n\nif ( $name == 'robots' ):\n$return .= <<<CONTENT\nselected\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'meta_robots', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/option>\n\t\t\t\t\t\t\t\t<option value='other' \nCONTENT;\n\nif ( !in_array( $name, array( 'keywords', 'description', 'robots' ) ) ):\n$return .= <<<CONTENT\nselected\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'meta_other', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/option>\n\t\t\t\t\t\t\t<\/select>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t<li class='ipsFieldRow ipsFieldRow_fullWidth'>\n\t\t\t\t\t\t\t<input name='meta_tag_name_other[]' type='text' value=\"\nCONTENT;\n\nif ( !in_array( $name, array( 'keywords', 'description', 'robots' ) ) ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $name, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" placeholder='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'metatags_name', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t<li class='ipsFieldRow ipsFieldRow_fullWidth'>\n\t\t\t\t\t\t\t<input name='meta_tag_content[]' type='text' value=\"\nCONTENT;\n$return .= htmlspecialchars( $content, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" placeholder='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'metatags_content', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t<\/ul>\n\t\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t<li class='ipsHide' data-role='metaTemplate'>\n\t\t\t\t<ul class='ipsForm ipsForm_vertical'>\n\t\t\t\t\t<li class='ipsFieldRow ipsFieldRow_fullWidth'>\n\t\t\t\t\t\t<select name='meta_tag_name[]' class='ipsField_fullWidth'>\n\t\t\t\t\t\t\t<option value='keywords'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'meta_keywords', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/option>\n\t\t\t\t\t\t\t<option value='description'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'meta_description', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/option>\n\t\t\t\t\t\t\t<option value='robots'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'meta_robots', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/option>\n\t\t\t\t\t\t\t<option value='other'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'meta_other', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/option>\n\t\t\t\t\t\t<\/select>\n\t\t\t\t\t<\/li>\n\t\t\t\t\t<li class='ipsFieldRow ipsFieldRow_fullWidth'>\n\t\t\t\t\t\t<input name='meta_tag_name_other[]' type='text' value=\"\" placeholder='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'metatags_name', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t<\/li>\n\t\t\t\t\t<li class='ipsFieldRow ipsFieldRow_fullWidth'>\n\t\t\t\t\t\t<input name='meta_tag_content[]' type='text' value=\"\" placeholder='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'metatags_content', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t<\/li>\n\t\t\t\t<\/ul>\n\t\t\t<\/li>\n\t\t<\/ul>\n\t\t<br>\n\t\t<a href='#' class='ipsJS_show ipsButton ipsButton_normal ipsButton_fullWidth ipsButton_verySmall' data-action='addMeta'><i class='fa fa-plus'><\/i> &nbsp;\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'add_another_meta_tag', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\n\t\t<div class=\"ipsClearfix ipsPad ipsType_center\" id='elMetaTagEditor_submit'>\n\t\t\t<button class='ipsButton ipsButton_important' role='button' type='submit'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'save', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/button>\n\t\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=metatags&do=end\", null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n\" class='ipsButton ipsButton_primary'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'end_metatags', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t<\/div>\n\t<\/form>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction mobileNavBar(   ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<ul id='elMobileNav' class='ipsList_inline ipsResponsive_hideDesktop ipsResponsive_block' data-controller='core.front.core.mobileNav' data-default=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Output::i()->defaultSearchOption[0], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\nCONTENT;\n\nif ( count( \\IPS\\Output::i()->breadcrumb ) ):\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( count( \\IPS\\Output::i()->breadcrumb ) == 1 ):\n$return .= <<<CONTENT\n\n\t\t\t<li id='elMobileBreadcrumb'>\n\t\t\t\t<a href='\nCONTENT;\n\n$return .= \\IPS\\Settings::i()->base_url;\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t<span>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'home', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t<\/a>\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\n$i = 0;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nforeach ( \\IPS\\Output::i()->breadcrumb as $k => $b ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $i + 2 == count( \\IPS\\Output::i()->breadcrumb ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li id='elMobileBreadcrumb'>\n\t\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $b[0], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\t\t<span>\nCONTENT;\n$return .= htmlspecialchars( $b[1], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\t<\/a>\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\n$i++;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\n\t\nCONTENT;\n\n$defaultStream = \\IPS\\core\\Stream::defaultStream();\n$return .= <<<CONTENT\n\n\t<li \nCONTENT;\n\nif ( !\\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'discover' ) )  ):\n$return .= <<<CONTENT\nclass='ipsHide'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t<a data-action=\"defaultStream\" class='ipsType_light'  href='\nCONTENT;\n\nif ( $defaultStream ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $defaultStream->url(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=discover&controller=streams\", null, \"discover_all\", array(), 0 ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'><i class='icon-newspaper'><\/i><\/a>\n\t<\/li>\n\n\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'search' ) ) ):\n$return .= <<<CONTENT\n\n\t\t<li class='ipsJS_show'>\n\t\t\t<a href='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=search&controller=search\", null, \"search\", array(), 0 ) );\n$return .= <<<CONTENT\n' data-action=\"mobileSearch\"><i class='fa fa-search'><\/i><\/a>\n\t\t<\/li>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<li data-ipsDrawer data-ipsDrawer-drawerElem='#elMobileDrawer'>\n\t\t<a href='#'>\n\t\t\t\nCONTENT;\n\n$total = \\IPS\\Member::loggedIn()->notification_cnt;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( !\\IPS\\Member::loggedIn()->members_disable_pm and \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'messaging' ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\n$total += \\IPS\\Member::loggedIn()->msg_count_new;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'modcp' ) ) and \\IPS\\Member::loggedIn()->modPermission('can_view_reports') ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\n$total += \\IPS\\Member::loggedIn()->reportCount();\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( $total ):\n$return .= <<<CONTENT\n\n\t\t\t\t<span class='ipsNotificationCount' data-notificationType='total'>\nCONTENT;\n$return .= htmlspecialchars( $total, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<i class='fa fa-navicon'><\/i>\n\t\t<\/a>\n\t<\/li>\n<\/ul>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction mobileNavigation(   ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div id='elMobileDrawer' class='ipsDrawer ipsHide'>\n\t<a href='#' class='ipsDrawer_close' data-action='close'><span>&times;<\/span><\/a>\n\t<div class='ipsDrawer_menu'>\n\t\t<div class='ipsDrawer_content'>\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->member_id ):\n$return .= <<<CONTENT\n\n\t\t\t\t<ul id='elUserNav_mobile' class='ipsList_inline signed_in ipsClearfix'>\n\t\t\t\t\t<li class='cNotifications cUserNav_icon'>\n\t\t\t\t\t\t<a href='#elMobNotifications_menu' id='elMobNotifications' data-ipsMenu data-ipsMenu-menuID='elFullNotifications_menu' data-ipsMenu-closeOnClick='false'>\n\t\t\t\t\t\t\t<i class='fa fa-bell'><\/i> <span class='ipsNotificationCount \nCONTENT;\n\nif ( !\\IPS\\Member::loggedIn()->notification_cnt ):\n$return .= <<<CONTENT\nipsHide\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' data-notificationType='notify'>\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->notification_cnt, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\t<\/a>\n\t\t\t\t\t<\/li>\n\t\t\t\t\t\nCONTENT;\n\nif ( !\\IPS\\Member::loggedIn()->members_disable_pm and \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'messaging' ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li class='cInbox cUserNav_icon'>\n\t\t\t\t\t\t\t<a href='#elMobInbox_menu' id='elMobInbox' data-ipsMenu data-ipsMenu-menuID='elFullInbox_menu' data-ipsMenu-closeOnClick='false'>\n\t\t\t\t\t\t\t\t<i class='fa fa-envelope'><\/i> <span class='ipsNotificationCount \nCONTENT;\n\nif ( !\\IPS\\Member::loggedIn()->msg_count_new ):\n$return .= <<<CONTENT\nipsHide\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' data-notificationType='inbox'>\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->msg_count_new, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'modcp' ) ) and \\IPS\\Member::loggedIn()->modPermission('can_view_reports') ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li class='cReports cUserNav_icon'>\n\t\t\t\t\t\t\t<a href='#elMobReports_menu' id='elMobReports' data-ipsMenu data-ipsMenu-menuID='elFullReports_menu' data-ipsMenu-closeOnClick='false'>\n\t\t\t\t\t\t\t\t<i class='fa fa-warning'><\/i> \nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->reportCount() ):\n$return .= <<<CONTENT\n<span class='ipsNotificationCount' data-notificationType='reports'>\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->reportCount(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/ul>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t\t\t<div class='ipsSpacer_bottom ipsPad'>\n\t\t\t\t<ul class='ipsToolList ipsToolList_vertical'>\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->member_id ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<a href='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=login&do=logout\" . \"&csrfKey=\" . \\IPS\\Session::i()->csrfKey, null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_light ipsButton_small ipsButton_fullWidth'>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( isset( $_SESSION['logged_in_as_key'] ) ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$sprintf = array($_SESSION['logged_in_from']['name']); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'switch_to_account', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sign_out', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<a href='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=login\", null, \"login\", array(), \\IPS\\Settings::i()->logins_over_https ) );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_light ipsButton_small ipsButton_fullWidth'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sign_in', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->allow_reg ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<a href='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=register\", null, \"register\", array(), \\IPS\\Settings::i()->logins_over_https ) );\n$return .= <<<CONTENT\n' id='elRegisterButton_mobile' class='ipsButton ipsButton_small ipsButton_fullWidth ipsButton_important'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sign_up', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->member_id ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<a class='ipsButton ipsButton_small ipsButton_primary ipsButton_fullWidth' data-action=\"markSiteRead\" data-controller=\"core.front.core.markRead\" href='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=markread\" . \"&csrfKey=\" . \\IPS\\Session::i()->csrfKey, null, \"mark_site_as_read\", array(), 0 ) );\n$return .= <<<CONTENT\n'><i class='fa fa-check'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mark_site_read_button', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/ul>\n\t\t\t<\/div>\n\n\t\t\t<ul class='ipsDrawer_list'>\n\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->member_id ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class='ipsDrawer_itemParent'>\n\t\t\t\t\t\t<h4 class='ipsDrawer_title'><a href='#'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mobile_menu_account', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/h4>\n\t\t\t\t\t\t<ul class='ipsDrawer_list'>\n\t\t\t\t\t\t\t<li data-action=\"back\"><a href='#'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mobile_menu_back', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'members', 'front' ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<li><a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->url(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'view_my_profile', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'menu_profile', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->group['g_attach_max'] != 0 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<li><a href='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=attachments\", null, \"attachments\", array(), 0 ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'my_attachments', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li><a href='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=followed\", null, \"followed_content\", array(), 0 ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'menu_followed_content', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t<li id='elAccountSettingsLinkMobile'><a href='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=settings\", null, \"settings\", array(), 0 ) );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit_account_settings', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'menu_settings', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t                <li><a href='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=ignore\", null, \"ignore\", array(), 0 ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'menu_manage_ignore', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( ( \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'modcp' ) ) AND \\IPS\\Member::loggedIn()->modPermission() ) or ( \\IPS\\Member::loggedIn()->isAdmin() AND !\\IPS\\Settings::i()->security_remove_acp_link ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'modcp' ) ) AND \\IPS\\Member::loggedIn()->modPermission() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<li><a href='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=modcp\", null, \"modcp\", array(), 0 ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'menu_modcp', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->isAdmin() AND !\\IPS\\Settings::i()->security_remove_acp_link  ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<li><a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::baseURL( ( \\IPS\\Settings::i()->logins_over_https ) ? \\IPS\\Http\\Url::PROTOCOL_HTTPS : \\IPS\\Http\\Url::PROTOCOL_RELATIVE ) . \\IPS\\CP_DIRECTORY, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' target='_blank'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'menu_admincp', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n <i class='fa fa-lock'><\/i><\/a><\/li>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/ul>\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t\t\t\t\nCONTENT;\n\n$primaryBars = \\IPS\\core\\FrontNavigation::i()->roots();\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\n$subBars = \\IPS\\core\\FrontNavigation::i()->subBars();\n$return .= <<<CONTENT\n\n\t\t\t\t\n\t\t\t\t\nCONTENT;\n\nforeach ( $primaryBars as $id => $item ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $item->canView() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\n$children = $item->children();\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( ( $subBars && isset( $subBars[ $id ] ) && count( $subBars[ $id ] ) ) || $children ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li class='ipsDrawer_itemParent'>\n\t\t\t\t\t\t\t\t<h4 class='ipsDrawer_title'><a href='#'>\nCONTENT;\n$return .= htmlspecialchars( $item->title(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a><\/h4>\n\t\t\t\t\t\t\t\t<ul class='ipsDrawer_list'>\n\t\t\t\t\t\t\t\t\t<li data-action=\"back\"><a href='#'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mobile_menu_back', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $item->link() && $item->link() !== '#' ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t<li><a href='\nCONTENT;\n$return .= htmlspecialchars( $item->link(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n$return .= htmlspecialchars( $item->title(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $children ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->mobileNavigationChildren( $children );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $subBars && isset( $subBars[ $id ] ) && count( $subBars[ $id ] ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->mobileNavigationChildren( $subBars[ $id ] );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\t\n\t\t\t\t\t\t\t\t<\/ul>\n\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li><a href='\nCONTENT;\n$return .= htmlspecialchars( $item->link(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( method_exists( $item, 'target' ) AND $item->target() ):\n$return .= <<<CONTENT\ntarget='\nCONTENT;\n$return .= htmlspecialchars( $item->target(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\nCONTENT;\n$return .= htmlspecialchars( $item->title(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t<\/ul>\n\t\t<\/div>\n\t<\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction mobileNavigationChildren( $items ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n\nCONTENT;\n\nforeach ( $items as $child ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( $child->canView() ):\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( $children = $child->children() ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\n$id = md5( uniqid() . mt_rand() );\n$return .= <<<CONTENT\n\n\t\t\t<li class='ipsDrawer_itemParent'>\n\t\t\t\t<h4 class='ipsDrawer_title'><a href='#'>\nCONTENT;\n$return .= htmlspecialchars( $child->title(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a><\/h4>\n\t\t\t\t<ul class='ipsDrawer_list'>\n\t\t\t\t\t<li data-action=\"back\"><a href='#'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mobile_menu_back', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\nCONTENT;\n\nif ( $child->link() && $child->link() !== '#' ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $child->link(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $child->title(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->mobileNavigationChildren( $children );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/ul>\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nelseif ( $child instanceof \\IPS\\core\\extensions\\core\\FrontNavigation\\MenuHeader ):\n$return .= <<<CONTENT\n\n\t\t\t<li class='ipsDrawer_section'>\n\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $child->title(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nelseif ( $child instanceof \\IPS\\core\\extensions\\core\\FrontNavigation\\MenuSeparator ):\n$return .= <<<CONTENT\n\n\t\t\t\n\t\t\nCONTENT;\n\nelseif ( $child instanceof \\IPS\\core\\extensions\\core\\FrontNavigation\\MenuButton ):\n$return .= <<<CONTENT\n\n\t\t\t<li class='ipsPad_half'>\n\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $child->link(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_important ipsButton_verySmall ipsButton_fullWidth'>\n\t\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $child->title(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/a>\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t<li>\n\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $child->link(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( method_exists( $child, 'target' ) AND $child->target() ):\n$return .= <<<CONTENT\ntarget='\nCONTENT;\n$return .= htmlspecialchars( $child->target(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $child->title(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/a>\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction modBadges( $member ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction navBar( $preview=FALSE ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( !in_array('ipsLayout_minimal', \\IPS\\Output::i()->bodyClasses ) ):\n$return .= <<<CONTENT\n\n\t<nav \nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['appneeded'] ):\n$return .= <<<CONTENT\n class='ipsLayout_container' data-controller='core.front.core.navBar'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t<div class='ipsNavBar_primary \nCONTENT;\n\nif ( !count( \\IPS\\core\\FrontNavigation::i()->subBars( $preview ) ) ):\n$return .= <<<CONTENT\nipsNavBar_noSubBars\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n ipsClearfix'>\n\t\t\t\nCONTENT;\n\nif ( !$preview and \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'search' ) ) AND !in_array('ipsLayout_minimal', \\IPS\\Output::i()->bodyClasses ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t<div id='elSearch' class='ipsPos_right' data-controller='core.front.core.quickSearch' itemprop=\"potentialAction\" itemscope itemtype=\"http:\/\/schema.org\/SearchAction\" data-default=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Output::i()->defaultSearchOption[0], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\t\t\t\t<form accept-charset='utf-8' action='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=search&controller=search\", null, \"search\", array(), 0 ) );\n$return .= <<<CONTENT\n' method='post'>\n\t\t\t\t\t\t<meta itemprop=\"target\" content=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=search&controller=search&q=\", null, \"search\", array(), 0 ) );\n$return .= <<<CONTENT\n{q}\">\n\t\t\t\t\t\t<a href='#' id='elSearchFilter' data-ipsMenu data-ipsMenu-selectable='radio' data-ipsMenu-appendTo='#elSearch' class=\"ipsHide\">\n\t\t\t\t\t\t\t<span data-role='searchingIn'>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( count( \\IPS\\Output::i()->contextualSearchOptions ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nforeach ( \\IPS\\Output::i()->contextualSearchOptions as $name => $data ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $name, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\n$defaultSearchType = $data['type'];\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( isset( $data['nodes'] ) AND $data['nodes'] ):\n$return .= <<<CONTENT\n<input name=\"nodes\" value=\"\nCONTENT;\n$return .= htmlspecialchars( $data['nodes'], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-role=\"searchFilter\" type=\"hidden\">\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( isset( $data['item'] ) AND $data['item'] ):\n$return .= <<<CONTENT\n<input name=\"item\" value=\"\nCONTENT;\n$return .= htmlspecialchars( $data['item'], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-role=\"searchFilter\" type=\"hidden\">\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nbreak;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\n$defaultSearchType = \\IPS\\Output::i()->defaultSearchOption[0];\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->language()->addToStack( \\IPS\\Output::i()->defaultSearchOption[1] ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<\/span>\n\t\t\t\t\t\t\t<i class='fa fa-caret-down'><\/i>\n\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t<input type=\"hidden\" name=\"type\" value=\"\nCONTENT;\n$return .= htmlspecialchars( $defaultSearchType, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-role=\"searchFilter\">\n\t\t\t\t\t\t<ul id='elSearchFilter_menu' class='ipsMenu ipsMenu_selectable ipsMenu_narrow ipsHide'>\n\t\t\t\t\t\t\t<li class='ipsMenu_item \nCONTENT;\n\nif ( \\IPS\\Output::i()->defaultSearchOption[0] == 'all' AND !count(\\IPS\\Output::i()->contextualSearchOptions) ):\n$return .= <<<CONTENT\nipsMenu_itemChecked\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' data-ipsMenuValue='all'>\n\t\t\t\t\t\t\t\t<a href='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=search&controller=search\" . \"&csrfKey=\" . \\IPS\\Session::i()->csrfKey, null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'search_everything', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'search_everything', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\t<li class='ipsMenu_sep'><hr><\/li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( count( \\IPS\\Output::i()->contextualSearchOptions ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\n$setDefault = FALSE;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nforeach ( \\IPS\\Output::i()->contextualSearchOptions as $name => $data ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<li class='ipsMenu_item \nCONTENT;\n\nif ( $setDefault === FALSE ):\n$return .= <<<CONTENT\nipsMenu_itemChecked\nCONTENT;\n\n$setDefault = TRUE;\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' data-ipsMenuValue='\nCONTENT;\n\n$return .= htmlspecialchars( json_encode( $data ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-options='\nCONTENT;\n\n$return .= htmlspecialchars( json_encode( $data ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\t\t\t\t\t<a href='#'>\nCONTENT;\n$return .= htmlspecialchars( $name, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<li class='ipsMenu_sep'><hr><\/li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li data-role='globalSearchMenuOptions'><\/li>\n\t\t\t\t\t\t\t<li class='ipsMenu_item ipsMenu_itemNonSelect'>\n\t\t\t\t\t\t\t\t<a href='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=search&controller=search\", null, \"search\", array(), 0 ) );\n$return .= <<<CONTENT\n' accesskey='4'><i class='fa fa-cog'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'advanced_search', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t<\/ul>\n\t\t\t\t\t\t<input type='search' id='elSearchField' placeholder='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'search_placeholder', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' name='q' itemprop=\"query-input\">\n                      \t<button type='submit'>\n\t\t\t\t\t\t\t<svg viewBox=\"0 0 32 32\" class=\"icon nav-magnifier-icon\">\n\t\t\t\t\t\t\t\t<path d=\"M12.98,0C5.81,0,0,5.81,0,12.98c0,7.17,5.81,12.98,12.98,12.98c7.17,0,12.98-5.81,12.98-12.98C25.97,5.81,20.15,0,12.98,0z M12.98,23.06c-5.56,0-10.07-4.51-10.07-10.07c0-5.56,4.51-10.07,10.07-10.07c5.56,0,10.07,4.51,10.07,10.07 C23.06,18.55,18.55,23.06,12.98,23.06z\"><\/path>\n\t\t\t\t\t\t\t\t<path d=\"M18.08,18.49c0,1.27-2.22,2.3-4.96,2.3s-4.96-1.03-4.96-2.3c0-1.27,2.22-1.64,4.96-1.64S18.08,17.21,18.08,18.49z\"><\/path>\n\t\t\t\t\t\t\t\t<path d=\"M31.25,31.25L31.25,31.25c-1,1-2.64,1-3.65,0l-7.87-7.87c-1-1,0-1.64,1-2.65l0,0c1-1,1.64-2,2.65-1l7.87,7.87 C32.25,28.6,32.25,30.25,31.25,31.25z\"><\/path>\n\t\t\t\t\t\t\t<\/svg>\n                      \t<\/button>\n\t\t\t\t\t<\/form>\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<ul data-role=\"primaryNavBar\" class='menu flex \nCONTENT;\n\nif ( !$preview ):\n$return .= <<<CONTENT\nipsResponsive_showDesktop ipsResponsive_block\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'front' )->navBarItems( \\IPS\\core\\FrontNavigation::i()->roots( $preview ), \\IPS\\core\\FrontNavigation::i()->subBars( $preview ), 0, $preview );\n$return .= <<<CONTENT\n\n              \t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['appneeded'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class='ipsHide' id='elNavigationMore' data-role='navMore'>\n\t\t\t\t\t\t<a href='#' data-ipsMenu data-ipsMenu-appendTo='#elNavigationMore' id='elNavigationMore_dropdown'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'more', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t<ul class='ipsNavBar_secondary ipsHide' data-role='secondaryNavBar'>\n\t\t\t\t\t\t\t<li class='ipsHide' id='elNavigationMore_more' data-role='navMore'>\n\t\t\t\t\t\t\t\t<a href='#' data-ipsMenu data-ipsMenu-appendTo='#elNavigationMore_more' id='elNavigationMore_more_dropdown'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'more', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n <i class='fa fa-caret-down'><\/i><\/a>\n\t\t\t\t\t\t\t\t<ul class='ipsHide ipsMenu ipsMenu_auto' id='elNavigationMore_more_dropdown_menu' data-role='moreDropdown'><\/ul>\n\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t<\/ul>\n\t\t\t\t\t<\/li>\n              \t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/ul>\n\t\t<\/div>\n\t<\/nav>\n\nCONTENT;\n\nelseif ( \\IPS\\Member::loggedIn()->group['g_view_board'] ):\n$return .= <<<CONTENT\n\n\t<nav \nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['appneeded'] ):\n$return .= <<<CONTENT\nclass='ipsLayout_container'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t<div class='ipsNavBar_primary ipsNavBar_noSubBars ipsClearfix'>\n\t\t\t<a id='elBackHome' href='\nCONTENT;\n\n$return .= \\IPS\\Settings::i()->base_url;\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'go_community_home', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'><i class='fa fa-angle-left'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'community_home', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t<\/div>\n\t<\/nav>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction navBarChildren( $items, $preview=FALSE ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nforeach ( $items as $item ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( $preview or $item->canView() ):\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( $children = $item->children() ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\n$id = md5( uniqid() . mt_rand() );\n$return .= <<<CONTENT\n\n\t\t\t<li id='elNavigation_\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsMenu_item ipsMenu_subItems'>\n\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $item->link(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $item->title(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/a>\n\t\t\t\t<ul id='elNavigation_\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu' class='ipsMenu ipsMenu_auto ipsHide'>\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->navBarChildren( $children, $preview );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/ul>\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nelseif ( $item instanceof \\IPS\\core\\extensions\\core\\FrontNavigation\\MenuHeader ):\n$return .= <<<CONTENT\n\n\t\t\t<li class='ipsMenu_title'>\n\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $item->title(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nelseif ( $item instanceof \\IPS\\core\\extensions\\core\\FrontNavigation\\MenuSeparator ):\n$return .= <<<CONTENT\n\n\t\t\t<li class='ipsMenu_sep'>\n\t\t\t\t<hr>\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nelseif ( $item instanceof \\IPS\\core\\extensions\\core\\FrontNavigation\\MenuButton ):\n$return .= <<<CONTENT\n\n\t\t\t<li class='ipsPad_half'>\n\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $item->link(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_primary ipsButton_verySmall ipsButton_fullWidth'>\n\t\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $item->title(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/a>\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t<li class='ipsMenu_item' {$item->attributes()}>\n\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $item->link(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( method_exists( $item, 'target' ) AND $item->target() ):\n$return .= <<<CONTENT\ntarget='\nCONTENT;\n$return .= htmlspecialchars( $item->target(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $item->title(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/a>\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction navBarItems( $roots, $subBars=NULL, $parent=0, $preview=FALSE ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nforeach ( $roots as $id => $item ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( $preview or $item->canView() ):\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\n$active = $item->activeOrChildActive();\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( $active ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\n\\IPS\\core\\FrontNavigation::i()->activePrimaryNavBar = $item->id;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<li \nCONTENT;\n\nif ( $active ):\n$return .= <<<CONTENT\nclass='ipsNavBar_active' data-active\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n id='elNavSecondary_\nCONTENT;\n$return .= htmlspecialchars( $item->id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-role=\"navBarItem\" data-navApp=\"\nCONTENT;\n\n$return .= htmlspecialchars( mb_substr( get_class( $item ), 4, mb_strpos( get_class( $item ), '\\\\', 4 ) - 4 ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-navExt=\"\nCONTENT;\n\n$return .= htmlspecialchars( mb_substr( get_class( $item ), mb_strrpos( get_class( $item ), '\\\\' ) + 1 ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" nav_title='\nCONTENT;\n$return .= htmlspecialchars( $item->title(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t\t\t\nCONTENT;\n\n$children = $item->children();\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( $children ):\n$return .= <<<CONTENT\n\n\t\t\t\t<a href=\"\nCONTENT;\n\nif ( $item->link() ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $item->link(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n#\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" id=\"elNavigation_\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-ipsMenu data-ipsMenu-appendTo='#\nCONTENT;\n\nif ( $parent ):\n$return .= <<<CONTENT\nelNavSecondary_\nCONTENT;\n$return .= htmlspecialchars( $parent, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nelNavSecondary_\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' data-ipsMenu-activeClass='ipsNavActive_menu' data-navItem-id=\"\nCONTENT;\n$return .= htmlspecialchars( $item->id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" \nCONTENT;\n\nif ( $active ):\n$return .= <<<CONTENT\ndata-navDefault\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $item->title(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n <i class=\"fa fa-caret-down\"><\/i>\n\t\t\t\t<\/a>\n\t\t\t\t<ul id=\"elNavigation_\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu\" class=\"ipsMenu ipsMenu_auto ipsHide\">\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'front' )->navBarChildren( $children, $preview );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/ul>\n\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t<a href=\"\nCONTENT;\n\nif ( $item->link() ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $item->link(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n#\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" \nCONTENT;\n\nif ( method_exists( $item, 'target' ) AND $item->target() ):\n$return .= <<<CONTENT\ntarget='\nCONTENT;\n$return .= htmlspecialchars( $item->target(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n data-navItem-id=\"\nCONTENT;\n$return .= htmlspecialchars( $item->id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" \nCONTENT;\n\nif ( $active ):\n$return .= <<<CONTENT\ndata-navDefault\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $item->title(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/a>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( $subBars && isset( $subBars[ $id ] ) && count( $subBars[ $id ] ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t<ul class='ipsNavBar_secondary \nCONTENT;\n\nif ( !$active ):\n$return .= <<<CONTENT\nipsHide\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' data-role='secondaryNavBar'>\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'front' )->navBarItems( $subBars[ $id ], NULL, $item->id, $preview );\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class='ipsHide' id='elNavigationMore_\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-role='navMore'>\n\t\t\t\t\t\t<a href='#' data-ipsMenu data-ipsMenu-appendTo='#elNavigationMore_\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' id='elNavigationMore_\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_dropdown'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'more', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n <i class='fa fa-caret-down'><\/i><\/a>\n\t\t\t\t\t\t<ul class='ipsHide ipsMenu ipsMenu_auto' id='elNavigationMore_\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_dropdown_menu' data-role='moreDropdown'><\/ul>\n\t\t\t\t\t<\/li>\n\t\t\t\t<\/ul>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/li>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction offlineMessage(  ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n<div id='elSiteOffline'>\n\t<h2 class='ipsType_reset'><i class='fa fa-warning'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'offline_message_title', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h2>\n\t<p class='ipsType_reset'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'offline_message_desc', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction pageHeader( $title, $blurb='', $rawBlurb=FALSE ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n<div class='ipsPageHeader ipsClearfix ipsSpacer_bottom'>\n\t<h1 class='ipsType_pageTitle'>\nCONTENT;\n$return .= htmlspecialchars( $title, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/h1>\n\t\nCONTENT;\n\nif ( $blurb ):\n$return .= <<<CONTENT\n\n\t\t<div class='ipsPageHeader_info ipsType_light'>\n\t\t\t\nCONTENT;\n\nif ( !$rawBlurb ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $blurb, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t{$blurb}\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction prefix( $encoded, $text ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( $text ):\n$return .= <<<CONTENT\n\n\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=search&controller=search&tags={$encoded}\", null, \"tags\", array(), 0 ) );\n$return .= <<<CONTENT\n\" title=\"\nCONTENT;\n\n$sprintf = array($text); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'find_tagged_content', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\" class='ipsTag_prefix'><span>\nCONTENT;\n$return .= htmlspecialchars( $text, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span><\/a>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction queryLog( $log ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div id=\"elQueryLog\">\n\t<h3 class='ipsType_center'>\nCONTENT;\n\n$return .= htmlspecialchars( count( $log ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/h3>\n\t\nCONTENT;\n\nforeach ( $log as $i => $query ):\n$return .= <<<CONTENT\n\n\t\t<div>\n\t\t\t<pre class=\"prettyprint lang-sql\" data-ipsDialog data-ipsDialog-content=\"#elQueryLog\nCONTENT;\n$return .= htmlspecialchars( $i, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu\">\nCONTENT;\n$return .= htmlspecialchars( $query['query'], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/pre>\n\t\t\t\nCONTENT;\n\nif ( $query['extra'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t<div class=\"ipsType_center\">\n\t\t\t\t\t<strong class=\"ipsType_warning\"><i class=\"fa fa-exclamation-circle\"><\/i> \nCONTENT;\n$return .= htmlspecialchars( $query['extra'], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/strong>\n\t\t\t\t<\/div>\n\t\t\t\t<br>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<div id='elQueryLog\nCONTENT;\n$return .= htmlspecialchars( $i, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu' class='ipsPad ipsHide'>\n\t\t\t\t<br>\n\t\t\t\t<pre>\nCONTENT;\n$return .= htmlspecialchars( $query['query'], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/pre>\n\t\t\t\t<hr class=\"ipsHr\">\n\t\t\t\t<pre class=\"prettyprint lang-php\">\nCONTENT;\n$return .= htmlspecialchars( $query['backtrace'], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/pre>\n\t\t\t\t<br>\n\t\t\t<\/div>\n\t\t<\/div>\n\t\t<hr class=\"ipsHr\">\n\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction rating( $size, $value, $max=5, $memberRating=NULL ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div \nCONTENT;\n\nif ( $memberRating ):\n$return .= <<<CONTENT\ndata-ipsTooltip title='\nCONTENT;\n\n$sprintf = array($memberRating, $max, $value); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'you_rated_x_stars', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n class='ipsClearfix ipsRating \nCONTENT;\n\nif ( $memberRating ):\n$return .= <<<CONTENT\nipsRating_rated\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( $size ):\n$return .= <<<CONTENT\nipsRating_\nCONTENT;\n$return .= htmlspecialchars( $size, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\nCONTENT;\n\nif ( $memberRating ):\n$return .= <<<CONTENT\n\n\t\t<ul class='ipsRating_mine'>\n\t\t\t\nCONTENT;\n\nforeach ( range( 1, $max ) as $i ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $i <= $memberRating ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class='ipsRating_on'>\n\t\t\t\t\t\t<i class='fa fa-star'><\/i>\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class='ipsRating_off'>\n\t\t\t\t\t\t<i class='fa fa-star'><\/i>\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t<\/ul>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<ul class='ipsRating_collective'>\n\t\t\nCONTENT;\n\nforeach ( range( 1, $max ) as $i ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( $i <= $value ):\n$return .= <<<CONTENT\n\n\t\t\t\t<li class='ipsRating_on'>\n\t\t\t\t\t<i class='fa fa-star'><\/i>\n\t\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nelseif ( ( $i - 0.5 ) <= $value ):\n$return .= <<<CONTENT\n\n\t\t\t\t<li class='ipsRating_half'>\n\t\t\t\t\t<i class='fa fa-star-half'><\/i><i class='fa fa-star-half fa-flip-horizontal'><\/i>\n\t\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t<li class='ipsRating_off'>\n\t\t\t\t\t<i class='fa fa-star'><\/i>\n\t\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t<\/ul>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction reputation( $content, $extraClass='', $forceType=NULL ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( $content instanceof \\IPS\\Content\\Reputation and \\IPS\\Settings::i()->reputation_enabled ):\n$return .= <<<CONTENT\n\n\t<div data-controller='core.front.core.reputation' class='ipsClearfix \nCONTENT;\n\nif ( $extraClass ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $extraClass, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->reputation_point_types == 'like' ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( $content->canGiveReputation( 1 ) || $content->canGiveReputation( -1 ) || $content->likeBlurb() ):\n$return .= <<<CONTENT\n\n\t\t\t\t<div class='ipsLikeRep ipsPos_right ipsResponsive_noFloat'>\n\t\t\t\t\t\nCONTENT;\n\nif ( $content->likeBlurb() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<span class='ipsLike_contents'>{$content->likeBlurb()}<\/span>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $content->canGiveReputation( 1 ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $content->url( 'rep' )->setQueryString( 'rep', 1 )->csrf(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action=\"giveReputation\" class='ipsButton ipsButton_like ipsButton_alternate'><i class='fa fa-heart'><\/i> <span class='ipsHide' data-role='repCount'>\nCONTENT;\n$return .= htmlspecialchars( $content->reputation(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'like', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $content->canGiveReputation( -1 ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $content->url( 'rep' )->setQueryString( 'rep', -1 )->csrf(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action=\"giveReputation\" class='ipsButton ipsButton_like ipsButton_veryLight'><i class='fa fa-times'><\/i> <span class='ipsHide' data-role='repCount'>\nCONTENT;\n$return .= htmlspecialchars( $content->reputation(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'unlike', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t<div class='ipsLikeRep ipsPos_right'>\n\t\t\t\t\nCONTENT;\n\nif ( $content->canGiveReputation( 1 ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $content->url( 'rep' )->setQueryString( 'rep', 1 )->csrf(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action=\"giveReputation\" class='ipsButton ipsButton_rep ipsButton_repUp'><i class='fa fa-arrow-up'><\/i><\/a>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $content->canGiveReputation( -1 ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $content->url( 'rep' )->setQueryString( 'rep', -1 )->csrf(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action=\"giveReputation\" class='ipsButton ipsButton_rep ipsButton_repDown'><i class='fa fa-arrow-down'><\/i><\/a>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\n\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->reputation_show_content ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->group['gbw_view_reps'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $content->url( 'showRep' ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-size='narrow' data-ipsDialog-title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'rep_log_title', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'see_who_repped', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsTooltip class='ipsReputation_count ipsType_blendLinks \nCONTENT;\n\nif ( $content->reputation() < 0 ):\n$return .= <<<CONTENT\nipsType_negative\nCONTENT;\n\nelseif ( $content->reputation() > 0 ):\n$return .= <<<CONTENT\nipsType_positive\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsType_neutral\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'><i class='fa fa-heart ipsType_small'><\/i> \nCONTENT;\n$return .= htmlspecialchars( $content->reputation(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<span class='ipsReputation_count ipsType_blendLinks \nCONTENT;\n\nif ( $content->reputation() < 0 ):\n$return .= <<<CONTENT\nipsType_negative\nCONTENT;\n\nelseif ( $content->reputation() > 0 ):\n$return .= <<<CONTENT\nipsType_positive\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsType_neutral\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'><i class='fa fa-heart ipsType_small'><\/i> \nCONTENT;\n$return .= htmlspecialchars( $content->reputation(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction reputationBadge( $author ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( \\IPS\\Settings::i()->reputation_enabled and \\IPS\\Settings::i()->reputation_show_profile and $author->member_id ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->group['gbw_view_reps'] ):\n$return .= <<<CONTENT\n\n\t\t<a href='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=profile&id={$author->member_id}&do=reputation\", null, \"profile_reputation\", array( $author->members_seo_name ), 0 ) );\n$return .= <<<CONTENT\n' title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'reputation_badge_tooltip', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" data-ipsTooltip class='ipsRepBadge \nCONTENT;\n\nif ( $author->pp_reputation_points > 0 ):\n$return .= <<<CONTENT\nipsRepBadge_positive\nCONTENT;\n\nelseif ( $author->pp_reputation_points < 0 ):\n$return .= <<<CONTENT\nipsRepBadge_negative\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsRepBadge_neutral\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t<span title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'reputation_badge_tooltip', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" data-ipsTooltip class='ipsRepBadge \nCONTENT;\n\nif ( $author->pp_reputation_points > 0 ):\n$return .= <<<CONTENT\nipsRepBadge_positive\nCONTENT;\n\nelseif ( $author->pp_reputation_points < 0 ):\n$return .= <<<CONTENT\nipsRepBadge_negative\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsRepBadge_neutral\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<i class='fa \nCONTENT;\n\nif ( $author->pp_reputation_points > 0 ):\n$return .= <<<CONTENT\nfa-plus-circle\nCONTENT;\n\nelseif ( $author->pp_reputation_points < 0 ):\n$return .= <<<CONTENT\nfa-minus-circle\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nfa-circle\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->formatNumber( abs( $author->pp_reputation_points ) );\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->group['gbw_view_reps'] ):\n$return .= <<<CONTENT\n\n\t\t<\/a>\n\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t<\/span>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction reputationLog( $table, $headers, $rows ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nforeach ( $rows as $row ):\n$return .= <<<CONTENT\n\n\t<li class='ipsGrid_span6 ipsPhotoPanel ipsPhotoPanel_mini ipsClearfix'>\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( \\IPS\\Member::load( $row['member_id'] ), 'mini' );\n$return .= <<<CONTENT\n\n\t\t<div>\n\t\t\t<h3 class='ipsType_normal ipsType_reset ipsTruncate ipsTruncate_line'>\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::load( $row['member_id'] )->name, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/h3>\n\t\t\t<span class='ipsType_light'>\n\t\t\t\t\nCONTENT;\n\nif ( $row['rep_rating'] === '1' && \\IPS\\Settings::i()->reputation_point_types != 'like' ):\n$return .= <<<CONTENT\n<i class='ipsType_large ipsType_positive fa fa-arrow-circle-up'><\/i>\nCONTENT;\n\nelseif ( \\IPS\\Settings::i()->reputation_point_types != 'like' ):\n$return .= <<<CONTENT\n<i class='ipsType_large ipsType_negative fa fa-arrow-circle-down'><\/i>\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n <span class='ipsType_medium'>\nCONTENT;\n\n$val = ( $row['rep_date'] instanceof \\IPS\\DateTime ) ? $row['rep_date'] : \\IPS\\DateTime::ts( $row['rep_date'] );$return .= $val->html();\n$return .= <<<CONTENT\n<\/span>\n\t\t\t<\/span>\n\t\t<\/div>\n\t<\/li>\n\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction reputationLogTable( $table, $headers, $rows, $quickSearch ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div data-baseurl='\nCONTENT;\n$return .= htmlspecialchars( $table->baseUrl, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-resort='\nCONTENT;\n$return .= htmlspecialchars( $table->resortKey, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-controller='core.global.core.table' \nCONTENT;\n\nif ( $table->getPaginationKey() != 'page' ):\n$return .= <<<CONTENT\ndata-pageParam='\nCONTENT;\n$return .= htmlspecialchars( $table->getPaginationKey(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\n\t\nCONTENT;\n\nif ( $table->pages > 1 ):\n$return .= <<<CONTENT\n\n\t\t<div class=\"ipsButtonBar ipsPad_half ipsClearfix ipsClear\">\n\t\t\t<div data-role=\"tablePagination\">\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'global' )->pagination( $table->baseUrl, $table->pages, $table->page, $table->limit, TRUE, $table->getPaginationKey() );\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\n\t\nCONTENT;\n\nif ( count( $rows ) ):\n$return .= <<<CONTENT\n\n\t\t<ol class='ipsGrid ipsGrid_collapsePhone ipsPad ipsClear \nCONTENT;\n\nforeach ( $table->classes as $class ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $class, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n \nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n' id='elTable_\nCONTENT;\n$return .= htmlspecialchars( $table->uniqueId, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-role=\"tableRows\" itemscope itemtype=\"http:\/\/schema.org\/ItemList\">\n\t\t\t\nCONTENT;\n\n$return .= $table->rowsTemplate[0]->{$table->rowsTemplate[1]}( $table, $headers, $rows );\n$return .= <<<CONTENT\n\n\t\t<\/ol>\n\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t<div class='ipsType_center ipsPad'>\n\t\t\t<p class='ipsType_large ipsType_light'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'no_rows_in_table', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\nCONTENT;\n\nif ( method_exists( $table, 'container' ) AND $table->container() !== NULL ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $table->container()->can('add') ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $table->container()->url()->setQueryString( 'do', 'add' ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_primary ipsButton_medium'>\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'submit_first_row', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/a>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\n\t\nCONTENT;\n\nif ( $table->pages > 1 ):\n$return .= <<<CONTENT\n\n\t\t<div class=\"ipsButtonBar ipsPad_half ipsClearfix ipsClear\">\n\t\t\t<div data-role=\"tablePagination\">\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'global' )->pagination( $table->baseUrl, $table->pages, $table->page, $table->limit, TRUE, $table->getPaginationKey() );\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction reputationMini( $repCount, $canRepUp, $canRepDown, $showRepUrl, $giveRepUrl ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div data-controller='core.front.core.reputation' class='ipsRep_mini'>\n\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->reputation_point_types == 'like' ):\n$return .= <<<CONTENT\n\n\t\t<div class='ipsLikeRep'>\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->group['gbw_view_reps'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $showRepUrl, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-size='narrow' data-ipsDialog-title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'like_log_title', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsTooltip class='ipsReputation_count \nCONTENT;\n\nif ( $repCount == 0 ):\n$return .= <<<CONTENT\nipsType_light\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsType_blendLinks\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'><i class='fa fa-heart ipsType_small'><\/i> \nCONTENT;\n$return .= htmlspecialchars( $repCount, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t<span class='ipsReputation_count \nCONTENT;\n\nif ( $repCount < 0 ):\n$return .= <<<CONTENT\nipsType_negative\nCONTENT;\n\nelseif ( $repCount > 0 ):\n$return .= <<<CONTENT\nipsType_positive\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsType_neutral\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'><i class='fa \nCONTENT;\n\nif ( $repCount < 0 ):\n$return .= <<<CONTENT\nfa-minus-circle\nCONTENT;\n\nelseif ( $repCount > 0 ):\n$return .= <<<CONTENT\nfa-plus-circle\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nfa-circle\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n ipsType_small'><\/i> \nCONTENT;\n$return .= htmlspecialchars( $repCount, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( $canRepUp ):\n$return .= <<<CONTENT\n\n\t\t\t\t&nbsp;&nbsp;<a href='\nCONTENT;\n$return .= htmlspecialchars( $giveRepUrl->setQueryString( array( 'rep' => 1, 'mini' => 1 ) )->csrf(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action=\"giveReputation\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'like', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( $canRepDown ):\n$return .= <<<CONTENT\n\n\t\t\t\t&nbsp;&nbsp;<a href='\nCONTENT;\n$return .= htmlspecialchars( $giveRepUrl->setQueryString( array( 'rep' => -1, 'mini' => 1 ) )->csrf(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action=\"giveReputation\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'unlike', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t<div class='ipsLikeRep'>\n\t\t\t\nCONTENT;\n\nif ( $canRepUp ):\n$return .= <<<CONTENT\n\n\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $giveRepUrl->setQueryString( array( 'rep' => 1, 'mini' => 1 ) )->csrf(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action=\"giveReputation\" class='ipsButton ipsButton_rep ipsButton_repUp'><i class='fa fa-arrow-up'><\/i><\/a>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( $canRepDown ):\n$return .= <<<CONTENT\n\n\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $giveRepUrl->setQueryString( array( 'rep' => -1, 'mini' => 1 ) )->csrf(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action=\"giveReputation\" class='ipsButton ipsButton_rep ipsButton_repDown'><i class='fa fa-arrow-down'><\/i><\/a>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->reputation_show_content ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->group['gbw_view_reps'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $showRepUrl, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-size='narrow' data-ipsDialog-title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'rep_log_title', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'see_who_repped', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsTooltip class='ipsReputation_count \nCONTENT;\n\nif ( $repCount < 0 ):\n$return .= <<<CONTENT\nipsType_negative\nCONTENT;\n\nelseif ( $repCount > 0 ):\n$return .= <<<CONTENT\nipsType_positive\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsType_neutral\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'><i class='fa \nCONTENT;\n\nif ( $repCount < 0 ):\n$return .= <<<CONTENT\nfa-minus-circle\nCONTENT;\n\nelseif ( $repCount > 0 ):\n$return .= <<<CONTENT\nfa-plus-circle\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nfa-circle\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n ipsType_small'><\/i> \nCONTENT;\n$return .= htmlspecialchars( $repCount, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t<span class='ipsReputation_count \nCONTENT;\n\nif ( $repCount < 0 ):\n$return .= <<<CONTENT\nipsType_negative\nCONTENT;\n\nelseif ( $repCount > 0 ):\n$return .= <<<CONTENT\nipsType_positive\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsType_neutral\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'><i class='fa \nCONTENT;\n\nif ( $repCount < 0 ):\n$return .= <<<CONTENT\nfa-minus-circle\nCONTENT;\n\nelseif ( $repCount > 0 ):\n$return .= <<<CONTENT\nfa-plus-circle\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nfa-circle\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n ipsType_small'><\/i> \nCONTENT;\n$return .= htmlspecialchars( $repCount, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction reputationOthers( $contentURL, $lang, $names ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( \\IPS\\Settings::i()->reputation_point_types == 'like' ):\n$return .= <<<CONTENT\n\n<a href='\nCONTENT;\n$return .= htmlspecialchars( $contentURL, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-destructOnClose data-ipsDialog-size='narrow' data-ipsDialog-title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'like_log_title', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'see_who_liked', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsTooltip data-ipsTooltip-label='\nCONTENT;\n$return .= htmlspecialchars( $names, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' data-ipsTooltip-json data-ipsTooltip-safe>\nCONTENT;\n$return .= htmlspecialchars( $lang, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a>\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n<a href='\nCONTENT;\n$return .= htmlspecialchars( $contentURL, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-destructOnClose data-ipsDialog-size='narrow' data-ipsDialog-title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'rep_log_title', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'see_who_repped', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsTooltip>\nCONTENT;\n$return .= htmlspecialchars( $lang, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction review( $item, $review, $editorName, $app, $type ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div id='review-\nCONTENT;\n$return .= htmlspecialchars( $review->id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_wrap' data-controller='core.front.core.comment' data-commentApp='\nCONTENT;\n$return .= htmlspecialchars( $app, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-commentType='\nCONTENT;\n$return .= htmlspecialchars( $type, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n-review' data-commentID=\"\nCONTENT;\n$return .= htmlspecialchars( $review->id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-quoteData='\nCONTENT;\n\n$return .= htmlspecialchars( json_encode( array('userid' => $review->author()->member_id, 'username' => $review->author()->name, 'timestamp' => $review->mapped('date'), 'contentapp' => $app, 'contenttype' => $type, 'contentid' => $item->id, 'contentcommentid' => $review->id) ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsComment_content ipsType_medium' itemprop='review' itemscope itemtype=\"http:\/\/schema.org\/Review\">\n\t<div class='ipsComment_header ipsPhotoPanel ipsPhotoPanel_small ipsPhotoPanel_notPhone'>\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( $review->author(), 'small', $review->warningRef(), 'ipsPos_left' );\n$return .= <<<CONTENT\n\n\t\t<div>\n\t\t\t<p class='ipsPos_right ipsType_reset ipsType_blendLinks'>\n\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $review->item()->url()->setQueryString( array( 'do' => 'findReview', 'review' => $review->id ) ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'share_this_review', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsMenu data-ipsMenu-closeOnClick='false' id='elShareComment_\nCONTENT;\n$return .= htmlspecialchars( $review->id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-role='shareComment'><i class='fa fa-share-alt'><\/i><\/a>\n\t\t\t\t\nCONTENT;\n\nif ( count( $item->reviewMultimodActions() ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<span class='ipsCustomInput'>\n\t\t\t\t\t\t<input type=\"checkbox\" name=\"multimod[\nCONTENT;\n$return .= htmlspecialchars( $review->id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n]\" value=\"1\" data-role=\"moderation\" data-actions=\"\nCONTENT;\n\nif ( $review->hidden() === -1 AND $review->canUnhide() ):\n$return .= <<<CONTENT\nunhide\nCONTENT;\n\nelseif ( $review->hidden() === 1 AND $review->canUnhide() ):\n$return .= <<<CONTENT\napprove\nCONTENT;\n\nelseif ( $review->canHide() ):\n$return .= <<<CONTENT\nhide\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( $review->canDelete() ):\n$return .= <<<CONTENT\ndelete\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" data-state='\nCONTENT;\n\nif ( $review->tableStates() ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $review->tableStates(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\t<span><\/span>\n\t\t\t\t\t<\/span>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/p>\n\t\t\t<h3 class=\"ipsComment_author ipsType_blendLinks\">\n\t\t\t\t<strong class='ipsType_normal' itemprop='author'>\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userLink( $review->author(), $review->warningRef() );\n$return .= <<<CONTENT\n<\/strong>\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->reputationBadge( $review->author() );\n$return .= <<<CONTENT\n\n\t\t\t<\/h3>\n\t\t\t<p class=\"ipsComment_meta ipsType_medium ipsType_light\">\n\t\t\t\t\nCONTENT;\n\nif ( $review->mapped('date') ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<meta itemprop='datePublished' content='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\DateTime::ts( $review->mapped('date') )->format( 'Y-m-d' ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$val = ( $review->mapped('date') instanceof \\IPS\\DateTime ) ? $review->mapped('date') : \\IPS\\DateTime::ts( $review->mapped('date') );$return .= $val->html();\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'unknown_date', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t\t\t\t\nCONTENT;\n\nif ( $review->editLine() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t&middot; {$review->editLine()}\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $review->hidden() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t&middot; \nCONTENT;\n$return .= htmlspecialchars( $review->hiddenBlurb(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $review->hidden() !== 1 and $review instanceof \\IPS\\Content\\ReportCenter and !\\IPS\\Member::loggedIn()->group['gbw_no_report']  ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t&middot; <a href='\nCONTENT;\n$return .= htmlspecialchars( $review->url('report'), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-remoteSubmit data-ipsDialog-size='medium' data-ipsDialog-flashMessage='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'report_submit_success', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsDialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'report', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" data-action='reportComment' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'report', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'report', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/p>\n\t\t\t<ul class='ipsList_inline ipsClearfix ipsRating ipsRating_large' itemprop='reviewRating' itemscope itemtype='http:\/\/schema.org\/Rating'>\n\t\t\t\t<meta itemprop='worstRating' content='1'>\n\t\t\t\t<meta itemprop='bestRating' content='\nCONTENT;\n\n$return .= htmlspecialchars( intval( \\IPS\\Settings::i()->reviews_rating_out_of ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t\t\t\t\nCONTENT;\n\nforeach ( range( 1, intval( \\IPS\\Settings::i()->reviews_rating_out_of ) ) as $i ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class='\nCONTENT;\n\nif ( $review->mapped('rating') >= $i ):\n$return .= <<<CONTENT\nipsRating_on\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsRating_off\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $review->mapped('rating') === $i ):\n$return .= <<<CONTENT\n<span itemprop='ratingValue' class='ipsHide'>\nCONTENT;\n$return .= htmlspecialchars( $i, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<i class='fa fa-star'><\/i>\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t<\/ul>&nbsp;&nbsp; \nCONTENT;\n\nif ( $review->mapped('votes_total') ):\n$return .= <<<CONTENT\n<strong class='ipsType_medium'>{$review->helpfulLine()}<\/strong><br>\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t<\/div>\n\t<div class='ipsPad'>\n\t\t<div id=\"review-\nCONTENT;\n$return .= htmlspecialchars( $review->id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-role=\"commentContent\" class=\"ipsType_richText ipsType_normal ipsType_break ipsContained\" itemprop=\"reviewBody\" data-controller='core.front.core.lightboxedImages'>\n\t\t\t{$review->content()}\n\t\t<\/div>\n\n\t\t\nCONTENT;\n\nif ( $review->hidden() !== 1 ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->member_id and ( !$review->mapped('votes_data') or !array_key_exists( \\IPS\\Member::loggedIn()->member_id, json_decode( $review->mapped('votes_data'), TRUE ) ) ) and $review->author()->member_id != \\IPS\\Member::loggedIn()->member_id ):\n$return .= <<<CONTENT\n\n\t\t\t\t<span class='ipsType_medium'><strong>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'did_you_find_this_helpful', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong> &nbsp;&nbsp;&nbsp;<a href='\nCONTENT;\n$return .= htmlspecialchars( $review->url('rate')->setQueryString( 'helpful', TRUE )->csrf(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_verySmall ipsButton_light' data-action=\"rateReview\"><i class='fa fa-check'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'yes', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a> <a href='\nCONTENT;\n$return .= htmlspecialchars( $review->url('rate')->setQueryString( 'helpful', FALSE )->csrf(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_verySmall ipsButton_light' data-action=\"rateReview\"><i class='fa fa-times'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'no', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/span>\n\t\t\t\t<br class='ipsClear'>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\n\t\t\t\nCONTENT;\n\nif ( $review instanceof \\IPS\\Content\\Reputation and \\IPS\\Settings::i()->reputation_enabled ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->reputation( $review, 'ipsPos_right ipsResponsive_noFloat' );\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t\t\nCONTENT;\n\nif ( ( \\IPS\\Member::loggedIn()->member_id and ( !$review->mapped('votes_data') or !array_key_exists( \\IPS\\Member::loggedIn()->member_id, json_decode( $review->mapped('votes_data'), TRUE ) ) ) ) || $review->canEdit() || $review->canDelete() || $review->canHide() || $review->canUnhide() ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( $review->canEdit() || $review->canDelete() || $review->canHide() || $review->canUnhide() ):\n$return .= <<<CONTENT\n\n\t\t\t\t<ul class='ipsComment_controls ipsClearfix' data-role=\"commentControls\">\n\t\t\t\t\t\nCONTENT;\n\nif ( $review->hidden() === 1 && ( $review->canUnhide() || $review->canDelete() ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $review->canUnhide() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li><a href='\nCONTENT;\n$return .= htmlspecialchars( $review->url('unhide')->csrf(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_verySmall ipsButton_positive' data-action='approveComment'><i class='fa fa-check'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'approve', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $review->canDelete() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li><a href='\nCONTENT;\n$return .= htmlspecialchars( $review->url('delete')->csrf()->setQueryString('page',\\IPS\\Request::i()->page), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-confirm data-action='deleteComment' data-updateOnDelete=\"#commentCount\" class='ipsButton ipsButton_verySmall ipsButton_negative'><i class='fa fa-times'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'delete', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $review->canEdit() || $review->canSplit() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<a href='#elControls_\nCONTENT;\n$return .= htmlspecialchars( $review->id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu' id='elControls_\nCONTENT;\n$return .= htmlspecialchars( $review->id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsMenu data-ipsMenu-appendTo='#review-\nCONTENT;\n$return .= htmlspecialchars( $review->id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_wrap'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'options', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n &nbsp;<i class='fa fa-caret-down'><\/i><\/a>\n\t\t\t\t\t\t\t\t<ul id='elControls_\nCONTENT;\n$return .= htmlspecialchars( $review->id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu' class='ipsMenu ipsMenu_narrow ipsHide'>\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $review->canEdit() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $review->mapped('first') and $review->item()->canEdit() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $review->item()->url()->setQueryString( 'do', 'edit' ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $review->url('edit'), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action='editComment'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $review->canSplit() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $review->url('split'), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action='splitComment' data-ipsDialog data-ipsDialog-title=\"\nCONTENT;\n\n$sprintf = array(\\IPS\\Member::loggedIn()->language()->addToStack( $item::$title )); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'split_to_new', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'split', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<\/ul>\n\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $review->canEdit() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li><a href='\nCONTENT;\n$return .= htmlspecialchars( $review->url('edit'), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action='editComment'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\t\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $review->canDelete() || $review->canHide() || $review->canUnhide() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<a href='#elControls_review\nCONTENT;\n$return .= htmlspecialchars( $review->id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu' id='elControls_review\nCONTENT;\n$return .= htmlspecialchars( $review->id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsMenu data-ipsMenu-appendTo='#review-\nCONTENT;\n$return .= htmlspecialchars( $review->id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_wrap'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'options', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n &nbsp;<i class='fa fa-caret-down'><\/i><\/a>\n\t\t\t\t\t\t\t\t<ul id='elControls_review\nCONTENT;\n$return .= htmlspecialchars( $review->id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu' class='ipsMenu ipsMenu_narrow ipsHide'>\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $review instanceof \\IPS\\Content\\Hideable ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( !$review->hidden() and $review->canHide() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $review->url('hide')->csrf(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'hide', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'hide', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nelseif ( $review->hidden() and $review->canUnhide() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $review->url('unhide')->csrf(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'unhide', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $review->canDelete() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $review->url('delete')->csrf()->setQueryString('page',\\IPS\\Request::i()->page), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-confirm data-action='deleteComment' data-updateOnDelete=\"#reviewCount\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'delete', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<\/ul>\n\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class='ipsHide' data-role='commentLoading'>\n\t\t\t\t\t\t<span class='ipsLoading ipsLoading_tiny ipsLoading_noAnim'><\/span>\n\t\t\t\t\t<\/li>\n\t\t\t\t<\/ul>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/div>\n\t\n\t<div class='ipsMenu ipsMenu_wide ipsHide cPostShareMenu' id='elShareComment_\nCONTENT;\n$return .= htmlspecialchars( $review->id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu'>\n\t\t<div class='ipsPad'>\n\t\t\t<h4 class='ipsType_sectionHead'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'share_this_review', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h4>\n\t\t\t<hr class='ipsHr'>\n\t\t\t<h5 class='ipsType_normal ipsType_reset'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'link_to_review', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h5>\n\t\t\t<input type='text' value='\nCONTENT;\n$return .= htmlspecialchars( $review->item()->url()->setQueryString( array( 'do' => 'findReview', 'review' => $review->id ) ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsField_fullWidth'>\n\t\t<\/div>\n\t<\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction reviewContainer( $item, $review ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\n$idField = $review::$databaseColumnId;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( $review->isIgnored() ):\n$return .= <<<CONTENT\n\n\t<div class='ipsComment ipsComment_ignored ipsPad_half ipsType_light'>\n\t\t\nCONTENT;\n\n$sprintf = array($review->author()->name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'ignoring_content', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\n\t<\/div>\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t<a id='review-\nCONTENT;\n$return .= htmlspecialchars( $review->$idField, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'><\/a>\n\t<article itemscope=\"\" itemtype=\"http:\/\/schema.org\/Comment\" id=\"elReview_\nCONTENT;\n$return .= htmlspecialchars( $review->$idField, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" class=\"ipsComment ipsComment_parent ipsClearfix ipsClear \nCONTENT;\n\nif ( $review->hidden() ):\n$return .= <<<CONTENT\nipsModerated\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\">\n\t\t\nCONTENT;\n\nif ( !$item->printedAverageReviewRating ):\n$return .= <<<CONTENT\n\n\t\t\t<div itemprop=\"aggregateRating\" itemscope itemtype=\"http:\/\/schema.org\/AggregateRating\">\n\t\t\t\t<meta itemprop=\"ratingValue\" content=\"\nCONTENT;\n$return .= htmlspecialchars( $item->averageReviewRating(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\t\t\t<meta itemprop=\"reviewCount\" content=\"\nCONTENT;\n$return .= htmlspecialchars( $item->reviewCount(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\n$item->printedAverageReviewRating = true;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->review( $item, $review, $item::$formLangPrefix . 'review', $item::$application, $item::$module );\n$return .= <<<CONTENT\n\n\t<\/article>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction reviewHelpful( $helpful, $total ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n<span class='ipsResponsive_hidePhone ipsResponsive_inline'>\n\t\nCONTENT;\n\n$sprintf = array($helpful, \\IPS\\Member::loggedIn()->language()->pluralize( \\IPS\\Member::loggedIn()->language()->get( 'x_members' ), array( $total ) )); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'x_members_found_helpful', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\n<\/span>\n<span class='ipsResponsive_showPhone ipsResponsive_inline'>\n\t<i class='fa fa-smile-o'><\/i> \nCONTENT;\n$return .= htmlspecialchars( $helpful, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n \/ \nCONTENT;\n\n$pluralize = array( $total ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'x_members_found_helpful_phone', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n\n<\/span>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction rssMenu(  ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n\nCONTENT;\n\nif ( count( \\IPS\\Output::i()->rssFeeds ) ):\n$return .= <<<CONTENT\n\n\t<a href='#' id='elRSS' class='ipsPos_right ipsType_large' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'available_rss', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsTooltip data-ipsMenu><i class='fa fa-rss-square'><\/i><\/a>\n\t<ul id='elRSS_menu' class='ipsMenu ipsMenu_auto ipsHide'>\n\t\t\nCONTENT;\n\nforeach ( \\IPS\\Output::i()->rssFeeds as $title => $url ):\n$return .= <<<CONTENT\n\n\t\t\t<li class='ipsMenu_item'><a title=\"\nCONTENT;\n\n$val = \"{$title}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" href=\"\nCONTENT;\n$return .= htmlspecialchars( $url, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$val = \"{$title}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t<\/ul>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction searchBar(  ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( !$preview and \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'search' ) ) AND !in_array('ipsLayout_minimal', \\IPS\\Output::i()->bodyClasses ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t<div id='elSearch' class='ipsPos_right' data-controller='core.front.core.quickSearch' itemprop=\"potentialAction\" itemscope itemtype=\"http:\/\/schema.org\/SearchAction\" data-default=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Output::i()->defaultSearchOption[0], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\t\t\t\t<form accept-charset='utf-8' action='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=search&controller=search\", null, \"search\", array(), 0 ) );\n$return .= <<<CONTENT\n' method='\nCONTENT;\n\nif ( \\IPS\\Settings::i()->use_friendly_urls and \\IPS\\Settings::i()->htaccess_mod_rewrite ):\n$return .= <<<CONTENT\nget\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\npost\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\t<meta itemprop=\"target\" content=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=search&controller=search&q=\", null, \"search\", array(), 0 ) );\n$return .= <<<CONTENT\n{q}\">\n\t\t\t\t\t\t<input type=\"hidden\" name=\"type\" value=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Output::i()->defaultSearchOption[0], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-role=\"searchFilter\">\n\t\t\t\t\t\t\n\t\t\t\t\t\t<ul id='elSearchFilter_menu' class='ipsMenu ipsMenu_selectable ipsMenu_narrow ipsHide'>\n\t\t\t\t\t\t\t<li class='ipsMenu_item \nCONTENT;\n\nif ( \\IPS\\Output::i()->defaultSearchOption[0] == 'all' ):\n$return .= <<<CONTENT\nipsMenu_itemChecked\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' data-ipsMenuValue='all'>\n\t\t\t\t\t\t\t\t<a href='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=search&controller=search\" . \"&csrfKey=\" . \\IPS\\Session::i()->csrfKey, null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'search_everything', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'search_everything', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\t<li class='ipsMenu_sep'><hr><\/li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( count( \\IPS\\Output::i()->contextualSearchOptions ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nforeach ( \\IPS\\Output::i()->contextualSearchOptions as $name => $data ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<li class='ipsMenu_item' data-ipsMenuValue='\nCONTENT;\n\n$return .= htmlspecialchars( json_encode( $data ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-options='\nCONTENT;\n\n$return .= htmlspecialchars( json_encode( $data ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\t\t\t\t\t<a href='#'>\nCONTENT;\n$return .= htmlspecialchars( $name, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<li class='ipsMenu_sep'><hr><\/li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li data-role='globalSearchMenuOptions'><\/li>\n\t\t\t\t\t\t\t<li class='ipsMenu_item ipsMenu_itemNonSelect'>\n\t\t\t\t\t\t\t\t<a href='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=search&controller=search\", null, \"search\", array(), 0 ) );\n$return .= <<<CONTENT\n' accesskey='4'><i class='fa fa-cog'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'advanced_search', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t<\/ul>\n\t\t\t\t\t\t<input type='search' id='elSearchField' placeholder='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'search_placeholder', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' name='q' itemprop=\"query-input\">\n\t\t\t\t\t\t<button type='submit'>\n\t\t\t\t\t\t<svg xmlns=\"http:\/\/www.w3.org\/2000\/svg\" xmlns:xlink=\"http:\/\/www.w3.org\/1999\/xlink\" width=\"23\" height=\"23\" viewBox=\"0 0 23 23\">\n  <defs>\n    <style>\n      .cls-1 {\n        fill: #fff;\n        fill-rule: evenodd;\n        filter: url(#filter);\n      }\n    <\/style>\n    <filter id=\"filter\" x=\"1180\" y=\"24\" width=\"23\" height=\"23\" filterUnits=\"userSpaceOnUse\">\n      <feOffset result=\"offset\" in=\"SourceAlpha\"\/>\n      <feGaussianBlur result=\"blur\" stdDeviation=\"1.414\"\/>\n      <feFlood result=\"flood\" flood-color=\"#29bdc6\"\/>\n      <feComposite result=\"composite\" operator=\"in\" in2=\"blur\"\/>\n      <feBlend result=\"blend\" in=\"SourceGraphic\"\/>\n    <\/filter>\n  <\/defs>\n  <path id=\"icon-search\" class=\"cls-1\" d=\"M1200.59,42.639l-4.23-4.227a8.468,8.468,0,1,0-1.95,1.955l4.23,4.226A1.38,1.38,0,0,0,1200.59,42.639Zm-15.15-5.119a5.715,5.715,0,1,1,4.04,1.673A5.684,5.684,0,0,1,1185.44,37.52Z\" transform=\"translate(-1180 -24)\"\/>\n<\/svg>\n\n                      <\/button>\n\t\t\t\t\t<\/form>\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction secondaryFooter(  ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['customFooter'] ):\n$return .= <<<CONTENT\n\n<div id=\"secondaryFooter\">\n\t<div class=\"ipsGrid\">\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['customFooter_section1'] ):\n$return .= <<<CONTENT\n\n\t\t\t<div class=\"ipsGrid_span4\">\n\t\t\t\t<h2>\nCONTENT;\n\n\n$return .= <<<CONTENT\n<\/h2>\n\t\t\t\t\n<p>\n\t\nCONTENT;\n\n\n$return .= <<<CONTENT\n\n<\/p>\n\t\t\t\t\n\t\t<\/div>\n\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['customFooter_section2'] ):\n$return .= <<<CONTENT\n\n\t\t\t<div class=\"ipsGrid_span3\">\n\t\t\t\t<h2>\nCONTENT;\n\n\n$return .= <<<CONTENT\n<\/h2>\n\t\t\t\t\n\nCONTENT;\n\n\n$return .= <<<CONTENT\n\n\t\t\t\n\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['customFooter_section3'] ):\n$return .= <<<CONTENT\n\n\t\t\t<div class=\"ipsGrid_span3\">\n\t\t\t<h2>\nCONTENT;\n\n\n$return .= <<<CONTENT\n<\/h2>\n\t\t\t\t\n\t\t\t\nCONTENT;\n\n\n$return .= <<<CONTENT\n\n\t\t\t\n\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['customFooter_section4'] ):\n$return .= <<<CONTENT\n\n\t\t\t<div class=\"ipsGrid_span2\">\n\t\t\t\t<h2>\nCONTENT;\n\n\n$return .= <<<CONTENT\n<\/h2>\n\t\t\t\t\n<p>\n\t\nCONTENT;\n\n\n$return .= <<<CONTENT\n\n<\/p>\n<div class=\"secondaryFooterLinks\">\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['customFooter_facebook'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<a class=\"secondaryFacebookButton\" href=\"\nCONTENT;\n\n\n$return .= <<<CONTENT\n\" target=\"blank\"><\/a>\n\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['customFooter_googlePlus'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<a class=\"secondaryGooglePlusButton\" href=\"\nCONTENT;\n\n\n$return .= <<<CONTENT\n\" target=\"blank\"><\/a>\n\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['customFooter_vk'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<a class=\"secondaryVkButton\" href=\"\nCONTENT;\n\n\n$return .= <<<CONTENT\n\" target=\"blank\"><\/a>\n\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['customFooter_pinterest'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<a class=\"secondaryPinterestButton\" href=\"\nCONTENT;\n\n\n$return .= <<<CONTENT\n\" target=\"blank\"><\/a>\n\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['customFooter_vimeo'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<a class=\"secondaryVimeoButton\" href=\"\nCONTENT;\n\n\n$return .= <<<CONTENT\n\" target=\"blank\"><\/a>\n\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['customFooter_twitter'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<a class=\"secondaryTwitterButton\" href=\"\nCONTENT;\n\n\n$return .= <<<CONTENT\n\" target=\"blank\"><\/a>\n\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['customFooter_youtube'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<a class=\"secondaryYoutubeButton\" href=\"\nCONTENT;\n\n\n$return .= <<<CONTENT\n\" target=\"blank\"><\/a>\n\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['customFooter_linkedln'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<a class=\"secondaryLinkenldButton\" href=\"\nCONTENT;\n\n\n$return .= <<<CONTENT\n\" target=\"blank\"><\/a>\n\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['customFooter_instagram'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<a class=\"secondaryInstagramButton\" href=\"\nCONTENT;\n\n\n$return .= <<<CONTENT\n\" target=\"blank\"><\/a>\n\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['customFooter_flikr'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<a class=\"secondaryFlikrButton\" href=\"\nCONTENT;\n\n\n$return .= <<<CONTENT\n\" target=\"blank\"><\/a>\n\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['customFooter_steam'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<a class=\"secondarySteamButton\" href=\"\nCONTENT;\n\n\n$return .= <<<CONTENT\n\" target=\"blank\"><\/a>\n\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['customFooter_rss'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<a class=\"secondaryRssButton\" href=\"\nCONTENT;\n\n\n$return .= <<<CONTENT\n\" target=\"blank\"><\/a>\n\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\n\t\t\t\t\t\n<\/div>\n\n\t\t\t\t\n\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n<\/div>\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction secondarySlider( $title,$html,$location=array() ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div id=\"owl-main\">\n    <div id=\"owl-banner-main\" class=\"owl-carousel owl-theme owl-loaded\">\n\n\n\n\n\n <div class=\"owl-stage-outer\">\n            <div style=\"transform: translate3d(-3806px, 0px, 0px); transition: all 0s ease 0s; width: 17127px;\" class=\"owl-stage\">\n                <div style=\"width: 1903px; margin-right: 0px;\" class=\"owl-item cloned\">\n                    <div class=\"item\">\n                        <a href=\"http:\/\/www.model-changing.net\/blogs\/blog\/53-hc-rp-czsk-arathor-rp-mythia\/\" target=\"blank\"><img src=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->resource( \"head.pnf\", \"core\", 'global', false );\n$return .= <<<CONTENT\n\" alt=\"Arathor RP Mythia\">\n                        <\/a>\n                    <\/div>\n                <\/div>\n                <div style=\"width: 1903px; margin-right: 0px;\" class=\"owl-item cloned\">\n                    <div class=\"item\">\n                        <a href=\"http:\/\/www.model-changing.net\/blogs\/blog\/49-dead-rp-the-sunset-of-lordaeron\/\" target=\"blank\"><img src=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->resource( \"head.pnf\", \"core\", 'global', false );\n$return .= <<<CONTENT\n\" alt=\"Sunset of Lordaeron\">\n                        <\/a>\n                    <\/div>\n                <\/div>\n                <div style=\"width: 1903px; margin-right: 0px;\" class=\"owl-item active\">\n                    <div class=\"item\"><img src=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->resource( \"head.pnf\", \"core\", 'global', false );\n$return .= <<<CONTENT\n\" alt=\"1\">\n                    <\/div>\n                <\/div>\n                <div style=\"width: 1903px; margin-right: 0px;\" class=\"owl-item\">\n                    <div class=\"item\"><img src=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->resource( \"head.pnf\", \"core\", 'global', false );\n$return .= <<<CONTENT\n\" alt=\"2\">\n                    <\/div>\n                <\/div>\n                <div style=\"width: 1903px; margin-right: 0px;\" class=\"owl-item\">\n                    <div class=\"item\">\n                        <a href=\"http:\/\/www.model-changing.net\/blogs\/blog\/34-rp-fr-shadow-storm\/\" target=\"blank\"><img src=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->resource( \"head.pnf\", \"core\", 'global', false );\n$return .= <<<CONTENT\n\" alt=\"Shadow Storm FR\">\n                        <\/a>\n                    <\/div>\n                <\/div>\n                <div style=\"width: 1903px; margin-right: 0px;\" class=\"owl-item\">\n                    <div class=\"item\">\n                        <a href=\"http:\/\/www.model-changing.net\/blogs\/blog\/53-hc-rp-czsk-arathor-rp-mythia\/\" target=\"blank\"><img src=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->resource( \"head.pnf\", \"core\", 'global', false );\n$return .= <<<CONTENT\n\" alt=\"Arathor RP Mythia\">\n                        <\/a>\n                    <\/div>\n                <\/div>\n                <div style=\"width: 1903px; margin-right: 0px;\" class=\"owl-item\">\n                    <div class=\"item\">\n                        <a href=\"http:\/\/www.model-changing.net\/blogs\/blog\/49-dead-rp-the-sunset-of-lordaeron\/\" target=\"blank\"><img src=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->resource( \"head.pnf\", \"core\", 'global', false );\n$return .= <<<CONTENT\n\" alt=\"Sunset of Lordaeron\">\n                        <\/a>\n                    <\/div>\n                <\/div>\n                <div style=\"width: 1903px; margin-right: 0px;\" class=\"owl-item cloned\">\n                    <div class=\"item\"><img src=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->resource( \"head.pnf\", \"core\", 'global', false );\n$return .= <<<CONTENT\n\" alt=\"1\">\n                    <\/div>\n                <\/div>\n                <div style=\"width: 1903px; margin-right: 0px;\" class=\"owl-item cloned\">\n                    <div class=\"item\"><img src=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->resource( \"head.pnf\", \"core\", 'global', false );\n$return .= <<<CONTENT\n\" alt=\"2\">\n                    <\/div>\n                <\/div>\n            <\/div>\n        <\/div>\n        <div class=\"owl-controls\">\n            <div class=\"owl-nav\">\n                <div style=\"display: none;\" class=\"owl-prev\">prev<\/div>\n                <div style=\"display: none;\" class=\"owl-next\">next<\/div>\n            <\/div>\n            <div class=\"owl-dots\" style=\"\">\n                <div class=\"owl-dot active\"><span><\/span>\n                <\/div>\n                <div class=\"owl-dot\"><span><\/span>\n                <\/div>\n                <div class=\"owl-dot\"><span><\/span>\n                <\/div>\n                <div class=\"owl-dot\"><span><\/span>\n                <\/div>\n                <div class=\"owl-dot\"><span><\/span>\n                <\/div>\n            <\/div>\n        <\/div>\n    <\/div>\n    <div id=\"owl-gradient\"><\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction sharelinks( $item ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( count( $item->sharelinks() )  ):\n$return .= <<<CONTENT\n\n\t<ul class='ipsList_inline ipsList_noSpacing ipsClearfix' data-controller=\"core.front.core.sharelink\">\n\t\t\nCONTENT;\n\nforeach ( $item->sharelinks() as $sharelink  ):\n$return .= <<<CONTENT\n\n\t\t\t<li>{$sharelink}<\/li>\n\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t<\/ul>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction sidebar( $position='left' ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( (isset( \\IPS\\Output::i()->sidebar['enabled'] ) and \\IPS\\Output::i()->sidebar['enabled'] ) && ( ( isset( \\IPS\\Output::i()->sidebar['contextual'] ) && trim( \\IPS\\Output::i()->sidebar['contextual'] ) !== '' ) || ( isset( \\IPS\\Output::i()->sidebar['widgets']['sidebar'] ) && count( \\IPS\\Output::i()->sidebar['widgets']['sidebar'] ) ) || ( \\IPS\\Dispatcher::i()->application instanceof \\IPS\\Application AND \\IPS\\Dispatcher::i()->application->canManageWidgets() ) ) ):\n$return .= <<<CONTENT\n\n\t<div id='ipsLayout_sidebar' class='ipsLayout_sidebar\nCONTENT;\n$return .= htmlspecialchars( $position, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( !( isset( \\IPS\\Output::i()->sidebar['contextual'] ) && trim( \\IPS\\Output::i()->sidebar['contextual'] ) !== '' ) && ( !isset( \\IPS\\Output::i()->sidebar['widgets']['sidebar'] ) || !count( \\IPS\\Output::i()->sidebar['widgets']['sidebar'] ) ) && \\IPS\\Dispatcher::i()->application->canManageWidgets() ):\n$return .= <<<CONTENT\nipsLayout_sidebarUnused\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' data-controller='core.front.widgets.sidebar'>\n\t\t\nCONTENT;\n\nif ( isset( \\IPS\\Output::i()->sidebar['contextual'] ) && trim( \\IPS\\Output::i()->sidebar['contextual'] ) !== '' ):\n$return .= <<<CONTENT\n\n\t\t\t<aside id=\"elContextualTools\" class='ipsClearfix' \nCONTENT;\n\nif ( isset( \\IPS\\Output::i()->sidebar['sticky'] ) ):\n$return .= <<<CONTENT\ndata-ipsSticky\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Output::i()->sidebar['contextual'];\n$return .= <<<CONTENT\n\n\t\t\t<\/aside>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( isset(\\IPS\\Output::i()->sidebar['widgets']['sidebar']) and count( \\IPS\\Output::i()->sidebar['widgets']['sidebar'] ) and ( \\IPS\\core\\Advertisement::loadByLocation( 'ad_sidebar' ) )  ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\core\\Advertisement::loadByLocation( 'ad_sidebar' );\n$return .= <<<CONTENT\n\n\t\t\t<br><br>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->widgetContainer( 'sidebar', 'vertical' );\n$return .= <<<CONTENT\n\n\t<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction signature( $member ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( !\\IPS\\Member::loggedIn()->isIgnoring( $member, 'signatures' ) AND \\IPS\\Settings::i()->signatures_enabled AND \\IPS\\Member::loggedIn()->members_bitoptions['view_sigs'] ):\n$return .= <<<CONTENT\n\n\t<div data-role=\"memberSignature\" class='ipsResponsive_hidePhone'>\n\t\t<hr class='ipsHr'>\n\n\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->member_id ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\n$uniqid = md5( uniqid() );\n$return .= <<<CONTENT\n\n\t\t\t<div class='ipsPos_right'>\n\t\t\t\t<a href='#elSigIgnore\nCONTENT;\n$return .= htmlspecialchars( $uniqid, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu' data-memberID=\"\nCONTENT;\n$return .= htmlspecialchars( $member->member_id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" id='elSigIgnore\nCONTENT;\n$return .= htmlspecialchars( $uniqid, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-role='signatureOptions' data-ipsMenu class='ipsFaded ipsFaded_more ipsFaded_withHover ipsType_light' data-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit_signature_options', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t<i class='fa fa-times'><\/i> <i class='fa fa-caret-down'><\/i>\n\t\t\t\t<\/a>\n\n\t\t\t\t<ul class='ipsMenu ipsMenu_medium ipsHide' id='elSigIgnore\nCONTENT;\n$return .= htmlspecialchars( $uniqid, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu'>\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->member_id != $member->member_id ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li class='ipsMenu_item' data-ipsMenuValue='oneSignature'>\n\t\t\t\t\t\t\t<a href='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=ignore&do=ignoreType&type=signatures&member_id={$member->member_id}\" . \"&csrfKey=\" . \\IPS\\Session::i()->csrfKey, null, \"ignore\", array(), 0 ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$sprintf = array($member->name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'hide_members_signature', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class='ipsMenu_item' data-ipsMenuValue='allSignatures'>\n\t\t\t\t\t\t<a href='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=settings&do=toggleSigs\" . \"&csrfKey=\" . \\IPS\\Session::i()->csrfKey, null, \"settings\", array(), 0 ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'hide_all_signatures', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t<\/li>\n\t\t\t\t<\/ul>\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t\t<div class='ipsType_light ipsType_richText'>\n\t\t\t{$member->signature}\n\t\t<\/div>\n\t<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction ta_Categories(  ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['category_r1'] == '1' ):\n$return .= <<<CONTENT\n\n\t.cForumRow[cat-title=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['cat_title_r1'];\n$return .= <<<CONTENT\n\"] h2{\n\t\tbackground: \nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['cat_ti_bg_r1'];\n$return .= <<<CONTENT\n;\n\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['cat_ti_bg_gradi_r1'] ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['cat_ti_bg_gradi_r1'];\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t}\n\t.cForumRow[cat-title=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['cat_title_r1'];\n$return .= <<<CONTENT\n\"] a.ipsType_sectionTitle,\n\t.cForumRow[cat-title=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['cat_title_r1'];\n$return .= <<<CONTENT\n\"] .ipsType_sectionTitle a{\n\t\tcolor: \nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['cat_ti_font_r1'];\n$return .= <<<CONTENT\n;\n\t}\n\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['cat_private_r1'] == '1' ):\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['cat_exclude_group_r1'] =='*' or \\IPS\\Member::loggedIn()->inGroup( explode( ',', \\IPS\\Theme::i()->settings['cat_exclude_group_r1'] ) ) ):\n$return .= <<<CONTENT\n \nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t.cForumRow[cat-title=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['cat_title_r1'];\n$return .= <<<CONTENT\n\"] > ol:before {\n    \t\t\tcontent: \"\";\n    \t\t\tposition: absolute;\n    \t\t\ttop: 0;\n    \t\t\twidth: 100%;\n    \t\t\theight: 100%;\n    \t\t\tz-index: 1;\n\t\t\t}\n\t\t\t.cForumRow[cat-title=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['cat_title_r1'];\n$return .= <<<CONTENT\n\"] > ol:before {\n\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['cat_private_bg_r1'] ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['cat_private_bg_r1'];\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t}\n\t\t\t.cForumRow[cat-title=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['cat_title_r1'];\n$return .= <<<CONTENT\n\"] > ol:after {\n  \t\t\t\tcontent: \"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['cat_private_ti_r1'];\n$return .= <<<CONTENT\n\";\n\t\t\t\tfont-size: 25px;\n\t\t\t\tcolor: \nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['cat_private_ti_font_r1'];\n$return .= <<<CONTENT\n; \n\t\t\t\tposition: absolute;\n\t\t\t\ttop: 50%;\n\t\t\t\tleft: 50%;\n\t\t\t\twidth: 100%;\n\t\t\t\ttext-align: center;\n\t\t\t\t-ms-transform: translate(-50%, -50%);\n\t\t\t\t-webkit-transform: translate(-50%, -50%);\n\t\t\t\ttransform: translate(-50%, -50%);\n\t\t\t\tz-index: 1;\n\t\t\t}\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['category_r2'] == '1' ):\n$return .= <<<CONTENT\n\n\t.cForumRow[cat-title=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['cat_title_r2'];\n$return .= <<<CONTENT\n\"] h2{\n\t\tbackground: \nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['cat_ti_bg_r2'];\n$return .= <<<CONTENT\n;\n\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['cat_ti_bg_gradi_r2'] ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['cat_ti_bg_gradi_r2'];\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t}\n\t.cForumRow[cat-title=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['cat_title_r2'];\n$return .= <<<CONTENT\n\"] a.ipsType_sectionTitle,\n\t.cForumRow[cat-title=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['cat_title_r2'];\n$return .= <<<CONTENT\n\"] .ipsType_sectionTitle a{\n\t\tcolor: \nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['cat_ti_font_r2'];\n$return .= <<<CONTENT\n;\n\t}\n\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['cat_private_r2'] == '1' ):\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['cat_exclude_group_r2'] =='*' or \\IPS\\Member::loggedIn()->inGroup( explode( ',', \\IPS\\Theme::i()->settings['cat_exclude_group_r2'] ) ) ):\n$return .= <<<CONTENT\n \nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t.cForumRow[cat-title=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['cat_title_r2'];\n$return .= <<<CONTENT\n\"] > ol:before {\n    \t\t\tcontent: \"\";\n    \t\t\tposition: absolute;\n    \t\t\ttop: 0;\n    \t\t\twidth: 100%;\n    \t\t\theight: 100%;\n    \t\t\tz-index: 1;\n\t\t\t}\n\t\t\t.cForumRow[cat-title=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['cat_title_r2'];\n$return .= <<<CONTENT\n\"] > ol:before {\n\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['cat_private_bg_r2'] ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['cat_private_bg_r2'];\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t}\n\t\t\t.cForumRow[cat-title=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['cat_title_r2'];\n$return .= <<<CONTENT\n\"] > ol:after {\n  \t\t\t\tcontent: \"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['cat_private_ti_r2'];\n$return .= <<<CONTENT\n\";\n\t\t\t\tfont-size: 25px;\n\t\t\t\tcolor: \nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['cat_private_ti_font_r2'];\n$return .= <<<CONTENT\n; \n\t\t\t\tposition: absolute;\n\t\t\t\ttop: 50%;\n\t\t\t\tleft: 50%;\n\t\t\t\twidth: 100%;\n\t\t\t\ttext-align: center;\n\t\t\t\t-ms-transform: translate(-50%, -50%);\n\t\t\t\t-webkit-transform: translate(-50%, -50%);\n\t\t\t\ttransform: translate(-50%, -50%);\n\t\t\t\tz-index: 1;\n\t\t\t}\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['category_r3'] == '1' ):\n$return .= <<<CONTENT\n\n\t.cForumRow[cat-title=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['cat_title_r3'];\n$return .= <<<CONTENT\n\"] h2{\n\t\tbackground: \nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['cat_ti_bg_r3'];\n$return .= <<<CONTENT\n;\n\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['cat_ti_bg_gradi_r3'] ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['cat_ti_bg_gradi_r3'];\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t}\n\t.cForumRow[cat-title=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['cat_title_r3'];\n$return .= <<<CONTENT\n\"] a.ipsType_sectionTitle,\n\t.cForumRow[cat-title=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['cat_title_r3'];\n$return .= <<<CONTENT\n\"] .ipsType_sectionTitle a{\n\t\tcolor: \nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['cat_ti_font_r3'];\n$return .= <<<CONTENT\n;\n\t}\n\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['cat_private_r3'] == '1' ):\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['cat_exclude_group_r3'] =='*' or \\IPS\\Member::loggedIn()->inGroup( explode( ',', \\IPS\\Theme::i()->settings['cat_exclude_group_r3'] ) ) ):\n$return .= <<<CONTENT\n \nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t.cForumRow[cat-title=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['cat_title_r3'];\n$return .= <<<CONTENT\n\"] > ol:before {\n    \t\t\tcontent: \"\";\n    \t\t\tposition: absolute;\n    \t\t\ttop: 0;\n    \t\t\twidth: 100%;\n    \t\t\theight: 100%;\n    \t\t\tz-index: 1;\n\t\t\t}\n\t\t\t.cForumRow[cat-title=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['cat_title_r3'];\n$return .= <<<CONTENT\n\"] > ol:before {\n\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['cat_private_bg_r3'] ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['cat_private_bg_r3'];\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t}\n\t\t\t.cForumRow[cat-title=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['cat_title_r3'];\n$return .= <<<CONTENT\n\"] > ol:after {\n  \t\t\t\tcontent: \"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['cat_private_ti_r3'];\n$return .= <<<CONTENT\n\";\n\t\t\t\tfont-size: 25px;\n\t\t\t\tcolor: \nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['cat_private_ti_font_r3'];\n$return .= <<<CONTENT\n; \n\t\t\t\tposition: absolute;\n\t\t\t\ttop: 50%;\n\t\t\t\tleft: 50%;\n\t\t\t\twidth: 100%;\n\t\t\t\ttext-align: center;\n\t\t\t\t-ms-transform: translate(-50%, -50%);\n\t\t\t\t-webkit-transform: translate(-50%, -50%);\n\t\t\t\ttransform: translate(-50%, -50%);\n\t\t\t\tz-index: 1;\n\t\t\t}\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction ta_Footer(  ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div class=\"ta-Footer \nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['footer_showonmobile'] == 0 ):\n$return .= <<<CONTENT\nipsResponsive_hidePhone ipsResponsive_hideTablet\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\">\n  \t<div class=\"ipsLayout_container\">\n    \nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['footer_bgimage'] || \\IPS\\Theme::i()->settings['footer_custombackground'] ):\n$return .= <<<CONTENT\n<div class=\"footerBG\"><\/div>\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<div class='ipsColumns ipsColumns_collapseTablet'>\n    \t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['footer_links1'] ):\n$return .= <<<CONTENT\n\n\t\t\t<div class='ipsColumn ipsColumn_medium'>\n\t\t\t\t<div class=\"links\">\n                  \t<h3>\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['footer_links1_header'];\n$return .= <<<CONTENT\n<\/h3>\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['footer_links1'];\n$return .= <<<CONTENT\n\n\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n        \nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['footer_links2'] ):\n$return .= <<<CONTENT\n\n\t\t\t<div class='ipsColumn ipsColumn_medium'>\n\t\t\t\t<div class=\"links\">\n                  \t<h3>\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['footer_links2_header'];\n$return .= <<<CONTENT\n<\/h3>\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['footer_links2'];\n$return .= <<<CONTENT\n\n\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['footer_links3'] ):\n$return .= <<<CONTENT\n\n\t\t\t<div class='ipsColumn ipsColumn_medium'>\n\t\t\t\t<div class=\"links\">\n                  \t<h3>\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['footer_links3_header'];\n$return .= <<<CONTENT\n<\/h3>\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['footer_links3'];\n$return .= <<<CONTENT\n\n\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['footer_articles'] == '1' ):\n$return .= <<<CONTENT\n\n\t\t\t<div class='ipsColumn ipsColumn_veryWide '>\n\t\t\t\t<div class=\"mArticles\">\n\t\t\t\t\t{block=\"Pages_Footer_Articles\"}\n\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['footer_about'] ):\n$return .= <<<CONTENT\n\n\t\t\t<div class='ipsColumn ipsColumn_fluid'>\n              <div class=\"about\">\n\t\t\t\t\t<h3>\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['footer_aboutheader'];\n$return .= <<<CONTENT\n<\/h3>\n\t\t\t\t\t<section class='ipsType_normal ipsType_richText ipsType_break' \nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['truncate_about'] == '1' ):\n$return .= <<<CONTENT\ndata-ipsTruncate data-ipsTruncate-size='\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['truncate_lines'];\n$return .= <<<CONTENT\n lines' data-ipsTruncate-type='hide'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['footer_about'];\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/section>\n\t\t\t\t\t<div class=\"followUs\">\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['footer_follow'];\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/div>\n               \t <\/div>\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/div>\n<\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction ta_Social(  ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['social_enable'] == '1' ):\n$return .= <<<CONTENT\n\n\t<div class=\"socialLinks\">\n\t\t<div class=\"followUs\">\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['footer_follow'];\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction ta_WidgetsB(  ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['g_whocansee_bottom'] =='*' or \\IPS\\Member::loggedIn()->inGroup( explode( ',', \\IPS\\Theme::i()->settings['g_whocansee_bottom'] ) ) ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['g_widget_position_bottom'] ):\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nforeach ( explode(',', \\IPS\\Theme::i()->settings['g_widget_position_bottom']) as $val ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( $val == 'forums' and \\IPS\\Request::i()->module == 'forums' or $val == 'store' and \\IPS\\Request::i()->module == 'store' or $val == 'pages' and \\IPS\\Request::i()->module == 'pages' or $val == 'downloads' and \\IPS\\Request::i()->module == 'downloads' or $val == 'chat' and \\IPS\\Request::i()->module == 'chat' or $val == 'gallery' and \\IPS\\Request::i()->module == 'gallery' or $val == 'blogs' and \\IPS\\Request::i()->module == 'blogs' or $val == 'calendar' and \\IPS\\Request::i()->module == 'calendar' or $val == 'activity' and \\IPS\\Request::i()->module == 'discover' or $val == 'staffdirectory' and \\IPS\\Request::i()->module == 'staffdirectory' or $val == 'search' and \\IPS\\Request::i()->module == 'search' or $val == 'support' and \\IPS\\Request::i()->module == 'support' or $val == 'members' and \\IPS\\Request::i()->module == 'members' or $val == 'online' and \\IPS\\Request::i()->module == 'online' ):\n$return .= <<<CONTENT\n\n\t\t\t\t<div class=\"ta-customBlock\">\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['g_widget_title_bottom'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<h3 class=\"ipsType_reset ipsWidget_title\">\n\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['g_widget_title_bottom'];\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/h3>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<div class=\"ipsWidget_inner ipsPad_half\">\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['g_widget_content_bottom'];\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/div>\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( $val == 'all' ):\n$return .= <<<CONTENT\n\n\t\t\t\t<div class=\"ta-customBlock\">\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['g_widget_title_bottom'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<h3 class=\"ipsType_reset ipsWidget_title\">\n\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['g_widget_title_bottom'];\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/h3>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<div class=\"ipsWidget_inner ipsPad_half\">\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['g_widget_content_bottom'];\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/div>\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction ta_WidgetsT(  ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['g_whocansee_top'] =='*' or \\IPS\\Member::loggedIn()->inGroup( explode( ',', \\IPS\\Theme::i()->settings['g_whocansee_top'] ) ) ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['g_widget_position_top'] ):\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nforeach ( explode(',', \\IPS\\Theme::i()->settings['g_widget_position_top']) as $val ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( $val == 'forums' and \\IPS\\Request::i()->module == 'forums' or $val == 'store' and \\IPS\\Request::i()->module == 'store' or $val == 'pages' and \\IPS\\Request::i()->module == 'pages' or $val == 'downloads' and \\IPS\\Request::i()->module == 'downloads' or $val == 'chat' and \\IPS\\Request::i()->module == 'chat' or $val == 'gallery' and \\IPS\\Request::i()->module == 'gallery' or $val == 'blogs' and \\IPS\\Request::i()->module == 'blogs' or $val == 'calendar' and \\IPS\\Request::i()->module == 'calendar' or $val == 'activity' and \\IPS\\Request::i()->module == 'discover' or $val == 'staffdirectory' and \\IPS\\Request::i()->module == 'staffdirectory' or $val == 'search' and \\IPS\\Request::i()->module == 'search' or $val == 'support' and \\IPS\\Request::i()->module == 'support' or $val == 'members' and \\IPS\\Request::i()->module == 'members' or $val == 'online' and \\IPS\\Request::i()->module == 'online' ):\n$return .= <<<CONTENT\n\n\t\t\t\t<div class=\"ta-customBlock\">\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['g_widget_title_top'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<h3 class=\"ipsType_reset ipsWidget_title\">\n\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['g_widget_title_top'];\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/h3>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<div class=\"ipsWidget_inner ipsPad_half\">\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['g_widget_content_top'];\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/div>\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( $val == 'all' ):\n$return .= <<<CONTENT\n\n\t\t\t\t<div class=\"ta-customBlock\">\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['g_widget_title_top'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<h3 class=\"ipsType_reset ipsWidget_title\">\n\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['g_widget_title_top'];\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/h3>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<div class=\"ipsWidget_inner ipsPad_half\">\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['g_widget_content_top'];\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/div>\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction ta_swiperSlider(  ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['slider_whocansee1'] =='*' or \\IPS\\Member::loggedIn()->inGroup( explode( ',', \\IPS\\Theme::i()->settings['slider_whocansee1'] ) ) or \\IPS\\Theme::i()->settings['slider_whocansee2'] =='*' or \\IPS\\Member::loggedIn()->inGroup( explode( ',', \\IPS\\Theme::i()->settings['slider_whocansee2'] ) ) or \\IPS\\Theme::i()->settings['slider_whocansee3'] =='*' or \\IPS\\Member::loggedIn()->inGroup( explode( ',', \\IPS\\Theme::i()->settings['slider_whocansee3'] ) ) or \\IPS\\Theme::i()->settings['slider_whocansee4'] =='*' or \\IPS\\Member::loggedIn()->inGroup( explode( ',', \\IPS\\Theme::i()->settings['slider_whocansee4'] ) ) or \\IPS\\Theme::i()->settings['slider_whocansee5'] =='*' or \\IPS\\Member::loggedIn()->inGroup( explode( ',', \\IPS\\Theme::i()->settings['slider_whocansee5'] ) ) ):\n$return .= <<<CONTENT\n\n<div class=\"swiper-container\">\n\t<div class=\"swiper-wrapper\">\n\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['slider_whocansee1'] =='*' or \\IPS\\Member::loggedIn()->inGroup( explode( ',', \\IPS\\Theme::i()->settings['slider_whocansee1'] ) ) ):\n$return .= <<<CONTENT\n\n      \t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['slider_1'] ):\n$return .= <<<CONTENT\n\n\t\t\t<div class=\"swiper-slide slide-1\">\n\t\t\t\t<div class=\"slide-bg swiper-lazy\" data-background=\"\nCONTENT;\n\n\n$return .= <<<CONTENT\n\"><\/div>\n              \t<div class=\"swiper-lazy-preloader\"><\/div>\n                <div class=\"slide-ov\"><\/div>\n\t\t\t\t<div class=\"slide-container\" \nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['slider_effect'] == 'fade' ):\n$return .= <<<CONTENT\ndata-swiper-parallax=\"-50%\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['slider_1_content'] || \\IPS\\Theme::i()->settings['slider_1_title'] || \\IPS\\Theme::i()->settings['slider_1_buttons'] ):\n$return .= <<<CONTENT\n\n                  \t\t<div class=\"slide-contents\">\n\t\t\t\t\t\t\t<h4 class=\"ipsType_veryLarge\"><span>\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['slider_1_title'];\n$return .= <<<CONTENT\n<\/span><\/h4>\n\t\t\t\t\t\t\t<section class='ipsType_normal ipsType_richText ipsType_break'>\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['slider_1_content'];\n$return .= <<<CONTENT\n<\/section>\n\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['slider_1_buttons'];\n$return .= <<<CONTENT\n \n                  \t\t<\/div>\n                  \t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['slider_whocansee2'] =='*' or \\IPS\\Member::loggedIn()->inGroup( explode( ',', \\IPS\\Theme::i()->settings['slider_whocansee2'] ) ) ):\n$return .= <<<CONTENT\n\n      \t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['slider_2'] ):\n$return .= <<<CONTENT\n\n\t\t\t<div class=\"swiper-slide slide-2\">\n\t\t\t\t<div class=\"slide-bg swiper-lazy\" data-background=\"\nCONTENT;\n\n\n$return .= <<<CONTENT\n\"><\/div>\n              \t<div class=\"swiper-lazy-preloader\"><\/div>\n                <div class=\"slide-ov\"><\/div>\n\t\t\t\t<div class=\"slide-container\" \nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['slider_effect'] == 'fade' ):\n$return .= <<<CONTENT\ndata-swiper-parallax=\"-50%\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['slider_2_content'] || \\IPS\\Theme::i()->settings['slider_2_title'] || \\IPS\\Theme::i()->settings['slider_2_buttons'] ):\n$return .= <<<CONTENT\n\n                  \t\t<div class=\"slide-contents\">\n\t\t\t\t\t\t\t<h4 class=\"ipsType_veryLarge\"><span>\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['slider_2_title'];\n$return .= <<<CONTENT\n<\/span><\/h4>\n\t\t\t\t\t\t\t<section class='ipsType_normal ipsType_richText ipsType_break'>\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['slider_2_content'];\n$return .= <<<CONTENT\n<\/section>\n\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['slider_2_buttons'];\n$return .= <<<CONTENT\n \n                  \t\t<\/div>\n                  \t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n      \t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['slider_whocansee3'] =='*' or \\IPS\\Member::loggedIn()->inGroup( explode( ',', \\IPS\\Theme::i()->settings['slider_whocansee3'] ) ) ):\n$return .= <<<CONTENT\n\n      \t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['slider_3'] ):\n$return .= <<<CONTENT\n\n\t\t\t<div class=\"swiper-slide slide-3\">\n\t\t\t\t<div class=\"slide-bg swiper-lazy\" data-background=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['slider_image3'];\n$return .= <<<CONTENT\n\"><\/div>\n              \t<div class=\"swiper-lazy-preloader\"><\/div>\n\t\t\t\t<div class=\"slide-ov\"><\/div>\n\t\t\t\t<div class=\"slide-container\" \nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['slider_effect'] == 'fade' ):\n$return .= <<<CONTENT\ndata-swiper-parallax=\"-50%\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['slider_3_content'] || \\IPS\\Theme::i()->settings['slider_3_title'] || \\IPS\\Theme::i()->settings['slider_3_buttons'] ):\n$return .= <<<CONTENT\n\n                  \t\t<div class=\"slide-contents\">\n\t\t\t\t\t\t\t<h4 class=\"ipsType_veryLarge\"><span>\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['slider_3_title'];\n$return .= <<<CONTENT\n<\/span><\/h4>\n\t\t\t\t\t\t\t<section class='ipsType_normal ipsType_richText ipsType_break'>\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['slider_3_content'];\n$return .= <<<CONTENT\n<\/section>\n\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['slider_3_buttons'];\n$return .= <<<CONTENT\n \n                  \t\t<\/div>\n                  \t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['slider_whocansee4'] =='*' or \\IPS\\Member::loggedIn()->inGroup( explode( ',', \\IPS\\Theme::i()->settings['slider_whocansee4'] ) ) ):\n$return .= <<<CONTENT\n\n      \t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['slider_4'] ):\n$return .= <<<CONTENT\n\n\t\t\t<div class=\"swiper-slide slide-4\">\n\t\t\t\t<div class=\"slide-bg swiper-lazy\" data-background=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['slider_image4'];\n$return .= <<<CONTENT\n\"><\/div>\n              \t<div class=\"swiper-lazy-preloader\"><\/div>\n\t\t\t\t<div class=\"slide-ov\"><\/div>\n\t\t\t\t<div class=\"slide-container\" \nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['slider_effect'] == 'fade' ):\n$return .= <<<CONTENT\ndata-swiper-parallax=\"-50%\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['slider_4_content'] || \\IPS\\Theme::i()->settings['slider_4_title'] || \\IPS\\Theme::i()->settings['slider_4_buttons'] ):\n$return .= <<<CONTENT\n\n                  \t\t<div class=\"slide-contents\">\n\t\t\t\t\t\t\t<h4 class=\"ipsType_veryLarge\"><span>\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['slider_4_title'];\n$return .= <<<CONTENT\n<\/span><\/h4>\n\t\t\t\t\t\t\t<section class='ipsType_normal ipsType_richText ipsType_break'>\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['slider_4_content'];\n$return .= <<<CONTENT\n<\/section>\n\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['slider_4_buttons'];\n$return .= <<<CONTENT\n \n                  \t\t<\/div>\n                  \t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n      \t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['slider_whocansee5'] =='*' or \\IPS\\Member::loggedIn()->inGroup( explode( ',', \\IPS\\Theme::i()->settings['slider_whocansee5'] ) ) ):\n$return .= <<<CONTENT\n\n      \t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['slider_5'] ):\n$return .= <<<CONTENT\n\n\t\t\t<div class=\"swiper-slide slide-5\">\n\t\t\t\t<div class=\"slide-bg swiper-lazy\" data-background=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['slider_image5'];\n$return .= <<<CONTENT\n\"><\/div>\n              \t<div class=\"swiper-lazy-preloader\"><\/div>\n\t\t\t\t<div class=\"slide-ov\"><\/div>\n\t\t\t\t<div class=\"slide-container\" \nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['slider_effect'] == 'fade' ):\n$return .= <<<CONTENT\ndata-swiper-parallax=\"-50%\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['slider_5_content'] || \\IPS\\Theme::i()->settings['slider_5_title'] || \\IPS\\Theme::i()->settings['slider_5_buttons'] ):\n$return .= <<<CONTENT\n\n                  \t\t<div class=\"slide-contents\">\n\t\t\t\t\t\t\t<h4 class=\"ipsType_veryLarge\"><span>\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['slider_5_title'];\n$return .= <<<CONTENT\n<\/span><\/h4>\n\t\t\t\t\t\t\t<section class='ipsType_normal ipsType_richText ipsType_break'>\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['slider_5_content'];\n$return .= <<<CONTENT\n<\/section>\n\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['slider_5_buttons'];\n$return .= <<<CONTENT\n \n                  \t\t<\/div>\n                  \t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['slider_enable_articles'] ):\n$return .= <<<CONTENT\n\n\t\t\t{block=\"pages_slider_1\"}\n      \t\t{block=\"pages_slider_2\"}\n\t\t\t{block=\"pages_slider_3\"}\n\t\t\t{block=\"pages_slider_4\"}\n      \t\t{block=\"pages_slider_5\"}\n\t\t\t{block=\"pages_slider_6\"}\n\t\t\t{block=\"pages_slider_7\"}\n      \t\t{block=\"pages_slider_8\"}\n\t\t\t{block=\"pages_slider_9\"}\n\t\t\t{block=\"pages_slider_10\"}\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/div>\n\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['slider_enable_pagination'] ):\n$return .= <<<CONTENT\n\n\t\t<div class=\"swiper-pagination ipsLayout_container\"><\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n  \t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['slider_navigation_buttons'] ):\n$return .= <<<CONTENT\n\n\t\t<div class=\"swiper-next\"><\/div>\n        <div class=\"swiper-prev\"><\/div>\n  \t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/div>\n\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['remo_bodbgimgwidslider'] == '1' and \\IPS\\Theme::i()->settings['header_layout'] == 'wide' ):\n$return .= <<<CONTENT\n<style>body.ipsApp.ipsApp_front{background-image: none!important}<\/style>\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t<div class=\"ta-Header\">\n\t\t<div class=\"ta-headerImage\" style=\"background-image: url(\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['u_hdrimgs'] ):\n$return .= <<<CONTENT\n\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['u_hdrimgs'] == 'slider1' ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n\n$return .= <<<CONTENT\n\nCONTENT;\n\nelseif ( \\IPS\\Theme::i()->settings['u_hdrimgs'] == 'slider2' ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n\n$return .= <<<CONTENT\n\nCONTENT;\n\nelseif ( \\IPS\\Theme::i()->settings['u_hdrimgs'] == 'slider3' ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['slider_image3'];\n$return .= <<<CONTENT\n\nCONTENT;\n\nelseif ( \\IPS\\Theme::i()->settings['u_hdrimgs'] == 'slider4' ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['slider_image4'];\n$return .= <<<CONTENT\n\nCONTENT;\n\nelseif ( \\IPS\\Theme::i()->settings['u_hdrimgs'] == 'slider5' ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['slider_image5'];\n$return .= <<<CONTENT\n\nCONTENT;\n\nelseif ( \\IPS\\Theme::i()->settings['u_hdrimgs'] == 'none' ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n)\"><\/div>\n\t<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction ta_swipersliderBase(  ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['enable_slider'] == '1' and \\IPS\\Theme::i()->settings['enable_slider_whocansee'] =='*' or \\IPS\\Member::loggedIn()->inGroup( explode( ',', \\IPS\\Theme::i()->settings['enable_slider_whocansee'] ) ) ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['slider_specificpage'] ):\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( in_array('pages', explode(',', \\IPS\\Theme::i()->settings['slider_specificpage'])) and \\IPS\\Request::i()->module == 'pages' or in_array('forums', explode(',', \\IPS\\Theme::i()->settings['slider_specificpage'])) and \\IPS\\Request::i()->module == 'forums' or in_array('forumsfront', explode(',', \\IPS\\Theme::i()->settings['slider_specificpage'])) and \\IPS\\Request::i()->module == 'forums' and \\IPS\\Request::i()->controller == 'index' or in_array('gallery', explode(',', \\IPS\\Theme::i()->settings['slider_specificpage'])) and \\IPS\\Request::i()->module == 'gallery' or in_array('blogs', explode(',', \\IPS\\Theme::i()->settings['slider_specificpage'])) and \\IPS\\Request::i()->module == 'blogs' ):\n$return .= <<<CONTENT\n\t\t\t\t\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'front' )->ta_swiperSlider(  );\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t<div class=\"ta-Header\">\n\t\t\t\t<div class=\"ta-headerImage\" style=\"background-image: url(\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['u_hdrimgs'] == 'slider1' ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n\n$return .= <<<CONTENT\n\nCONTENT;\n\nelseif ( \\IPS\\Theme::i()->settings['u_hdrimgs'] == 'slider2' ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n\n$return .= <<<CONTENT\n\nCONTENT;\n\nelseif ( \\IPS\\Theme::i()->settings['u_hdrimgs'] == 'slider3' ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['slider_image3'];\n$return .= <<<CONTENT\n\nCONTENT;\n\nelseif ( \\IPS\\Theme::i()->settings['u_hdrimgs'] == 'slider4' ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['slider_image4'];\n$return .= <<<CONTENT\n\nCONTENT;\n\nelseif ( \\IPS\\Theme::i()->settings['u_hdrimgs'] == 'slider5' ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['slider_image5'];\n$return .= <<<CONTENT\n\nCONTENT;\n\nelseif ( \\IPS\\Theme::i()->settings['u_hdrimgs'] == 'none' ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n)\"><\/div>\n            <\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['slider_homeall'] == 'homepage' and \\IPS\\Dispatcher::i()->application->default ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'front' )->ta_swiperSlider(  );\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nelseif ( \\IPS\\Theme::i()->settings['slider_homeall'] == 'everywhere' ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'front' )->ta_swiperSlider(  );\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t<div class=\"ta-Header\">\n\t\t\t\t<div class=\"ta-headerImage\" style=\"background-image: url(\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['u_hdrimgs'] == 'slider1' ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n\n$return .= <<<CONTENT\n\nCONTENT;\n\nelseif ( \\IPS\\Theme::i()->settings['u_hdrimgs'] == 'slider2' ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n\n$return .= <<<CONTENT\n\nCONTENT;\n\nelseif ( \\IPS\\Theme::i()->settings['u_hdrimgs'] == 'slider3' ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['slider_image3'];\n$return .= <<<CONTENT\n\nCONTENT;\n\nelseif ( \\IPS\\Theme::i()->settings['u_hdrimgs'] == 'slider4' ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['slider_image4'];\n$return .= <<<CONTENT\n\nCONTENT;\n\nelseif ( \\IPS\\Theme::i()->settings['u_hdrimgs'] == 'slider5' ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['slider_image5'];\n$return .= <<<CONTENT\n\nCONTENT;\n\nelseif ( \\IPS\\Theme::i()->settings['u_hdrimgs'] == 'none' ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n)\"><\/div>\n            <\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t<div class=\"ta-Header\">\n\t\t<div class=\"ta-headerImage\" style=\"background-image: url(\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['u_hdrimgs'] == 'slider1' ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n\n$return .= <<<CONTENT\n\nCONTENT;\n\nelseif ( \\IPS\\Theme::i()->settings['u_hdrimgs'] == 'slider2' ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n\n$return .= <<<CONTENT\n\nCONTENT;\n\nelseif ( \\IPS\\Theme::i()->settings['u_hdrimgs'] == 'slider3' ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['slider_image3'];\n$return .= <<<CONTENT\n\nCONTENT;\n\nelseif ( \\IPS\\Theme::i()->settings['u_hdrimgs'] == 'slider4' ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['slider_image4'];\n$return .= <<<CONTENT\n\nCONTENT;\n\nelseif ( \\IPS\\Theme::i()->settings['u_hdrimgs'] == 'slider5' ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->settings['slider_image5'];\n$return .= <<<CONTENT\n\nCONTENT;\n\nelseif ( \\IPS\\Theme::i()->settings['u_hdrimgs'] == 'none' ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n)\"><\/div>\n\t<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction tabs( $tabNames, $activeId, $defaultContent, $url, $tabParam='tab', $parseNames=TRUE, $contained=FALSE ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div class='ipsTabs ipsClearfix' id='elTabs_\nCONTENT;\n\n$return .= htmlspecialchars( md5( $url ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsTabBar data-ipsTabBar-contentArea='#ipsTabs_content_\nCONTENT;\n\n$return .= htmlspecialchars( md5( $url ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( \\IPS\\Request::i()->isAjax() ):\n$return .= <<<CONTENT\ndata-ipsTabBar-updateURL='false'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t<a href='#elTabs_\nCONTENT;\n\n$return .= htmlspecialchars( md5( $url ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( count ( $tabNames ) > 1 ):\n$return .= <<<CONTENT\ndata-action='expandTabs'><i class='fa fa-caret-down'><\/i>\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n>\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n<\/a>\n\t<ul role='tablist'>\n\t\t\nCONTENT;\n\nforeach ( $tabNames as $i => $name ):\n$return .= <<<CONTENT\n\n\t\t\t<li>\n\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $url->setQueryString( $tabParam, $i ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' id='\nCONTENT;\n\n$return .= htmlspecialchars( md5( $url ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_tab_\nCONTENT;\n$return .= htmlspecialchars( $i, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class=\"ipsTabs_item \nCONTENT;\n\nif ( $i == $activeId ):\n$return .= <<<CONTENT\nipsTabs_activeItem\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" title='\nCONTENT;\n\nif ( $parseNames ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= strip_tags( \\IPS\\Member::loggedIn()->language()->get( $name ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= strip_tags( $name );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' role=\"tab\" aria-selected=\"\nCONTENT;\n\nif ( $i == $activeId ):\n$return .= <<<CONTENT\ntrue\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nfalse\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\">\n\t\t\t\t\t\nCONTENT;\n\nif ( $parseNames ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$val = \"{$name}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n{$name}\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/a>\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t<\/ul>\n<\/div>\n<section id='ipsTabs_content_\nCONTENT;\n\n$return .= htmlspecialchars( md5( $url ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsTabs_panels \nCONTENT;\n\nif ( $contained ):\n$return .= <<<CONTENT\nipsTabs_contained\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\nCONTENT;\n\nforeach ( $tabNames as $i => $name ):\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( $i == $activeId ):\n$return .= <<<CONTENT\n\n\t\t\t<div id='ipsTabs_elTabs_\nCONTENT;\n\n$return .= htmlspecialchars( md5( $url ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_\nCONTENT;\n\n$return .= htmlspecialchars( md5( $url ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_tab_\nCONTENT;\n$return .= htmlspecialchars( $i, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_panel' class=\"ipsTabs_panel\" aria-labelledby=\"\nCONTENT;\n\n$return .= htmlspecialchars( md5( $url ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_tab_\nCONTENT;\n$return .= htmlspecialchars( $i, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" aria-hidden=\"false\">\n\t\t\t\t{$defaultContent}\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n<\/section>\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction tag( $tag, $tagEditUrl=NULL ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n\nCONTENT;\n\n$urlEncodedTag = rawurlencode( $tag );\n$return .= <<<CONTENT\n\n<li \nCONTENT;\n\nif ( $tagEditUrl ):\n$return .= <<<CONTENT\nclass='ipsTags_deletable'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=search&controller=search&tags={$urlEncodedTag}\", null, \"tags\", array(), 0 ) );\n$return .= <<<CONTENT\n\" class='ipsTag' title=\"\nCONTENT;\n\n$sprintf = array($tag); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'find_tagged_content', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\"><span>\nCONTENT;\n$return .= htmlspecialchars( $tag, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span><\/a>\n\t\nCONTENT;\n\nif ( $tagEditUrl ):\n$return .= <<<CONTENT\n\n\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $tagEditUrl->setQueryString( 'do', 'editTags' )->setQueryString( 'removeTag', $tag )->csrf(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsTag_remove' data-action='removeTag' data-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'remove_tag', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>&times;<\/a>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/li>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction tags( $tags, $showCondensed=FALSE, $hideResponsive=FALSE, $tagEditUrl=NULL ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\n$id = uniqid();\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( count( $tags ) OR $tagEditUrl ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( $showCondensed ):\n$return .= <<<CONTENT\n\n\t\t<ul class='ipsTags ipsTags_inline ipsList_inline \nCONTENT;\n\nif ( $hideResponsive ):\n$return .= <<<CONTENT\nipsResponsive_hidePhone ipsResponsive_inline\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\t\t\nCONTENT;\n\nif ( count( $tags ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nforeach ( $tags as $idx => $tag ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $idx < 2 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->tag( $tag, $tagEditUrl );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( count( $tags ) > 2 ):\n$return .= <<<CONTENT\n\n\t\t\t\t<li class='ipsType_small'>\n\t\t\t\t\t<span class='ipsType_light ipsCursor_pointer' data-ipsMenu id='elTags_\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$pluralize = array( count( $tags ) - 2 ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'and_x_more', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n <i class='fa fa-caret-down ipsJS_show'><\/i><\/span>\n\t\t\t\t\t<div class='ipsHide ipsMenu ipsMenu_normal ipsPad_half cTagPopup' id='elTags_\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu'>\n\t\t\t\t\t\t<p class='ipsType_medium ipsType_reset ipsType_light'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'tagged_with', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\t\t\t<ul class='ipsTags ipsList_inline'>\n\t\t\t\t\t\t\t\nCONTENT;\n\nforeach ( $tags as $tag ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->tag( $tag, NULL );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/ul>\n\t\t\t\t\t<\/div>\n\t\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/ul>\n\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t<ul class='ipsTags ipsList_inline \nCONTENT;\n\nif ( $hideResponsive ):\n$return .= <<<CONTENT\nipsResponsive_hidePhone ipsResponsive_inline\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( $tagEditUrl ):\n$return .= <<<CONTENT\ndata-controller='core.front.core.tagEditor' data-tagEditID='\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( \\IPS\\Settings::i()->tags_min ):\n$return .= <<<CONTENT\ndata-minTags='\nCONTENT;\n\n$return .= \\IPS\\Settings::i()->tags_min;\n$return .= <<<CONTENT\n'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( \\IPS\\Settings::i()->tags_max ):\n$return .= <<<CONTENT\ndata-maxTags='\nCONTENT;\n\n$return .= \\IPS\\Settings::i()->tags_max;\n$return .= <<<CONTENT\n'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t\nCONTENT;\n\nif ( count( $tags ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nforeach ( $tags as $tag ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->tag( $tag, $tagEditUrl );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( $tagEditUrl ):\n$return .= <<<CONTENT\n\n\t\t\t\t<li class='ipsTags_edit'>\n\t\t\t\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $tagEditUrl->setQueryString( 'do', 'editTags' ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit_tags', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" data-ipsMenu data-ipsMenu-closeOnClick='false' id='elTagEditor_\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_veryVerySmall ipsButton_light'><i class='fa fa-plus'><\/i>\nCONTENT;\n\nif ( !count( $tags ) ):\n$return .= <<<CONTENT\n \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'add_tags', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/ul>\n\t\t\nCONTENT;\n\nif ( $tagEditUrl ):\n$return .= <<<CONTENT\n\n\t\t\t<div id='elTagEditor_\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu' class='ipsMenu ipsMenu_wide ipsHide'>\n\t\t\t\t<div data-controller='core.front.core.tagEditorForm'>\n\t\t\t\t\t<div class='ipsPad'>\n\t\t\t\t\t\t<span><i class='icon-spinner2 ipsLoading_tinyIcon'><\/i>  &nbsp;\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'loading', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t<\/div>\n\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction thumbImage( $image, $name, $size='medium', $classes='', $lang='view_this', $url='', $extension='core_Attachment' ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n\nCONTENT;\n\nif ( $image ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\n$image = ( $image instanceof \\IPS\\File ) ? (string) $image->url : $image;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( $url ):\n$return .= <<<CONTENT\n<a href='\nCONTENT;\n$return .= htmlspecialchars( $url, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$val = \"{$lang}\"; $sprintf = array($name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n<span\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n style='background-image: url( \"\nCONTENT;\n\n$return .= \\IPS\\File::get( $extension, $image )->url;\n$return .= <<<CONTENT\n\" )' class='\nCONTENT;\n$return .= htmlspecialchars( $classes, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n ipsThumb ipsThumb_\nCONTENT;\n$return .= htmlspecialchars( $size, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n ipsThumb_bg'>\n\t\t<img src='\nCONTENT;\n\n$return .= \\IPS\\File::get( $extension, $image )->url;\n$return .= <<<CONTENT\n' alt=''>\n\t\nCONTENT;\n\nif ( $url ):\n$return .= <<<CONTENT\n<\/a>\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n<\/span>\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( $url ):\n$return .= <<<CONTENT\n<a href='\nCONTENT;\n$return .= htmlspecialchars( $url, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$val = \"{$lang}\"; $sprintf = array($name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n<span\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n class='\nCONTENT;\n$return .= htmlspecialchars( $classes, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n ipsNoThumb ipsThumb ipsThumb_\nCONTENT;\n$return .= htmlspecialchars( $size, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\nif ( $url ):\n$return .= <<<CONTENT\n<\/a>\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n<\/span>\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction updateWarning(  ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( $newVersion = \\IPS\\Application::load('core')->availableUpgrade( TRUE ) and \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'system', 'upgrade_manage' ) ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( \\IPS\\Application::load('core')->missingSecurityPatches() ):\n$return .= <<<CONTENT\n\n\t\t<div class=\"ipsMessage ipsMessage_error\" id='elLicenseKey'>\n\t\t\t\nCONTENT;\n\n$sprintf = array($newVersion['version']); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'dashboard_version_info', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'this_is_a_security_update', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t<ul class='ipsList_inline'>\n\t\t\t\t<li>\n\t\t\t\t\t<a href='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=upgrade&_new=1\", \"admin\", \"\", array(), 0 ) );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_verySmall ipsButton_veryLight'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'upgrade_now', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t<\/li>\n\t\t\t<\/ul>\n\t\t<\/div>\n\t\nCONTENT;\n\nelseif ( !isset( \\IPS\\Request::i()->cookie['updateBannerDismiss'] ) ):\n$return .= <<<CONTENT\n\n\t\t<div class=\"ipsMessage ipsMessage_general\" id='elLicenseKey' data-controller='core.global.core.updateBanner'>\n\t\t\t\nCONTENT;\n\n$sprintf = array($newVersion['version']); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'dashboard_version_info', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\n\t\t\t<ul class='ipsList_inline'>\n\t\t\t\t<li>\n\t\t\t\t\t<a href='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=upgrade&_new=1\", \"admin\", \"\", array(), 0 ) );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_verySmall ipsButton_veryLight'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'upgrade_now', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t<\/li>\n\t\t\t<\/ul>\n\t\t\t<a href='#' data-role='closeMessage' data-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'license_dismiss', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>&times;<\/a>\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction userBar(   ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->member_id  ):\n$return .= <<<CONTENT\n\n\t<ul id=\"elUserNav\" class=\"ipsList_inline cSignedIn ipsClearfix ipsResponsive_showDesktop\" data-controller=\"core.front.core.userbar\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->member_id && \\IPS\\Settings::i()->auto_polling_enabled ):\n$return .= <<<CONTENT\n,core.front.core.instantNotifications\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\">\n\t\t\nCONTENT;\n\nif ( !\\IPS\\Member::loggedIn()->restrict_post and count( \\IPS\\Member::loggedIn()->createMenu() ) ):\n$return .= <<<CONTENT\n\n\t\t\t<li id=\"cCreate\">\n\t\t\t\t<a href=\"#elCreateNew_menu\" id=\"elCreateNew\" data-ipstooltip data-ipsmenu title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'create_menu_title', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\n\t\t\t\t\t<strong><i class=\"fa fa-plus\"><\/i> \u00a0\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'create_menu', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong> <i class=\"fa fa-caret-down\"><\/i>\n\t\t\t\t<\/a>\n\t\t\t\t<div id=\"elCreateNew_menu\" class=\"ipsMenu ipsMenu_auto ipsHide\">\n\t\t\t\t\t<ul>\n\t\t\t\t\t\t\nCONTENT;\n\nforeach ( \\IPS\\Member::loggedIn()->createMenu() as $k => $url ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li class=\"ipsMenu_item\">\n\t\t\t\t\t\t\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $url['link'], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" \nCONTENT;\n\nif ( isset( $url['extraData'] ) ):\n$return .= <<<CONTENT\n \nCONTENT;\n\nforeach ( $url['extraData'] as $data => $v ):\n$return .= <<<CONTENT\n \nCONTENT;\n$return .= htmlspecialchars( $data, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n=\"\nCONTENT;\n$return .= htmlspecialchars( $v, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" \nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( isset($url['title']) AND $url['title'] ):\n$return .= <<<CONTENT\n data-ipsdialog-title=\"\nCONTENT;\n\n$val = \"{$url['title']}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( isset($url['flashMessage']) ):\n$return .= <<<CONTENT\n data-ipsdialog-flashmessage=\"\nCONTENT;\n\n$val = \"{$url['flashMessage']}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\nCONTENT;\n\n$val = \"{$k}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/ul>\n<\/div>\n\t\t\t<\/li>\n\t\t\t<li class=\"elUserNav_sep\">\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<li class=\"cNotifications cUserNav_icon\">\n\t\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=notifications\", null, \"notifications\", array(), 0 ) );\n$return .= <<<CONTENT\n\" id=\"elFullNotifications\" data-ipstooltip title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'userbar_notifications', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'escape' => TRUE ) );\n$return .= <<<CONTENT\n\" data-ipsmenu data-ipsmenu-closeonclick=\"false\">\n\t\t\t\t<i class=\"fa fa-bell\"><\/i> <span class=\"ipsNotificationCount \nCONTENT;\n\nif ( !\\IPS\\Member::loggedIn()->notification_cnt ):\n$return .= <<<CONTENT\nipsHide\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" data-notificationtype=\"notify\" data-currentcount=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->notification_cnt, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->notification_cnt, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t<\/a>\n\t\t\t<div id=\"elFullNotifications_menu\" class=\"ipsMenu ipsMenu_wide ipsHide\">\n\t\t\t\t<div class=\"ipsMenu_headerBar\">\n\t\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=notifications&do=options\", null, \"notifications_options\", array(), 0 ) );\n$return .= <<<CONTENT\n\" class=\"ipsType_light ipsPos_right\"><i class=\"fa fa-cog\"><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'notification_options', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t<h4 class=\"ipsType_sectionHead\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'notifications', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h4>\n\t\t\t\t<\/div>\n\t\t\t\t<div class=\"ipsMenu_innerContent\">\n\t\t\t\t\t<ol class=\"ipsDataList ipsDataList_readStatus\" data-role=\"notifyList\" data-ipskeynav data-ipskeynav-observe=\"return\" id=\"elNotifyContent\"><\/ol>\n<\/div>\n\t\t\t\t<div class=\"ipsMenu_footerBar ipsType_center\">\n\t\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=notifications\", null, \"notifications\", array(), 0 ) );\n$return .= <<<CONTENT\n\"><i class=\"fa fa-bars\"><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'see_all_notifications', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t <a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&section=plugins&do=clearNotifications\" . \"&csrfKey=\" . \\IPS\\Session::i()->csrfKey, null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n\" class=\"clearNotifications Notifications_menu\" style=\"margin-left:5px\"><i class=\"fa fa-trash-o\"><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'cNotifications_clear', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n<\/div>\n\t\t\t<\/div>\n\t\t<\/li>\n\t\t\nCONTENT;\n\nif ( !\\IPS\\Member::loggedIn()->members_disable_pm and \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'messaging' ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t<li class=\"cInbox cUserNav_icon\">\n\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=messaging&controller=messenger\", null, \"messaging\", array(), 0 ) );\n$return .= <<<CONTENT\n\" id=\"elFullInbox\" data-ipstooltip title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'userbar_messages', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'escape' => TRUE ) );\n$return .= <<<CONTENT\n\" data-ipsmenu data-ipsmenu-closeonclick=\"false\">\n\t\t\t\t\t<i class=\"fa fa-envelope\"><\/i> <span class=\"ipsNotificationCount \nCONTENT;\n\nif ( !\\IPS\\Member::loggedIn()->msg_count_new ):\n$return .= <<<CONTENT\nipsHide\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" data-notificationtype=\"inbox\" data-currentcount=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->msg_count_new, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->msg_count_new, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t<\/a>\n\t\t\t\t<div id=\"elFullInbox_menu\" class=\"ipsMenu ipsMenu_wide ipsHide\" data-controller=\"core.front.core.messengerMenu\">\n\t\t\t\t\t<div class=\"ipsMenu_headerBar\">\n\t\t\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=messaging&controller=messenger&do=compose\", null, \"messenger_compose\", array(), 0 ) );\n$return .= <<<CONTENT\n\" data-ipsdialog data-ipsdialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'compose_new', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" data-ipsdialog-remotesubmit data-ipsdialog-flashmessage=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'message_sent', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" id=\"elMessengerPopup_compose\" class=\"ipsPos_right ipsButton ipsButton_primary ipsButton_verySmall\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'compose_new', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t<h4 class=\"ipsType_sectionHead\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'inbox', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h4>\n\t\t\t\t\t<\/div>\n\t\t\t\t\t<div class=\"ipsMenu_innerContent\"><ol class=\"ipsDataList\" data-role=\"inboxList\" data-ipskeynav data-ipskeynav-observe=\"return\" id=\"elInboxContent\"><\/ol><\/div>\n\t\t\t\t\t<div class=\"ipsMenu_footerBar ipsType_center\">\n\t\t\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=messaging&controller=messenger\", null, \"messaging\", array(), 0 ) );\n$return .= <<<CONTENT\n\"><i class=\"fa fa-bars\"><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'go_to_inbox', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t<\/div>\n\t\t\t\t<\/div>\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'modcp' ) ) and \\IPS\\Member::loggedIn()->modPermission('can_view_reports') ):\n$return .= <<<CONTENT\n\n\t\t\t<li class=\"cReports cUserNav_icon\">\n\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=modcp&controller=modcp&tab=reports\", null, \"modcp_reports\", array(), 0 ) );\n$return .= <<<CONTENT\n\" id=\"elFullReports\" data-ipstooltip title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'userbar_reports', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'escape' => TRUE ) );\n$return .= <<<CONTENT\n\" data-ipsmenu data-ipsmenu-closeonclick=\"false\">\n\t\t\t\t\t<i class=\"fa fa-warning\"><\/i> \nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->reportCount() ):\n$return .= <<<CONTENT\n<span class=\"ipsNotificationCount\" data-notificationtype=\"reports\">\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->reportCount(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/a>\n\t\t\t\t<div id=\"elFullReports_menu\" class=\"ipsMenu ipsMenu_wide ipsHide\">\n\t\t\t\t\t<div class=\"ipsMenu_headerBar\"><h4 class=\"ipsType_sectionHead\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'report_center_header', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h4><\/div>\n\t\t\t\t\t<div class=\"ipsMenu_innerContent\" data-role=\"reportsList\"><\/div>\n\t\t\t\t\t<div class=\"ipsMenu_footerBar ipsType_center\">\n\t\t\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=modcp&controller=modcp&tab=reports\", null, \"modcp_reports\", array(), 0 ) );\n$return .= <<<CONTENT\n\"><i class=\"fa fa-bars\"><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'report_center_link', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t<\/div>\n\t\t\t\t<\/div>\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<li class=\"elUserNav_sep\">\n\t\t<li id=\"cUserLink\">\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( \\IPS\\Member::loggedIn(), 'tiny' );\n$return .= <<<CONTENT\n\n\t\t\t<a href=\"#elUserLink_menu\" id=\"elUserLink\" data-ipsmenu>\n\t\t\t\t\nCONTENT;\n\nif ( isset( $_SESSION['logged_in_as_key'] ) ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$sprintf = array($_SESSION['logged_in_from']['name']); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'front_logged_in_as', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->name, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n <i class=\"fa fa-caret-down\"><\/i>\n\t\t\t<\/a>\n\t\t\t<ul id=\"elUserLink_menu\" class=\"ipsMenu ipsMenu_normal ipsHide\">\n<li class=\"ipsMenu_title\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'menu_content', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/li>\n\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'members', 'front' ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class=\"ipsMenu_item\" data-menuitem=\"profile\"><a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->url(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'view_my_profile', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'menu_profile', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'messaging' ) ) and \\IPS\\Member::loggedIn()->members_disable_pm AND \\IPS\\Member::loggedIn()->members_disable_pm != 2 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class=\"ipsMenu_item\" data-menuitem=\"messages\"><a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=messaging&controller=messenger&do=enableMessenger\" . \"&csrfKey=\" . \\IPS\\Session::i()->csrfKey, null, \"messaging\", array(), 0 ) );\n$return .= <<<CONTENT\n\" title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'go_to_messenger', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" data-confirm data-confirmmessage=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'messenger_disabled_msg', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'menu_messages', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->group['g_attach_max'] != 0 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class=\"ipsMenu_item\" data-menuitem=\"attachments\"><a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=attachments\", null, \"attachments\", array(), 0 ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'my_attachments', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<li class=\"ipsMenu_title\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'menu_settings_title', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/li>\n\t\t\t\t<li class=\"ipsMenu_item\" data-menuitem=\"manageFollowed\"><a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=followed\", null, \"followed_content\", array(), 0 ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'menu_followed_content', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t<li class=\"ipsMenu_item\" id=\"elAccountSettingsLink\" data-menuitem=\"settings\"><a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=settings\", null, \"settings\", array(), 0 ) );\n$return .= <<<CONTENT\n\" title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit_account_settings', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'menu_settings', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n                <li class=\"ipsMenu_item\" data-menuitem=\"ignoredUsers\"><a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=ignore\", null, \"ignore\", array(), 0 ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'menu_manage_ignore', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t<li class=\"ipsMenu_sep\"><hr><\/li>\n\t\t\t\t\nCONTENT;\n\nif ( ( \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'modcp' ) ) AND \\IPS\\Member::loggedIn()->modPermission() ) or \\IPS\\Member::loggedIn()->isAdmin() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'modcp' ) ) AND \\IPS\\Member::loggedIn()->modPermission() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li class=\"ipsMenu_item\" data-menuitem=\"modcp\"><a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=modcp\", null, \"modcp\", array(), 0 ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'menu_modcp', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->isAdmin() AND !\\IPS\\Settings::i()->security_remove_acp_link  ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li class=\"ipsMenu_item\" data-menuitem=\"admincp\"><a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"\", \"admin\", \"\", array(), 0 ) );\n$return .= <<<CONTENT\n\" target=\"_blank\"><i class=\"fa fa-lock\"><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'menu_admincp', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class=\"ipsMenu_sep\"><hr><\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<li class=\"ipsMenu_item\" data-menuitem=\"signout\">\n\t\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=login&do=logout\" . \"&csrfKey=\" . \\IPS\\Session::i()->csrfKey, null, \"logout\", array(), 0 ) );\n$return .= <<<CONTENT\n\">\n\t\t\t\t\t\t\nCONTENT;\n\nif ( isset( $_SESSION['logged_in_as_key'] ) ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$sprintf = array($_SESSION['logged_in_from']['name']); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'switch_to_account', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sign_out', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/a>\n\t\t\t\t<\/li>\n\t\t\t<\/ul>\n<\/li>\n\t<\/ul>\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t<ul id=\"elUserNav\" class=\"ipsList_inline cSignedOut ipsClearfix ipsResponsive_hidePhone ipsResponsive_block\">\n<li id=\"elSignInLink\">\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->logins_over_https AND !\\IPS\\Request::i()->isSecure() ):\n$return .= <<<CONTENT\n\n\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=login\", null, \"login\", array(), \\IPS\\Settings::i()->logins_over_https ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sign_in', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=login\", null, \"login\", array(), \\IPS\\Settings::i()->logins_over_https ) );\n$return .= <<<CONTENT\n\" data-ipsmenu-closeonclick=\"false\" data-ipsmenu id=\"elUserSignIn\">\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sign_in', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n \u00a0<i class=\"fa fa-caret-down\"><\/i>\n\t\t\t\t<\/a>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->loginPopup( new \\IPS\\Login( \\IPS\\Http\\Url::internal( 'app=core&module=system&controller=login', 'front', 'login', NULL, \\IPS\\Settings::i()->logins_over_https ) ) );\n$return .= <<<CONTENT\n\n\t\t<\/li>\n\t\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->allow_reg ):\n$return .= <<<CONTENT\n\n\t\t\t<li>\n\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=register\", null, \"register\", array(), \\IPS\\Settings::i()->logins_over_https ) );\n$return .= <<<CONTENT\n\" id=\"elRegisterButton\" class=\"ipsButton ipsButton_normal ipsButton_primary\">\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sign_up', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/a>\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/ul>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction userLink( $member, $warningRef=NULL, $groupFormatting=FALSE ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( $member->member_id AND \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'members' ) )  ):\n$return .= <<<CONTENT\n<a href='\nCONTENT;\n\nif ( $warningRef ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $member->url()->setQueryString( 'wr', $warningRef ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $member->url(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' data-ipsHover data-ipsHover-target='\nCONTENT;\n$return .= htmlspecialchars( $member->url()->setQueryString( array( 'do' => 'hovercard', 'wr' => $warningRef, 'referrer' => urlencode( \\IPS\\Request::i()->url() ) ) ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' title=\"\nCONTENT;\n\n$sprintf = array($member->name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'view_user_profile', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\" class=\"ipsType_break\">\nCONTENT;\n\nif ( $groupFormatting && $member->group['prefix'] ):\n$return .= <<<CONTENT\n{$member->group['prefix']}\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $member->name, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nif ( $groupFormatting && $member->group['suffix'] ):\n$return .= <<<CONTENT\n{$member->group['suffix']}\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n<\/a>\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\nif ( $groupFormatting && $member->group['prefix'] ):\n$return .= <<<CONTENT\n{$member->group['prefix']}\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $member->name, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nif ( $groupFormatting && $member->group['suffix'] ):\n$return .= <<<CONTENT\n{$member->group['suffix']}\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction userLinkFromData( $id, $name, $seoName, $groupIdForFormatting=NULL ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( $id AND \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'members', 'front' ) )  ):\n$return .= <<<CONTENT\n<a href='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=profile&id={$id}\", null, \"profile\", array( $seoName ?: \\IPS\\Http\\Url::seoTitle( $name ) ), 0 ) );\n$return .= <<<CONTENT\n' data-ipsHover data-ipsHover-target='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=profile&id={$id}&do=hovercard\", null, \"profile\", array( $seoName ?: \\IPS\\Http\\Url::seoTitle( $name ) ), 0 ) );\n$return .= <<<CONTENT\n' title=\"\nCONTENT;\n\n$sprintf = array($name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'view_user_profile', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\" class=\"ipsType_break\">\nCONTENT;\n\nif ( $groupIdForFormatting ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member\\Group::load( $groupIdForFormatting )->formatName( $name );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $name, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n<\/a>\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\nif ( $groupIdForFormatting ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member\\Group::load( $groupIdForFormatting )->formatName( $name );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $name, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction userPhoto( $member, $size='small', $warningRef=NULL, $classes='', $hovercard=TRUE ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( $member->member_id and \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'members' ) ) ):\n$return .= <<<CONTENT\n\r\n\nCONTENT;\n\n$memberURL = ( $warningRef ) ? $member->url()->setQueryString( 'wr', $warningRef ) : $member->url();\n$return .= <<<CONTENT\n\r\n\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $memberURL, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" \nCONTENT;\n\nif ( $hovercard ):\n$return .= <<<CONTENT\ndata-ipsHover data-ipsHover-target=\"\nCONTENT;\n$return .= htmlspecialchars( $memberURL->setQueryString( 'do', 'hovercard' ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n class=\"ipsUserPhoto ipsUserPhoto_\nCONTENT;\n$return .= htmlspecialchars( $size, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nif ( $classes ):\n$return .= <<<CONTENT\n \nCONTENT;\n$return .= htmlspecialchars( $classes, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" title=\"\nCONTENT;\n\n$sprintf = array($member->name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'view_user_profile', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\">\r\n\t\t<img src='\nCONTENT;\n$return .= htmlspecialchars( $member->photo, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' alt='\nCONTENT;\n$return .= htmlspecialchars( $member->name, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' itemprop=\"image\">\r\n\t<\/a>\r\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\r\n\t<span class='ipsUserPhoto ipsUserPhoto_\nCONTENT;\n$return .= htmlspecialchars( $size, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( $classes ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $classes, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\r\n\t\t<img src='\nCONTENT;\n$return .= htmlspecialchars( $member->photo, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' alt='\nCONTENT;\n$return .= htmlspecialchars( $member->name, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' itemprop=\"image\">\r\n\t<\/span>\r\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction userPhotoFromData( $id, $name, $seoName, $photoUrl, $size='small', $classes='', $hovercard=TRUE ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( $id and \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'members' ) ) ):\n$return .= <<<CONTENT\n\n\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=profile&id={$id}\", null, \"profile\", array( $seoName ?: \\IPS\\Http\\Url::seoTitle( $name ) ), 0 ) );\n$return .= <<<CONTENT\n\" \nCONTENT;\n\nif ( $hovercard ):\n$return .= <<<CONTENT\ndata-ipsHover data-ipsHover-target=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=profile&id={$id}&do=hovercard\", null, \"profile\", array( $seoName ?: \\IPS\\Http\\Url::seoTitle( $name ) ), 0 ) );\n$return .= <<<CONTENT\n\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n class=\"ipsUserPhoto ipsUserPhoto_\nCONTENT;\n$return .= htmlspecialchars( $size, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nif ( $classes ):\n$return .= <<<CONTENT\n \nCONTENT;\n$return .= htmlspecialchars( $classes, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" title=\"\nCONTENT;\n\n$sprintf = array($name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'view_user_profile', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\">\n\t\t<img src='\nCONTENT;\n$return .= htmlspecialchars( $photoUrl, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' alt=''>\n\t<\/a>\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t<span class='ipsUserPhoto ipsUserPhoto_\nCONTENT;\n$return .= htmlspecialchars( $size, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( $classes ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $classes, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\t<img src='\nCONTENT;\n$return .= htmlspecialchars( $photoUrl, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' alt=''>\n\t<\/span>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction viglink(  ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<!--VIGLINK-->\n\nCONTENT;\n\nif ( \\IPS\\Settings::i()->viglink_groups =='all' or \\IPS\\Member::loggedIn()->inGroup( explode( ',', \\IPS\\Settings::i()->viglink_groups ) ) ):\n$return .= <<<CONTENT\n\n\t<script type=\"text\/javascript\">\n\t  var vglnk = { key: '\nCONTENT;\n\n$return .= \\IPS\\Settings::i()->viglink_api_key;\n$return .= <<<CONTENT\n'\nCONTENT;\n\nif ( \\IPS\\Settings::i()->viglink_subid ):\n$return .= <<<CONTENT\n,\n\t                sub_id: '\nCONTENT;\n\n$return .= \\IPS\\Settings::i()->viglink_subid;\n$return .= <<<CONTENT\n'\n\t                \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t              };\n\t\n\t  (function(d, t) {\n\t    var s = d.createElement(t); s.type = 'text\/javascript'; s.async = true;\n\t    s.src = '\/\/cdn.viglink.com\/api\/vglnk.js';\n\t    var r = d.getElementsByTagName(t)[0]; r.parentNode.insertBefore(s, r);\n\t  }(document, 'script'));\n\t<\/script>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction widgetContainer( $id, $orientation='horizontal' ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( ( isset( \\IPS\\Output::i()->sidebar['widgets'][ $id ] ) && count( \\IPS\\Output::i()->sidebar['widgets'][ $id ] ) ) || ( \\IPS\\Dispatcher::i()->application instanceof \\IPS\\Application AND \\IPS\\Dispatcher::i()->application->canManageWidgets() ) ):\n$return .= <<<CONTENT\n\n\t<div class='cWidgetContainer \nCONTENT;\n\nif ( !isset( \\IPS\\Output::i()->sidebar['widgets'][ $id ] ) or !count( \\IPS\\Output::i()->sidebar['widgets'][ $id ] ) ):\n$return .= <<<CONTENT\nipsHide\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( \\IPS\\Dispatcher::i()->application->canManageWidgets() ):\n$return .= <<<CONTENT\ndata-controller='core.front.widgets.area'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n data-role='widgetReceiver' data-orientation='\nCONTENT;\n$return .= htmlspecialchars( $orientation, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-widgetArea='\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t\t<ul class='ipsList_reset'>\n\t\t\t\nCONTENT;\n\nif ( isset( \\IPS\\Output::i()->sidebar['widgets'][ $id ] ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nforeach ( \\IPS\\Output::i()->sidebar['widgets'][ $id ] as $widget ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$widgetHtml = (string) $widget;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class='ipsWidget ipsWidget_\nCONTENT;\n$return .= htmlspecialchars( $orientation, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n ipsBox\nCONTENT;\n\nif ( trim( $widgetHtml ) === '' ):\n$return .= <<<CONTENT\n ipsWidgetHide ipsHide\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' data-blockID='\nCONTENT;\n\nif ( isset($widget->app) AND !empty($widget->app) ):\n$return .= <<<CONTENT\napp_\nCONTENT;\n$return .= htmlspecialchars( $widget->app, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nplugin_\nCONTENT;\n$return .= htmlspecialchars( $widget->plugin, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $widget->key, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_\nCONTENT;\n$return .= htmlspecialchars( $widget->uniqueKey, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nif ( $widget->hasConfiguration() ):\n$return .= <<<CONTENT\n data-blockConfig=\"true\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n data-blockTitle=\"\nCONTENT;\n\n$val = \"block_{$widget->key}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" data-controller='core.front.widgets.block'>{$widgetHtml}<\/li>\n\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/ul>\n\t<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}}"
VALUE;
