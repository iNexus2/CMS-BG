<?php

return <<<'VALUE'
"namespace IPS\\Theme;\nclass class_core_global_login extends \\IPS\\Theme\\Template\n{\n\tpublic $cache_key = 'f08b9663d84b3750506d9fdebffa0d5a';\n\tfunction facebook( $url ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n<a href='\nCONTENT;\n$return .= htmlspecialchars( $url, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_verySmall ipsButton_fullWidth ipsSocial ipsSocial_facebook'>\n\t<span class='ipsSocial_icon'><i class='fa fa-facebook'><\/i><\/span>\n\t<span class='ipsSocial_text'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'login_facebook', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span>\n<\/a>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction google( $url ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<a href='\nCONTENT;\n$return .= htmlspecialchars( $url, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_verySmall ipsButton_fullWidth ipsSocial ipsSocial_google'>\n\t<span class='ipsSocial_icon'><i class='fa fa-google-plus'><\/i><\/span>\n\t<span class='ipsSocial_text'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'login_google', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span>\n<\/a>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction googleAuthenticatorAuth( $waitUntil ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div id=\"elGoogleAuthenticator\" data-controller=\"core.global.core.googleAuth\" data-waitUntil=\"\nCONTENT;\n$return .= htmlspecialchars( $waitUntil, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t<div class=\"ipsPad ipsType_normal ipsType_richText ipsType_center\">\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'google_mfa_auth', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t<\/div>\n\t<ul class=\"ipsList_reset ipsPad ipsClearfix ipsAreaBackground\" data-role=\"codeInput\">\n\t\t<li class=\"ipsFieldRow ipsClearfix \" id=\"google_authenticator_form_google_authenticator_setup_code\">\n\t\t\t<div class=\"ipsFieldRow_content\">\n\t\t\t\t<input type=\"text\" name=\"google_authenticator_auth_code\" value=\"\" class=\"\nCONTENT;\n\nif ( \\IPS\\Request::i()->google_authenticator_auth_code ):\n$return .= <<<CONTENT\nipsField_error\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" autocomplete=\"off\" >\n\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Request::i()->google_authenticator_auth_code ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<p class=\"ipsType_warning\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'google_mfa_invalid_code', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t<\/li>\n\t\t<li>\n\t\t\t<button type='submit' class='ipsButton ipsButton_primary ipsButton_fullWidth ipsButton_medium'>\n\t\t\t\t<i class='fa fa-lock'><\/i> &nbsp;\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'google_submit_code', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t<\/button>\n\t\t<\/li>\n\t<\/ul>\n\t<div class=\"ipsType_center ipsHide\" data-role=\"codeWaiting\">\n\t\t<div class=\"ipsProgressBar ipsProgressBar_animated\">\n\t\t\t<div class=\"ipsProgressBar_progress\" data-role=\"codeWaitingProgress\"><\/div>\n\t\t<\/div>\n\t\t<p class=\"ipsType_small\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'google_wait_for_code', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t<\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction googleAuthenticatorSetup( $qrCodeUrl, $secretKey, $showingMultipleForms ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div id=\"elGoogleAuthenticator\" data-controller=\"core.global.core.googleAuth\">\n\t<input type=\"hidden\" name=\"secret\" value=\"\nCONTENT;\n$return .= htmlspecialchars( $secretKey, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t<div data-role=\"barcode\">\n\t\t<div class='ipsPad'>\n\t\t\t\nCONTENT;\n\nif ( !$showingMultipleForms ):\n$return .= <<<CONTENT\n\n\t\t\t\t<h1 class='ipsType_center ipsType_pageTitle ipsSpacer_bottom ipsSpacer_half'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mfa_popup_setup_title', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h1>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<div class=\"ipsType_medium ipsType_richText ipsType_center c2FA_info\">\n\t\t\t\t\nCONTENT;\n\nif ( $showingMultipleForms ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'google_mfa_desc_multi', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'google_mfa_desc_single', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t<\/div>\n\t\t<div class='ipsGrid ipsGrid_collapsePhone'>\n\t\t\t<div class='ipsGrid_span4 ipsType_center'>\n\t\t\t\t<img src=\"\nCONTENT;\n$return .= htmlspecialchars( $qrCodeUrl, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" width=\"150\" height=\"150\">\n\t\t\t<\/div>\n\t\t\t<div class='ipsGrid_span8 ipsType_center'>\n\t\t\t\t\nCONTENT;\n\n$langCode = mb_substr( \\IPS\\Member::loggedIn()->language()->bcp47(), 0, 2 );\n$return .= <<<CONTENT\n\n\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= \\IPS\\Http\\Url::ips( \"docs\/googleauth_ios\" );\n$return .= <<<CONTENT\n\" target=\"_blank\"><img src=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->resource( \"appstores\/ios\/{$langCode}.svg\", \"core\", 'global', false );\n$return .= <<<CONTENT\n\" class=\"ipsSpacer_both\"><\/a>\n\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= \\IPS\\Http\\Url::ips( \"docs\/googleauth_android\" );\n$return .= <<<CONTENT\n\" target=\"_blank\"><img src=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->resource( \"appstores\/android\/{$langCode}.png\", \"core\", 'global', false );\n$return .= <<<CONTENT\n\" style=\"height: 60px\"><\/a>\n\t\t\n\t\t\t\t<p class='ipsType_reset'>\n\t\t\t\t\t<a class=\"ipsCursor_pointer\" data-action=\"showManual\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'google_mfa_help', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t<\/p>\n\t\t\t<\/div>\n\t\t<\/div>\n\t<\/div>\n\t<div data-role=\"manual\" class=\"ipsHide\">\n\t\t<div class=\"ipsPad ipsType_normal ipsType_richText ipsType_center\">\n\t\t\t\nCONTENT;\n\nif ( !$showingMultipleForms ):\n$return .= <<<CONTENT\n\n\t\t\t\t<h1 class='ipsType_center ipsType_pageTitle ipsSpacer_bottom ipsSpacer_half'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mfa_popup_setup_title', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h1>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<div class=\"ipsType_medium ipsType_richText ipsType_center c2FA_info\">\n\t\t\t\t\nCONTENT;\n\nif ( $showingMultipleForms ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'google_mfa_desc_multi_manual', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'google_mfa_desc_single_manual', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t<\/div>\n\t\t<div class='ipsGrid ipsGrid_collapsePhone'>\n\t\t\t<div class='ipsGrid_span5'>\n\t\t\t\t<ul class=\"ipsDataList ipsDataList_reducedSpacing\">\n\t\t\t\t\t<li class=\"\">\n\t\t\t\t\t\t<span class=\"ipsDataItem_generic\">\n\t\t\t\t\t\t\t<strong>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'google_mfa_account', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong><br>\n\t\t\t\t\t\t\t<em>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'google_mfa_account_email', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/em>\n\t\t\t\t\t\t<\/span>\n\t\t\t\t\t<\/li>\n\t\t\t\t\t<li class=\"\">\n\t\t\t\t\t\t<span class=\"ipsDataItem_generic\">\n\t\t\t\t\t\t\t<strong>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'google_mfa_key', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong><br>\n\t\t\t\t\t\t\t<code>\nCONTENT;\n$return .= htmlspecialchars( $secretKey, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/code>\n\t\t\t\t\t\t<\/span>\n\t\t\t\t\t<\/li>\n\t\t\t\t\t<li class=\"\">\n\t\t\t\t\t\t<span class=\"ipsDataItem_generic\">\n\t\t\t\t\t\t\t<strong>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'google_mfa_timebased', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong><br>\n\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'yes', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/span>\n\t\t\t\t\t<\/li>\n\t\t\t\t<\/ul>\n\t\t\t<\/div>\n\t\t\t<div class='ipsGrid_span7 ipsType_center'>\n\t\t\t\t\nCONTENT;\n\n$langCode = mb_substr( \\IPS\\Member::loggedIn()->language()->bcp47(), 0, 2 );\n$return .= <<<CONTENT\n\n\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= \\IPS\\Http\\Url::ips( \"docs\/googleauth_ios\" );\n$return .= <<<CONTENT\n\" target=\"_blank\"><img src=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->resource( \"appstores\/ios\/{$langCode}.svg\", \"core\", 'global', false );\n$return .= <<<CONTENT\n\" class=\"ipsSpacer_both\"><\/a>\n\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= \\IPS\\Http\\Url::ips( \"docs\/googleauth_android\" );\n$return .= <<<CONTENT\n\" target=\"_blank\"><img src=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->resource( \"appstores\/android\/{$langCode}.png\", \"core\", 'global', false );\n$return .= <<<CONTENT\n\" style=\"height: 60px\"><\/a>\n\t\t\n\t\t\t\t<p class='ipsType_reset ipsType_center'>\n\t\t\t\t\t<a class=\"ipsCursor_pointer\" data-action=\"showBarcode\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'google_mfa_help_reset', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t<\/p>\n\t\t\t<\/div>\n\t\t<\/div>\n\t<\/div>\n\n\t<ul class=\"ipsList_reset ipsPad ipsClearfix ipsAreaBackground\">\n\t\t<li class=\"ipsFieldRow ipsClearfix \" id=\"google_authenticator_form_google_authenticator_setup_code\">\n\t\t\t<div class=\"ipsFieldRow_content\">\n\t\t\t\t<input type=\"text\" name=\"google_authenticator_setup_code\" value=\"\" class=\"\nCONTENT;\n\nif ( \\IPS\\Request::i()->google_authenticator_setup_code ):\n$return .= <<<CONTENT\nipsField_error\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\">\n\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Request::i()->google_authenticator_setup_code ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<p class=\"ipsType_warning\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'google_mfa_invalid_code', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t<\/li>\n\t\t<li>\n\t\t\t<button type='submit' class='ipsButton ipsButton_primary ipsButton_fullWidth ipsButton_medium'>\n\t\t\t\t<i class='fa fa-lock'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'google_submit_code', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t<\/button>\n\t\t<\/li>\n\t<\/ul>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction linkedin( $url ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<a href='\nCONTENT;\n$return .= htmlspecialchars( $url, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_verySmall ipsButton_fullWidth ipsSocial ipsSocial_linkedIn'>\n\t<span class='ipsSocial_icon'><i class='fa fa-linkedin'><\/i><\/span>\n\t<span class='ipsSocial_text'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'login_linkedin', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span>\n<\/a>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction live( $url ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n<a href='\nCONTENT;\n$return .= htmlspecialchars( $url, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_verySmall ipsButton_fullWidth ipsSocial ipsSocial_microsoft'>\n\t<span class='ipsSocial_icon'><i class='fa fa-windows'><\/i><\/span>\n\t<span class='ipsSocial_text'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'login_live', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span>\n<\/a>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction mfaAuthenticate( $screen, $url ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div id='elTwoFactorAuthentication' class='ipsModal' data-controller='core.global.core.2fa'>\n\t<div>\n\t\t<h1 class='ipsType_center ipsType_pageTitle ipsSpacer_top'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mfa_popup_title', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h1>\n\t\t<form action=\"\nCONTENT;\n$return .= htmlspecialchars( $url, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" method=\"post\" accept-charset='utf-8' data-ipsForm class=\"ipsForm ipsForm_fullWidth\">\n\t\t\t<input type=\"hidden\" name=\"mfa_auth\" value=\"1\">\n\t\t\t{$screen}\n\t\t\t<div class=\"ipsAreaBackground ipsType_center\">\n\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $url->setQueryString( array( '_mfa' => 'alt', '_mfaMethod' => '' ) ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_link ipsButton_medium'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mfa_try_another_method', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n <i class='fa fa-angle-right'><\/i><\/a>\n\t\t\t<\/div>\n\t\t<\/form>\n\t<\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction mfaLockout( $lockEndTime=NULL ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div id='elTwoFactorAuthentication' class='ipsModal' data-controller='core.global.core.2fa'>\n\t<div>\n\t\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->mfa_lockout_behaviour == 'lock' ):\n$return .= <<<CONTENT\n\n\t\t\t<div class=\"ipsPad ipsType_normal ipsType_richText ipsType_center\">\n\t\t\t\t\nCONTENT;\n\n$sprintf = array($lockEndTime); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mfa_locked_out_end_time', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t<div class=\"ipsPad ipsType_normal ipsType_richText ipsType_center\">\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mfa_locked_out', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\t\t\t\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->mfa_lockout_behaviour == 'email' ):\n$return .= <<<CONTENT\n\n\t\t\t\t<div class=\"ipsAreaBackground ipsPad\">\n\t\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=settings&do=mfarecovery\", \"front\", \"mfarecovery\", array(), 0 ) );\n$return .= <<<CONTENT\n\" class=\"ipsButton ipsButton_primary ipsButton_fullWidth ipsButton_medium\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mfa_recovery_email', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nelseif ( \\IPS\\Settings::i()->mfa_lockout_behaviour == 'contact' ):\n$return .= <<<CONTENT\n\n\t\t\t\t<div class=\"ipsAreaBackground ipsPad\">\n\t\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=contact&controller=contact\", \"front\", \"contact\", array(), 0 ) );\n$return .= <<<CONTENT\n\" class=\"ipsButton ipsButton_primary ipsButton_fullWidth ipsButton_medium\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mfa_recovery_contact', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction mfaRecovery( $handlers, $url ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div id='elTwoFactorAuthentication' class='ipsModal' data-controller='core.global.core.2fa'>\n\t<div>\n\t\t<h1 class='ipsType_center ipsType_pageTitle ipsSpacer_top'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mfa_popup_recover_title', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h1>\n\t\t<p class='ipsType_medium ipsType_richText ipsType_center c2FA_info'>\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mfa_popup_recover_info', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t<\/p>\n\t\t<div class=\"ipsPad\">\n\t\t\t<ul class=\"ipsList_reset\">\n\t\t\t\t\nCONTENT;\n\nforeach ( $handlers as $key => $handler ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class=\"ipsSpacer_bottom ipsSpacer_half\">\n\t\t\t\t\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $url->setQueryString( array( '_mfa' => 'alt', '_mfaMethod' => $key ) ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" class=\"ipsButton ipsButton_primary ipsButton_fullWidth ipsButton_medium\">\nCONTENT;\n\n$val = \"mfa_recovery_{$key}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( in_array( 'email', explode( ',', \\IPS\\Settings::i()->mfa_forgot_behaviour ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class=\"ipsSpacer_bottom ipsSpacer_half\"><a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=settings&do=mfarecovery\", \"front\", \"mfarecovery\", array(), 0 ) );\n$return .= <<<CONTENT\n\" class=\"ipsButton ipsButton_light ipsButton_fullWidth ipsButton_medium\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mfa_recovery_email', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( in_array( 'contact', explode( ',', \\IPS\\Settings::i()->mfa_forgot_behaviour ) ) and \\IPS\\core\\modules\\front\\contact\\contact::canUseContactUs() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class=\"ipsSpacer_bottom ipsSpacer_half\"><a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=contact&controller=contact\", \"front\", \"contact\", array(), 0 ) );\n$return .= <<<CONTENT\n\" class=\"ipsButton ipsButton_light ipsButton_fullWidth ipsButton_medium\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mfa_recovery_contact', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/ul>\n\t\t<\/div>\n\t<\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction mfaSetup( $acceptableHandlers, $member, $url ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div id='elTwoFactorAuthentication' class='ipsModal' data-controller='core.global.core.2fa'>\n\t<div>\n\t\t<form action=\"\nCONTENT;\n$return .= htmlspecialchars( $url, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" method=\"post\" accept-charset='utf-8' data-ipsForm class=\"ipsForm ipsForm_fullWidth\">\n\t\t\t<input type=\"hidden\" name=\"mfa_setup\" value=\"1\">\n\t\t\t\nCONTENT;\n\nif ( count( $acceptableHandlers ) > 1 ):\n$return .= <<<CONTENT\n\n\t\t\t\t<div class='ipsAreaBackground ipsType_center'>\n\t\t\t\t\t<div class='ipsPad'>\n\t\t\t\t\t\t<h1 class='ipsType_center ipsType_pageTitle'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mfa_popup_setup_title', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h1>\n\t\t\t\t\t\t<p class='ipsSpacer_top ipsSpacer_half ipsPos_center ipsType_medium ipsType_richText c2FA_info'>\n\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mfa_setup_multiple', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/p>\n\t\t\t\t\t<\/div>\n\t\t\t\t\t<div class='ipsTabs ipsTabs_small ipsTabs_stretch ipsClearfix ipsJS_show' id='tabs_2fa' data-ipsTabBar data-ipsTabBar-contentArea='#ipsTabs_content_2fa'>\n\t\t\t\t\t\t<a href='#tabs_2fa' data-action='expandTabs'><i class='fa fa-caret-down'><\/i><\/a>\n\t\t\t\t\t\t<ul role='tablist'>\n\t\t\t\t\t\t\t\nCONTENT;\n\n$checked = NULL;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nforeach ( $acceptableHandlers as $key => $handler ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t\t<a href='#ipsTabs_tabs_2fa_2fa_tab_\nCONTENT;\n$return .= htmlspecialchars( $key, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_panel' id='2fa_tab_\nCONTENT;\n$return .= htmlspecialchars( $key, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class=\"ipsTabs_item \nCONTENT;\n\nif ( !$checked ):\n$return .= <<<CONTENT\nipsTabs_activeItem\nCONTENT;\n\n$checked = $key;\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" role=\"tab\">\n\t\t\t\t\t\t\t\t\t\t<input class='ipsJS_hide' type=\"radio\" name=\"mfa_method\" value=\"\nCONTENT;\n$return .= htmlspecialchars( $key, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" id=\"el2FARadio_\nCONTENT;\n$return .= htmlspecialchars( $key, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" \nCONTENT;\n\nif ( $checked == $key ):\n$return .= <<<CONTENT\nchecked\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\n$val = \"mfa_{$key}_title\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\t\t\t\t\t\t\n\t\t\t\t\t\t<\/ul>\n\t\t\t\t\t<\/div>\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<div id='ipsTabs_content_2fa' class='ipsTabs_panels'>\n\t\t\t\t\nCONTENT;\n\nforeach ( $acceptableHandlers as $key => $handler ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<div id='ipsTabs_tabs_2fa_2fa_tab_\nCONTENT;\n$return .= htmlspecialchars( $key, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_panel' class=\"ipsTabs_panel\" aria-labelledby=\"2fa_tab_\nCONTENT;\n$return .= htmlspecialchars( $key, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" aria-hidden=\"false\">\n\t\t\t\t\t\t{$handler->configurationScreen( $member, ( count( $acceptableHandlers ) > 1 ) )}\n\t\t\t\t\t<\/div>\n\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->mfa_required_groups != '*' and !\\IPS\\Member::loggedIn()->inGroup( explode( ',', \\IPS\\Settings::i()->mfa_required_groups ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t<div class=\"ipsAreaBackground ipsType_center\">\n\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $url->setQueryString( '_mfa', 'optout' ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_link ipsButton_medium' data-confirm \nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->language()->checkKeyExists('security_questions_opt_out_warning_value') ):\n$return .= <<<CONTENT\ndata-confirmSubMessage=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'security_questions_opt_out_warning_value', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mfa_opt_out', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/form>\n\t<\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction securityQuestionsAuth( $question ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div class=\"ipsPad ipsType_normal ipsType_richText ipsType_center\">\n\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'security_questions_auth_blurb', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n<\/div>\n<ul class=\"ipsList_reset ipsPad ipsClearfix\">\n\t<li class=\"ipsFieldRow ipsClearfix\">\n\t\t<label class='ipsFieldRow_label'>\n\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $question->_title, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t<\/label>\n\t\t<div class=\"ipsFieldRow_content\">\n\t\t\t<input type=\"text\" name=\"security_answer\" \nCONTENT;\n\nif ( \\IPS\\Request::i()->security_answer ):\n$return .= <<<CONTENT\nclass=\"ipsField_error\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\Request::i()->security_answer ):\n$return .= <<<CONTENT\n\n\t\t\t\t<p class=\"ipsType_warning\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'security_answer_incorrect', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t<\/li>\n<\/ul>\n<ul class=\"ipsList_reset ipsPad ipsClearfix ipsAreaBackground\">\n\t<li>\n\t\t<button type='submit' class='ipsButton ipsButton_primary ipsButton_fullWidth ipsButton_medium'>\n\t\t\t<i class='fa fa-lock'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'security_answer_submit', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t<\/button>\n\t<\/li>\n<\/ul>\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction securityQuestionsSetup( $securityQuestions, $showingMultipleForms ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( !$showingMultipleForms ):\n$return .= <<<CONTENT\n\n\t<div class='ipsPad'>\n\t\t<h1 class='ipsType_center ipsType_pageTitle ipsSpacer_bottom ipsSpacer_half'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mfa_popup_setup_title', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h1>\n\t\t<div class=\"ipsType_normal ipsType_richText ipsType_center\">\n\t\t\t\nCONTENT;\n\n$pluralize = array( \\IPS\\Settings::i()->security_questions_number ?: 3 ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'security_questions_setup_blurb', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<ul class=\"ipsList_reset ipsPad ipsClearfix\">\n\t\nCONTENT;\n\nforeach ( range( 1, min( \\IPS\\Settings::i()->security_questions_number ?: 3, count( $securityQuestions ) ) ) as $i ):\n$return .= <<<CONTENT\n\n\t\t<li class=\"ipsFieldRow ipsClearfix\">\n\t\t\t<div class=\"ipsFieldRow_content\">\n\t\t\t\t<select name=\"security_question[\nCONTENT;\n$return .= htmlspecialchars( $i, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n]\">\n\t\t\t\t\t\nCONTENT;\n\nforeach ( $securityQuestions as $k => $v ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<option value=\"\nCONTENT;\n$return .= htmlspecialchars( $k, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" \nCONTENT;\n\nif ( \\IPS\\Request::i()->security_question[$i] == $k ):\n$return .= <<<CONTENT\nselected\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\nCONTENT;\n$return .= htmlspecialchars( $v, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/option>\n\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/select>\n\t\t\t<\/div>\n\t\t<\/li>\n\t\t<li class=\"ipsFieldRow ipsClearfix\">\n\t\t\t<div class=\"ipsFieldRow_content\">\n\t\t\t\t<input type=\"text\" name=\"security_answer[\nCONTENT;\n$return .= htmlspecialchars( $i, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n]\" value=\"\nCONTENT;\n\nif ( isset( \\IPS\\Request::i()->security_answer[$i] ) ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Request::i()->security_answer[$i], ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\">\n\t\t\t<\/div>\n\t\t<\/li>\n\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n<\/ul>\n\nCONTENT;\n\nif ( \\IPS\\Request::i()->security_question ):\n$return .= <<<CONTENT\n\n\t<div class=\"ipsPad ipsType_warning\">\nCONTENT;\n\n$pluralize = array( \\IPS\\Settings::i()->security_questions_number ?: 3 ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'security_questions_unique', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<ul class=\"ipsList_reset ipsPad ipsClearfix ipsAreaBackground\">\n\t<li>\n\t\t<button type='submit' class='ipsButton ipsButton_primary ipsButton_fullWidth ipsButton_medium'>\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'security_questions_save', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t<\/button>\n\t<\/li>\n<\/ul>\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction twitter( $url ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<a href='\nCONTENT;\n\n$return .= htmlspecialchars( str_replace( '&', '&amp;', $url ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_verySmall ipsButton_fullWidth ipsSocial ipsSocial_twitter'>\n\t<span class='ipsSocial_icon'><i class='fa fa-twitter'><\/i><\/span>\n\t<span class='ipsSocial_text'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'login_twitter', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span>\n<\/a>\nCONTENT;\n\n\t\treturn $return;\n}}"
VALUE;
